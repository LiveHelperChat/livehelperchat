{"version":3,"sources":["webpack://UserList/./src/util/activityMonitoring.js"],"names":["_domEventsHandler","__webpack_require__","_helperFunctions","activityMonitoring","_activityMonitoring","_classCallCheck","this","params","timeoutStatuscheck","timeoutActivity","attributes","userActive","_this","resetTimeout","resetTimeoutActivity","domEventsHandler","listen","window","document","_this2","wasInactive","syncUserStatus","clearTimeout","setTimeout","attatchActivityListeners","initMonitoring","_this3","sender","_this4","chatParams","getSessionAttributes","vid","userSession","getVID","wopen","widgetStatus","value","uaction","uactiv","dep","department","join","helperFunctions","makeRequest","LHC_API","args","lhc_base_url","data","change_status","onlineStatus","online","next"],"mappings":"+aAAAA,EAAAC,EAAA,GACAC,EAAAD,EAAA,OA4FME,EAAqB,eAzFvB,SAAAC,iGAAcC,CAAAC,KAAAF,GACVE,KAAKC,UACLD,KAAKE,mBAAqB,KAC1BF,KAAKG,gBAAkB,KACvBH,KAAKI,WAAa,KAClBJ,KAAKK,WAAa,+DAGK,IAAAC,EAAAN,KACvB,GAAIA,KAAKC,OAAL,eAA+B,CAE/B,IAAIM,EAAe,WACfD,EAAKE,wBAGLR,KAAKC,OAAL,cACAQ,mBAAiBC,OAAOC,OAAQ,YAAaJ,EAAc,mBAC3DE,mBAAiBC,OAAOE,SAAU,YAAaL,EAAc,oBAGjEE,mBAAiBC,OAAOC,OAAQ,YAAaJ,EAAc,iBAC3DE,mBAAiBC,OAAOC,OAAQ,QAASJ,EAAc,aACvDE,mBAAiBC,OAAOC,OAAQ,SAAUJ,EAAc,cACxDE,mBAAiBC,OAAOC,OAAQ,WAAYJ,EAAc,gBAC1DE,mBAAiBC,OAAOC,OAAQ,OAAQJ,EAAc,YACtDE,mBAAiBC,OAAOE,SAAU,SAAUL,EAAc,cAC1DE,mBAAiBC,OAAOE,SAAU,aAAcL,EAAc,kBAC9DE,mBAAiBC,OAAOE,SAAU,WAAYL,EAAc,gBAE5DP,KAAKQ,uEAIU,IAAAK,EAAAb,KACfc,EAAiC,GAAnBd,KAAKK,WAEvBL,KAAKK,WAAa,EAEC,GAAfS,GACAd,KAAKe,eAAe,GAGxBC,aAAahB,KAAKG,iBAElBH,KAAKG,gBAAkBc,WAAW,WAC9BJ,EAAKR,WAAa,EAClBQ,EAAKE,eAAe,IACrB,uCAGGd,EAAQG,GACdJ,KAAKC,OAASA,EACdD,KAAKI,WAAaA,EAClBJ,KAAKkB,2BACLlB,KAAKmB,0DAGQ,IAAAC,EAAApB,KACbgB,aAAahB,KAAKE,oBAClBF,KAAKE,mBAAqBe,WAAW,WACjCG,EAAKL,eAAe,GACpBK,EAAKD,kBACmB,IAAzBnB,KAAKC,OAAL,gDAGQoB,GAAQ,IAAAC,EAAAtB,KACbuB,EAAavB,KAAKI,WAAL,YAA+BoB,uBAE9CvB,GACAwB,IAAOzB,KAAKI,WAAWsB,YAAYC,SACnCC,MAAU5B,KAAKI,WAAWyB,aAAaC,MAAQ,EAAI,EACnDC,QAAWV,EACXW,OAAUhC,KAAKK,WACf4B,IAAOjC,KAAKI,WAAW8B,WAAWC,KAAK,MAGvCZ,EAAA,IAAoBA,EAAA,OACpBtB,EAAA,KAAiBsB,EAAA,GAAmB,IAAMA,EAAA,MAG9Ca,kBAAgBC,YAAYC,QAAQC,KAAKC,aAAe,kCAAmCvC,OAAQA,GAAS,SAACwC,GAC/E,GAAtBA,EAAKC,eAAyBpB,EAAKlB,WAAWuC,aAAab,OAASW,EAAKG,QACzEtB,EAAKlB,WAAWuC,aAAaE,KAAKJ,EAAKG,sBAQ/C/C","file":"15f6aa525e0a8c189614.js","sourcesContent":["import {domEventsHandler} from '../util/domEventsHandler';\nimport {helperFunctions} from '../lib/helperFunctions';\n\nclass _activityMonitoring {\n    constructor() {\n        this.params = {};\n        this.timeoutStatuscheck = null;\n        this.timeoutActivity = null;\n        this.attributes = null;\n        this.userActive = 1;\n    }\n\n    attatchActivityListeners() {\n        if (this.params['track_activity']) {\n\n            var resetTimeout = () => {\n                this.resetTimeoutActivity();\n            };\n\n            if (this.params['track_mouse']) {\n                domEventsHandler.listen(window, 'mousemove', resetTimeout, 'lhc_mousemove_w');\n                domEventsHandler.listen(document, 'mousemove', resetTimeout, 'lhc_mousemove_d');\n            }\n\n            domEventsHandler.listen(window, 'mousedown', resetTimeout, 'lhc_mousedown');\n            domEventsHandler.listen(window, 'click', resetTimeout, 'lhc_click');\n            domEventsHandler.listen(window, 'scroll', resetTimeout, 'lhc_scroll');\n            domEventsHandler.listen(window, 'keypress', resetTimeout, 'lhc_keypress');\n            domEventsHandler.listen(window, 'load', resetTimeout, 'lhc_load');\n            domEventsHandler.listen(document, 'scroll', resetTimeout, 'lhc_scroll');\n            domEventsHandler.listen(document, 'touchstart', resetTimeout, 'lhc_touchstart');\n            domEventsHandler.listen(document, 'touchend', resetTimeout, 'lhc_touchend');\n\n            this.resetTimeoutActivity();\n        }\n    }\n\n    resetTimeoutActivity() {\n        var wasInactive = this.userActive == 0;\n\n        this.userActive = 1;\n\n        if (wasInactive == true) {\n            this.syncUserStatus(1);\n        }\n\n        clearTimeout(this.timeoutActivity);\n\n        this.timeoutActivity = setTimeout(() => {\n            this.userActive = 0;\n            this.syncUserStatus(1);\n        }, 300 * 1000);\n    }\n\n    setParams(params, attributes) {\n        this.params = params;\n        this.attributes = attributes;\n        this.attatchActivityListeners();\n        this.initMonitoring();\n    }\n\n    initMonitoring() {\n        clearTimeout(this.timeoutStatuscheck);\n        this.timeoutStatuscheck = setTimeout(() => {\n            this.syncUserStatus(0);\n            this.initMonitoring();\n        }, this.params['timeout'] * 1000);\n    }\n\n    syncUserStatus(sender) {\n        const chatParams = this.attributes['userSession'].getSessionAttributes();\n\n        let params = {\n            'vid': this.attributes.userSession.getVID(),\n            'wopen': (this.attributes.widgetStatus.value ? 1 : 0),\n            'uaction': sender,\n            'uactiv': this.userActive,\n            'dep': this.attributes.department.join(',')\n        };\n\n        if (chatParams['id'] && chatParams['hash']) {\n            params['hash'] = chatParams['id'] + '_' + chatParams['hash'];\n        }\n\n        helperFunctions.makeRequest(LHC_API.args.lhc_base_url + '/widgetrestapi/chatcheckstatus', {params: params}, (data) => {\n            if (data.change_status == true && this.attributes.onlineStatus.value != data.online) {\n                this.attributes.onlineStatus.next(data.online);\n            }\n        });\n    }\n\n}\n\nconst activityMonitoring = new _activityMonitoring();\nexport {activityMonitoring};"],"sourceRoot":""}