(window.webpackJsonpLHCReactAPPAdmin=window.webpackJsonpLHCReactAPPAdmin||[]).push([[2],{8:function(e,t,n){"use strict";n.r(t);var a=n(18),s=n.n(a),c=n(24),r=n.n(c),l=n(0),m=n.n(l),o=n(25),u=n.n(o);t.default=function(e){var t=Object(l.useState)([]),n=s()(t,2),a=n[0],c=n[1],o=Object(l.useState)(!1),i=s()(o,2),d=i[0],g=i[1],p=Object(l.useReducer)((function(e){return e+1}),0),f=s()(p,2),h=(f[0],f[1]),C=null,I=function(){d||u.a.get(WWW_DIR_JAVASCRIPT+"cannedmsg/filter/"+e.chatId).then((function(e){c(e.data),g(!0),v(null)}))},v=function(t){if(null!==t){var n=document.getElementById("chat-render-preview-"+e.chatId);n.innerHTML=t.msg,clearTimeout(C);var a=new FormData;a.append("msg",t.msg),a.append("msg_body",!0),r()("timeoutCannedMessage"),C=setTimeout((function(){u.a.post(WWW_DIR_JAVASCRIPT+"chat/previewmessage/",a).then((function(e){n.innerHTML=e.data}))}),100)}else document.getElementById("chat-render-preview-"+e.chatId).innerHTML=""},y=function(t,n){if((13==t.keyCode||38==t.keyCode||40==t.keyCode)&&1==n)return t.preventDefault(),void t.stopPropagation();if(13==t.keyCode)a.map((function(t,n){return t.messages.map((function(t){t.current&&(document.getElementById("CSChatMessage-"+e.chatId).value=t.msg,document.getElementById("CSChatMessage-"+e.chatId).focus())}))})),t.preventDefault(),t.stopPropagation();else if(38==t.keyCode){var s=!1;if(1==a[0].messages[0].current){a[0].messages[0].current=!1;var r=a.length-1;a[r].messages[a[r].messages.length-1].current=!0,v(a[r].messages[a[r].messages.length-1])}else a.map((function(e,t,n){return n[n.length-1-t].messages.map((function(e,t,n){var a=n[n.length-1-t];1==s?(a.current=!0,s=!1,v(a)):a.current&&(a.current=!1,s=!0)}))}));c(a),h(),t.preventDefault(),t.stopPropagation()}else if(40==t.keyCode){s=!1;1==a[a.length-1].messages[a[a.length-1].messages.length-1].current?(a[a.length-1].messages[a[a.length-1].messages.length-1].current=!1,a[0].messages[0].current=!0,v(a[0].messages[0])):a.map((function(e,t){e.messages.map((function(e){1==s?(e.current=!0,v(e),s=!1):e.current&&(e.current=!1,s=!0)}))})),c(a),h(),t.preventDefault(),t.stopPropagation()}else!0===n&&u.a.get(WWW_DIR_JAVASCRIPT+"cannedmsg/filter/"+e.chatId+"?q="+encodeURIComponent(t.target.value)).then((function(e){c(e.data),v(null),a.map((function(e,t){e.messages.map((function(e){1==e.current&&v(e)}))}))}))};return m.a.createElement(m.a.Fragment,null,m.a.createElement("div",{className:"col-6"},m.a.createElement("input",{type:"text",onFocus:I,className:"form-control form-control-sm",onKeyUp:function(e){return y(e,!0)},onKeyDown:function(e){return y(e,!1)},defaultValue:"",placeholder:"Type to search"}),!d&&m.a.createElement("p",{className:"border mt-1"},m.a.createElement("a",{className:"fs13",onClick:I},m.a.createElement("span",{className:"material-icons"},"expand_more")," Canned messages")),d&&m.a.createElement("ul",{className:"list-unstyled fs13 border mt-1"},a.map((function(t,n){return m.a.createElement("li",null,m.a.createElement("a",{className:"font-weight-bold",key:n,onClick:function(){return s=n,(e=t).expanded=!e.expanded,void c(a.map((function(t,n){return s==n?e:t})));var e,s}},m.a.createElement("span",{className:"material-icons"},t.expanded?"expand_less":"expand_more"),t.title," [",t.messages.length,"]"),t.expanded&&m.a.createElement("ul",{className:"list-unstyled ml-4"},t.messages.map((function(t){return m.a.createElement("li",{key:t.id,className:t.current?"font-italic font-weight-bold":""},m.a.createElement("a",{title:"Send instantly",onClick:function(n){return function(t){setTimeout((function(){var n=new FormData;n.append("msg",t.msg),u.a.post(WWW_DIR_JAVASCRIPT+"chat/addmsgadmin/"+e.chatId,n,{headers:{"X-CSRFToken":confLH.csrf_token}}).then((function(t){return LHCCallbacks.addmsgadmin&&LHCCallbacks.addmsgadmin(e.chatId),ee.emitEvent("chatAddMsgAdmin",[e.chatId]),lhinst.syncadmincall(),!0}))}),t.delay)}(t)}},m.a.createElement("span",{className:"material-icons fs12"},"send")),m.a.createElement("a",{title:t.msg,onClick:function(n){return function(t){document.getElementById("CSChatMessage-"+e.chatId).value=t.msg,document.getElementById("CSChatMessage-"+e.chatId).focus(),v(t)}(t)}},t.message_title))}))))})))),m.a.createElement("div",{className:"col-6 mx300",id:"chat-render-preview-"+e.chatId}))}}}]);