import{b as e,f as a,g as l,o as t,h as s,m as i,j as c,k as r,n as o,q as n,r as m,u as d,v as p,x as v,y as h,z as u,A as g,B as b,C as f,D as k,E as _,F as y,G as x,H as w,I as S,J as L,K as O,L as j,M as H,N as A,O as E,P as N,Q as T,R as U,S as $,T as D,U as P,V as I}from"./custom-element.D-YWh2og.js";import{b as J,i as M,s as R}from"./select.B5Dt1AnC.js";import{c as q}from"./createI18n.CWZvDLth.js";const{t:B,initTranslations:C}=q("masking");C();var F=d('<div class="row"><div class="col-4"><label> </label> <input type="text" class="form-control form-control-sm"/></div> <div class="col-4"><label> </label> <input type="text" class="form-control form-control-sm"/></div> <div class="col-4"><label> </label> <input type="text" class="form-control form-control-sm"/></div></div>'),z=d('<div class="row"><div class="col-6"><label> </label> <input type="text" class="form-control form-control-sm"/></div> <div class="col-6"><label> </label> <input type="text" class="form-control form-control-sm"/></div></div>'),G=d('<div class="row"><div class="col-6"><label> </label> <input type="text" class="form-control form-control-sm"/></div></div>'),K=d('<div class="col-4"><div class="form-check"><input class="form-check-input" type="checkbox"/> <label class="form-check-label"> </label></div></div>'),Q=d('<div class="row"><div class="col-12 pb-2"><label> </label> <div class="row"></div></div> <div class="col-6 mb-2"><label> </label> <textarea class="form-control form-control-sm" rows="3" placeholder="e.g. example.com or __mailbox__"></textarea> <label> </label> <textarea class="form-control form-control-sm" rows="3" placeholder="e.g. +37011111111"></textarea></div> <div class="col-6 mb-2"><label> </label> <input type="text" class="form-control form-control-sm"/></div></div>'),V=d('<div class="row"><div class="col-6"><div class="form-group"><label> </label> <select class="form-control form-control-sm"><option> </option><option> </option><option> </option></select></div></div> <div class="col-6"><div class="form-group"><label> </label> <input type="text" class="form-control form-control-sm"/></div></div></div>'),W=d('<div class="row"><div class="col-12 mb-2"><label> </label> <input type="text" class="form-control form-control-sm"/></div> <div class="col-6"><div class="form-check"><input class="form-check-input" type="checkbox"/> <label class="form-check-label">HTTPS</label></div> <div class="form-check"><input class="form-check-input" type="checkbox"/> <label class="form-check-label">HTTP</label></div> <div class="form-check"><input class="form-check-input" type="checkbox"/> <label class="form-check-label">FTP</label></div> <div class="form-check"><input class="form-check-input" type="checkbox"/> <label class="form-check-label">Mailto</label></div></div> <div class="col-6"><div class="form-check"><input class="form-check-input" type="checkbox"/> <label class="form-check-label"> </label></div> <div class="form-check"><input class="form-check-input" type="checkbox"/> <label class="form-check-label"> </label></div> <div class="form-check"><input class="form-check-input" type="checkbox"/> <label class="form-check-label"> </label></div></div> <div class="col-6 mt-2"><label> </label> <textarea class="form-control form-control-sm" rows="3" placeholder="e.g. example.com"></textarea></div> <div class="col-6 mt-2"><label> </label> <textarea class="form-control form-control-sm" rows="3" placeholder="e.g. example.com"></textarea></div> <div class="col-12 mt-1"><small class="text-muted"><em> </em></small></div></div>'),X=d('<div class="card mb-2"><div class="card-body p-2"><div class="d-flex justify-content-between align-items-center mb-2"><strong> </strong> <button type="button" class="btn btn-sm btn-danger"> </button></div> <div><!></div></div></div>'),Y=d("<option> </option>"),Z=d('<div id="rules-container"></div> <div class="row mt-2"><div class="col-auto"><select class="form-control form-control-sm"></select></div> <div class="col-auto"><button type="button" class="btn btn-sm btn-secondary"> </button></div></div>',1);function ee(e,d){a(d,!1);const q=()=>o(B,"$t",C),[C,ee]=w(),ae=i(),le=i();let te=l(d,"pii_options",12,"{}"),se=l(d,"input_selector",12,'textarea[name="AbstractInput_pattern"]'),ie=i([]),ce=null,re=i({}),oe=i("regex");function ne(){ce&&(ce.value=JSON.stringify(c(ie)))}function me(e,a,l){T(ie,c(ie)[e][a]=l),s(ie,[...c(ie)]),ne()}function de(e,a,l){c(ie)[e].allowedSchemes||T(ie,c(ie)[e].allowedSchemes=[]),l?-1===c(ie)[e].allowedSchemes.indexOf(a)&&T(ie,c(ie)[e].allowedSchemes=[...c(ie)[e].allowedSchemes,a]):T(ie,c(ie)[e].allowedSchemes=c(ie)[e].allowedSchemes.filter((e=>e!==a))),s(ie,[...c(ie)]),ne()}t((async()=>{s(re,"string"==typeof te()?JSON.parse(te()):te()),ce=document.querySelector(se()),ce&&function(e){try{if(e.trim().startsWith("["))s(ie,JSON.parse(e));else if(""!==e.trim()){const a=e.split("\n");s(ie,[]),a.forEach((function(e){if(""===e.trim())return;const a=e.split("|||"),l={type:"regex",pattern:a[0]};a.length>1&&(l.replacement=a[1]),a.length>2&&"__email__"===a[0]&&(l.replacement_domain=a[2]),c(ie).push(l)}))}}catch(e){console.error("Error parsing rules",e),s(ie,[])}}(ce.value)})),r((()=>q()),(()=>{s(ae,{regex:q()("masking.type_regex"),email:q()("masking.type_email"),credit_card:q()("masking.type_credit_card"),pii:q()("masking.type_pii"),secret_keys:q()("masking.type_secret_keys"),urls:q()("masking.type_urls")})})),r((()=>q()),(()=>{s(le,[{value:"regex",label:q()("masking.type_regex")},{value:"email",label:q()("masking.type_email")},{value:"credit_card",label:q()("masking.type_credit_card")},{value:"pii",label:q()("masking.type_pii")},{value:"secret_keys",label:q()("masking.type_secret_keys")},{value:"urls",label:q()("masking.type_urls")}])})),n();var pe={get pii_options(){return te()},set pii_options(e){te(e),S()},get input_selector(){return se()},set input_selector(e){se(e),S()}};m();var ve=Z(),he=p(ve);v(he,5,(()=>c(ie)),h,((e,a,l)=>{var t=X(),i=b(t),r=b(i),o=b(r),n=b(o,!0);L(o);var m=u(o,2),d=b(m,!0);L(m),L(r);var x=u(r,2),w=b(x),S=e=>{var t=F(),s=b(t),i=b(s),r=b(i,!0);L(i);var o=u(i,2);j(o),L(s);var n=u(s,2),m=b(n),d=b(m,!0);L(m);var p=u(m,2);j(p),L(n);var v=u(n,2),h=b(v),x=b(h,!0);L(h);var w=u(h,2);j(w),L(v),L(t),g(((e,l,t,s,i)=>{k(r,e),H(o,(c(a),f((()=>c(a).name||"")))),A(o,"placeholder",l),k(d,t),H(p,(c(a),f((()=>c(a).pattern||"")))),k(x,s),H(w,(c(a),f((()=>c(a).replacement||"")))),A(w,"placeholder",i)}),[()=>(q(),f((()=>q()("masking.name")||"Name"))),()=>(q(),f((()=>q()("masking.placeholder_name")))),()=>(q(),f((()=>q()("masking.pattern")))),()=>(q(),f((()=>q()("masking.replacement_optional")||"Replacement (optional)"))),()=>(q(),f((()=>q()("masking.placeholder_replacement"))))]),_("change",o,(e=>me(l,"name",e.target.value))),_("change",p,(e=>me(l,"pattern",e.target.value))),_("change",w,(e=>me(l,"replacement",e.target.value))),y(e,t)},N=e=>{var t=E(),i=p(t),r=e=>{var t=z(),s=b(t),i=b(s),r=b(i,!0);L(i);var o=u(i,2);j(o),L(s);var n=u(s,2),m=b(n),d=b(m,!0);L(m);var p=u(m,2);j(p),L(n),L(t),g(((e,l)=>{k(r,e),H(o,(c(a),f((()=>c(a).replacement||"$")))),k(d,l),H(p,(c(a),f((()=>c(a).replacement_domain||"*"))))}),[()=>(q(),f((()=>q()("masking.replacement")))),()=>(q(),f((()=>q()("masking.replacement_domain"))))]),_("change",o,(e=>me(l,"replacement",e.target.value))),_("change",p,(e=>me(l,"replacement_domain",e.target.value))),y(e,t)},o=e=>{var t=E(),i=p(t),r=e=>{var t=G(),s=b(t),i=b(s),r=b(i,!0);L(i);var o=u(i,2);j(o),L(s),L(t),g((e=>{k(r,e),H(o,(c(a),f((()=>c(a).replacement||"*"))))}),[()=>(q(),f((()=>q()("masking.replacement"))))]),_("change",o,(e=>me(l,"replacement",e.target.value))),y(e,t)},o=e=>{var t=E(),i=p(t),r=e=>{var t=Q(),i=b(t),r=b(i),o=b(r,!0);L(r);var n=u(r,2);v(n,5,(()=>(c(re),f((()=>Object.entries(c(re)))))),h,((e,t)=>{var i=D((()=>P(c(t),2)));let r=()=>c(i)[0];var o=K(),n=b(o),m=b(n);j(m);var d=u(m,2),p=b(d,!0);L(d),L(n),L(o),g((e=>{A(m,"id",`pii-${l}-${r()??""}`),U(m,e),A(d,"for",`pii-${l}-${r()??""}`),k(p,c(i)[1])}),[()=>(c(a),r(),f((()=>c(a).entities&&-1!==c(a).entities.indexOf(r()))))]),_("change",m,(e=>function(e,a,l){c(ie)[e].entities||T(ie,c(ie)[e].entities=[]),l?-1===c(ie)[e].entities.indexOf(a)&&T(ie,c(ie)[e].entities=[...c(ie)[e].entities,a]):T(ie,c(ie)[e].entities=c(ie)[e].entities.filter((e=>e!==a))),s(ie,[...c(ie)]),ne()}(l,r(),e.target.checked))),y(e,o)})),L(n),L(i);var m=u(i,2),d=b(m),p=b(d,!0);L(d);var x=u(d,2);$(x);var w=u(x,2),S=b(w,!0);L(w);var O=u(w,2);$(O),L(m);var E=u(m,2),N=b(E),I=b(N,!0);L(N);var J=u(N,2);j(J),L(E),L(t),g(((e,l,t,s,i,r,n,m,d)=>{k(o,e),k(p,l),H(x,t),x.disabled=s,k(S,i),H(O,r),O.disabled=n,k(I,m),H(J,(c(a),f((()=>c(a).replacement||"")))),A(J,"placeholder",d)}),[()=>(q(),f((()=>q()("masking.entities")))),()=>(q(),f((()=>q()("masking.email_domain_allow_list")))),()=>(c(a),f((()=>function(e){return(e.emailDomainAllowList||[]).join("\n")}(c(a))))),()=>(c(a),f((()=>!c(a).entities||-1===c(a).entities.indexOf("EMAIL_ADDRESS")))),()=>(q(),f((()=>q()("masking.phone_allow_list")))),()=>(c(a),f((()=>function(e){return(e.phoneAllowList||[]).join("\n")}(c(a))))),()=>(c(a),f((()=>!c(a).entities||-1===c(a).entities.indexOf("PHONE_NUMBER")))),()=>(q(),f((()=>q()("masking.replacement_mask_hint")))),()=>(q(),f((()=>q()("masking.placeholder_replacement"))))]),_("change",x,(e=>function(e,a){T(ie,c(ie)[e].emailDomainAllowList=a.split("\n").map((e=>e.trim())).filter((e=>""!==e))),s(ie,[...c(ie)]),ne()}(l,e.target.value))),_("change",O,(e=>function(e,a){T(ie,c(ie)[e].phoneAllowList=a.split("\n").map((e=>e.trim())).filter((e=>""!==e))),s(ie,[...c(ie)]),ne()}(l,e.target.value))),_("change",J,(e=>me(l,"replacement",e.target.value))),y(e,t)},o=e=>{var t=E(),i=p(t),r=e=>{var t=V(),s=b(t),i=b(s),r=b(i),o=b(r,!0);L(r);var n=u(r,2),m=b(n),d=b(m,!0);L(m),m.value=m.__value="strict";var p=u(m),v=b(p,!0);L(p),p.value=p.__value="balanced";var h,x=u(p),w=b(x,!0);L(x),x.value=x.__value="permissive",L(n),M(n),L(i),L(s);var S=u(s,2),O=b(S),E=b(O),N=b(E,!0);L(E);var T=u(E,2);j(T),L(O),L(S),L(t),g(((e,l,t,s,i,r)=>{k(o,e),k(d,l),k(v,t),k(w,s),h!==(c(a),h=f((()=>c(a).threshold||"balanced")))&&(n.value=(n.__value=(c(a),f((()=>c(a).threshold||"balanced"))))??"",R(n,(c(a),f((()=>c(a).threshold||"balanced"))))),k(N,i),H(T,(c(a),f((()=>c(a).replacement||"")))),A(T,"placeholder",r)}),[()=>(q(),f((()=>q()("masking.threshold")))),()=>(q(),f((()=>q()("masking.threshold_strict")))),()=>(q(),f((()=>q()("masking.threshold_balanced")))),()=>(q(),f((()=>q()("masking.threshold_permissive")))),()=>(q(),f((()=>q()("masking.replacement_mask_hint")))),()=>(q(),f((()=>q()("masking.placeholder_replacement"))))]),_("change",n,(e=>me(l,"threshold",e.target.value))),_("change",T,(e=>me(l,"replacement",e.target.value))),y(e,t)},o=e=>{var t=E(),i=p(t),r=e=>{var t=W(),i=b(t),r=b(i),o=b(r,!0);L(r);var n=u(r,2);j(n),L(i);var m=u(i,2),d=b(m),p=b(d);j(p),I(2),L(d);var v=u(d,2),h=b(v);j(h),I(2),L(v);var x=u(v,2),w=b(x);j(w),I(2),L(x);var S=u(x,2),O=b(S);j(O),I(2),L(S),L(m);var E=u(m,2),N=b(E),D=b(N);j(D);var P=u(D,2),J=b(P,!0);L(P),L(N);var M=u(N,2),R=b(M);j(R);var B=u(R,2),C=b(B,!0);L(B),L(M);var F=u(M,2),z=b(F);j(z);var G=u(z,2),K=b(G,!0);L(G),L(F),L(E);var Q=u(E,2),V=b(Q),X=b(V,!0);L(V);var Y=u(V,2);$(Y),L(Q);var Z=u(Q,2),ee=b(Z),ae=b(ee,!0);L(ee);var le=u(ee,2);$(le),L(Z);var te=u(Z,2),se=b(te),ce=b(se),re=b(ce,!0);L(ce),L(se),L(te),L(t),g(((e,l,t,s,i,r,m,d,v,u,g,b,_,y)=>{k(o,e),H(n,(c(a),f((()=>c(a).replacement||"")))),A(n,"placeholder",l),U(p,t),U(h,s),U(w,i),U(O,r),U(D,(c(a),f((()=>void 0===c(a).blockUserinfo||c(a).blockUserinfo)))),k(J,m),U(R,(c(a),f((()=>c(a).allowSubdomains||!1)))),k(C,d),U(z,(c(a),f((()=>c(a).allowHostedHost||!1)))),k(K,v),k(X,u),H(Y,g),Y.disabled=(c(a),f((()=>(c(a).denyList||[]).length>0))),k(ae,b),H(le,_),le.disabled=(c(a),f((()=>(c(a).allowList||[]).length>0))),k(re,y)}),[()=>(q(),f((()=>q()("masking.replacement_mask_hint")))),()=>(q(),f((()=>q()("masking.placeholder_replacement")))),()=>(c(a),f((()=>-1!==(c(a).allowedSchemes||["https"]).indexOf("https")))),()=>(c(a),f((()=>-1!==(c(a).allowedSchemes||[]).indexOf("http")))),()=>(c(a),f((()=>-1!==(c(a).allowedSchemes||[]).indexOf("ftp")))),()=>(c(a),f((()=>-1!==(c(a).allowedSchemes||[]).indexOf("mailto")))),()=>(q(),f((()=>q()("masking.block_user_info")))),()=>(q(),f((()=>q()("masking.allow_subdomains")))),()=>(q(),f((()=>q()("masking.allow_hosted_host")))),()=>(q(),f((()=>q()("masking.allow_list")))),()=>(c(a),f((()=>function(e){return(e.allowList||[]).join("\n")}(c(a))))),()=>(q(),f((()=>q()("masking.deny_list")))),()=>(c(a),f((()=>function(e){return(e.denyList||[]).join("\n")}(c(a))))),()=>(q(),f((()=>q()("masking.list_exclusive_note"))))]),_("change",n,(e=>me(l,"replacement",e.target.value))),_("change",p,(e=>de(l,"https",e.target.checked))),_("change",h,(e=>de(l,"http",e.target.checked))),_("change",w,(e=>de(l,"ftp",e.target.checked))),_("change",O,(e=>de(l,"mailto",e.target.checked))),_("change",D,(e=>me(l,"blockUserinfo",e.target.checked))),_("change",R,(e=>me(l,"allowSubdomains",e.target.checked))),_("change",z,(e=>me(l,"allowHostedHost",e.target.checked))),_("change",Y,(e=>function(e,a){T(ie,c(ie)[e].allowList=a.split("\n").map((e=>e.trim())).filter((e=>""!==e))),c(ie)[e].allowList.length>0&&T(ie,c(ie)[e].denyList=[]),s(ie,[...c(ie)]),ne()}(l,e.target.value))),_("change",le,(e=>function(e,a){T(ie,c(ie)[e].denyList=a.split("\n").map((e=>e.trim())).filter((e=>""!==e))),c(ie)[e].denyList.length>0&&T(ie,c(ie)[e].allowList=[]),s(ie,[...c(ie)]),ne()}(l,e.target.value))),y(e,t)};O(i,(e=>{c(a),f((()=>"urls"===c(a).type))&&e(r)}),!0),y(e,t)};O(i,(e=>{c(a),f((()=>"secret_keys"===c(a).type))?e(r):e(o,!1)}),!0),y(e,t)};O(i,(e=>{c(a),f((()=>"pii"===c(a).type))?e(r):e(o,!1)}),!0),y(e,t)};O(i,(e=>{c(a),f((()=>"credit_card"===c(a).type))?e(r):e(o,!1)}),!0),y(e,t)};O(i,(e=>{c(a),f((()=>"email"===c(a).type))?e(r):e(o,!1)}),!0),y(e,t)};O(w,(e=>{c(a),f((()=>"regex"===c(a).type))?e(S):e(N,!1)})),L(x),L(i),L(t),g(((e,a)=>{k(n,e),k(d,a)}),[()=>(c(ae),c(a),f((()=>c(ae)[c(a).type]||c(a).type.toUpperCase()))),()=>(q(),f((()=>q()("masking.delete"))))]),_("click",m,(()=>function(e){s(ie,c(ie).filter(((a,l)=>l!==e))),ne()}(l))),y(e,t)})),L(he);var ue=u(he,2),ge=b(ue),be=b(ge);g((()=>{c(oe),N((()=>{c(le)}))})),v(be,5,(()=>c(le)),h,((e,a)=>{var l=Y(),t=b(l,!0);L(l);var s={};g((()=>{k(t,(c(a),f((()=>c(a).label)))),s!==(c(a),s=f((()=>c(a).value)))&&(l.value=(l.__value=(c(a),f((()=>c(a).value))))??"")})),y(e,l)})),L(be),L(ge);var fe=u(ge,2),ke=b(fe),_e=b(ke,!0);L(ke),L(fe),L(ue),g((e=>k(_e,e)),[()=>(q(),f((()=>q()("masking.add_rule"))))]),J(be,(()=>c(oe)),(e=>s(oe,e))),_("click",ke,(function(){const e={type:c(oe)};"email"===c(oe)?(e.replacement="$",e.replacement_domain="*"):"credit_card"===c(oe)?e.replacement="*":"regex"===c(oe)?(e.pattern="",e.replacement="",e.name=""):"pii"===c(oe)?(e.entities=[],e.emailDomainAllowList=[],e.replacement=""):"secret_keys"===c(oe)?e.threshold="balanced":"urls"===c(oe)&&(e.allowedSchemes=["https"],e.blockUserinfo=!0,e.allowSubdomains=!1,e.allowList=[],e.denyList=[],e.allowHostedHost=!1),s(ie,[...c(ie),e]),ne()})),y(e,ve);var ye=x(pe);return ee(),ye}customElements.define("lhc-masking-rules",e(ee,{pii_options:{},input_selector:{}},[],[],!1));export{ee as LHCMaskingRules};
//# sourceMappingURL=masking.js.map
