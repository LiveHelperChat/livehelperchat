import{b as e,f as a,g as l,o as t,h as s,m as c,j as i,k as r,n as o,q as n,r as m,u as d,v as p,x as v,y as h,z as u,A as g,B as b,C as f,D as k,E as _,F as y,G as x,H as w,I as S,J as L,K as O,L as j,M as H,N as A,O as D,P as E,Q as T,R as U,S as $,T as N,U as I,V as J}from"./custom-element.D-YWh2og.js";import{b as P,i as M,s as R}from"./select.B5Dt1AnC.js";import{c as q}from"./createI18n.C1uCyXjb.js";const{t:C,initTranslations:F}=q("masking");F();var z=d('<div class="row"><div class="col-4"><label> </label> <input type="text" class="form-control form-control-sm"/></div> <div class="col-4"><label> </label> <input type="text" class="form-control form-control-sm"/></div> <div class="col-4"><label> </label> <input type="text" class="form-control form-control-sm"/></div></div>'),B=d('<div class="row"><div class="col-6"><label> </label> <input type="text" class="form-control form-control-sm"/></div> <div class="col-6"><label> </label> <input type="text" class="form-control form-control-sm"/></div></div>'),G=d('<div class="row"><div class="col-6"><label> </label> <input type="text" class="form-control form-control-sm"/></div></div>'),K=d('<div class="col-4"><div class="form-check"><input class="form-check-input" type="checkbox"/> <label class="form-check-label"> </label></div></div>'),Q=d('<div class="row"><div class="col-12 pb-2"><label> </label> <div class="row"></div></div> <div class="col-6 mb-2"><label> </label> <textarea class="form-control form-control-sm" rows="3" placeholder="e.g. example.com or __mailbox__"></textarea></div> <div class="col-6 mb-2"><label> </label> <input type="text" class="form-control form-control-sm"/></div></div>'),V=d('<div class="row"><div class="col-6"><div class="form-group"><label> </label> <select class="form-control form-control-sm"><option> </option><option> </option><option> </option></select></div></div> <div class="col-6"><div class="form-group"><label> </label> <input type="text" class="form-control form-control-sm"/></div></div></div>'),W=d('<div class="row"><div class="col-12 mb-2"><label> </label> <input type="text" class="form-control form-control-sm"/></div> <div class="col-6"><div class="form-check"><input class="form-check-input" type="checkbox"/> <label class="form-check-label">HTTPS</label></div> <div class="form-check"><input class="form-check-input" type="checkbox"/> <label class="form-check-label">HTTP</label></div> <div class="form-check"><input class="form-check-input" type="checkbox"/> <label class="form-check-label">FTP</label></div> <div class="form-check"><input class="form-check-input" type="checkbox"/> <label class="form-check-label">Mailto</label></div></div> <div class="col-6"><div class="form-check"><input class="form-check-input" type="checkbox"/> <label class="form-check-label"> </label></div> <div class="form-check"><input class="form-check-input" type="checkbox"/> <label class="form-check-label"> </label></div> <div class="form-check"><input class="form-check-input" type="checkbox"/> <label class="form-check-label"> </label></div></div> <div class="col-6 mt-2"><label> </label> <textarea class="form-control form-control-sm" rows="3" placeholder="e.g. example.com"></textarea></div> <div class="col-6 mt-2"><label> </label> <textarea class="form-control form-control-sm" rows="3" placeholder="e.g. example.com"></textarea></div> <div class="col-12 mt-1"><small class="text-muted"><em> </em></small></div></div>'),X=d('<div class="card mb-2"><div class="card-body p-2"><div class="d-flex justify-content-between align-items-center mb-2"><strong> </strong> <button type="button" class="btn btn-sm btn-danger"> </button></div> <div><!></div></div></div>'),Y=d("<option> </option>"),Z=d('<div id="rules-container"></div> <div class="row mt-2"><div class="col-auto"><select class="form-control form-control-sm"></select></div> <div class="col-auto"><button type="button" class="btn btn-sm btn-secondary"> </button></div></div>',1);function ee(e,d){a(d,!1);const q=()=>o(C,"$t",F),[F,ee]=w(),ae=c(),le=c();let te=l(d,"pii_options",12,"{}"),se=l(d,"input_selector",12,'textarea[name="AbstractInput_pattern"]'),ce=c([]),ie=null,re=c({}),oe=c("regex");function ne(){ie&&(ie.value=JSON.stringify(i(ce)))}function me(e,a,l){T(ce,i(ce)[e][a]=l),s(ce,[...i(ce)]),ne()}function de(e,a,l){i(ce)[e].allowedSchemes||T(ce,i(ce)[e].allowedSchemes=[]),l?-1===i(ce)[e].allowedSchemes.indexOf(a)&&T(ce,i(ce)[e].allowedSchemes=[...i(ce)[e].allowedSchemes,a]):T(ce,i(ce)[e].allowedSchemes=i(ce)[e].allowedSchemes.filter((e=>e!==a))),s(ce,[...i(ce)]),ne()}t((async()=>{s(re,"string"==typeof te()?JSON.parse(te()):te()),ie=document.querySelector(se()),ie&&function(e){try{if(e.trim().startsWith("["))s(ce,JSON.parse(e));else if(""!==e.trim()){const a=e.split("\n");s(ce,[]),a.forEach((function(e){if(""===e.trim())return;const a=e.split("|||"),l={type:"regex",pattern:a[0]};a.length>1&&(l.replacement=a[1]),a.length>2&&"__email__"===a[0]&&(l.replacement_domain=a[2]),i(ce).push(l)}))}}catch(e){console.error("Error parsing rules",e),s(ce,[])}}(ie.value)})),r((()=>q()),(()=>{s(ae,{regex:q()("masking.type_regex"),email:q()("masking.type_email"),credit_card:q()("masking.type_credit_card"),pii:q()("masking.type_pii"),secret_keys:q()("masking.type_secret_keys"),urls:q()("masking.type_urls")})})),r((()=>q()),(()=>{s(le,[{value:"regex",label:q()("masking.type_regex")},{value:"email",label:q()("masking.type_email")},{value:"credit_card",label:q()("masking.type_credit_card")},{value:"pii",label:q()("masking.type_pii")},{value:"secret_keys",label:q()("masking.type_secret_keys")},{value:"urls",label:q()("masking.type_urls")}])})),n();var pe={get pii_options(){return te()},set pii_options(e){te(e),S()},get input_selector(){return se()},set input_selector(e){se(e),S()}};m();var ve=Z(),he=p(ve);v(he,5,(()=>i(ce)),h,((e,a,l)=>{var t=X(),c=b(t),r=b(c),o=b(r),n=b(o,!0);L(o);var m=u(o,2),d=b(m,!0);L(m),L(r);var x=u(r,2),w=b(x),S=e=>{var t=z(),s=b(t),c=b(s),r=b(c,!0);L(c);var o=u(c,2);j(o),L(s);var n=u(s,2),m=b(n),d=b(m,!0);L(m);var p=u(m,2);j(p),L(n);var v=u(n,2),h=b(v),x=b(h,!0);L(h);var w=u(h,2);j(w),L(v),L(t),g(((e,l,t,s,c)=>{k(r,e),H(o,(i(a),f((()=>i(a).name||"")))),A(o,"placeholder",l),k(d,t),H(p,(i(a),f((()=>i(a).pattern||"")))),k(x,s),H(w,(i(a),f((()=>i(a).replacement||"")))),A(w,"placeholder",c)}),[()=>(q(),f((()=>q()("masking.name")||"Name"))),()=>(q(),f((()=>q()("masking.placeholder_name")))),()=>(q(),f((()=>q()("masking.pattern")))),()=>(q(),f((()=>q()("masking.replacement_optional")||"Replacement (optional)"))),()=>(q(),f((()=>q()("masking.placeholder_replacement"))))]),_("change",o,(e=>me(l,"name",e.target.value))),_("change",p,(e=>me(l,"pattern",e.target.value))),_("change",w,(e=>me(l,"replacement",e.target.value))),y(e,t)},E=e=>{var t=D(),c=p(t),r=e=>{var t=B(),s=b(t),c=b(s),r=b(c,!0);L(c);var o=u(c,2);j(o),L(s);var n=u(s,2),m=b(n),d=b(m,!0);L(m);var p=u(m,2);j(p),L(n),L(t),g(((e,l)=>{k(r,e),H(o,(i(a),f((()=>i(a).replacement||"$")))),k(d,l),H(p,(i(a),f((()=>i(a).replacement_domain||"*"))))}),[()=>(q(),f((()=>q()("masking.replacement")))),()=>(q(),f((()=>q()("masking.replacement_domain"))))]),_("change",o,(e=>me(l,"replacement",e.target.value))),_("change",p,(e=>me(l,"replacement_domain",e.target.value))),y(e,t)},o=e=>{var t=D(),c=p(t),r=e=>{var t=G(),s=b(t),c=b(s),r=b(c,!0);L(c);var o=u(c,2);j(o),L(s),L(t),g((e=>{k(r,e),H(o,(i(a),f((()=>i(a).replacement||"*"))))}),[()=>(q(),f((()=>q()("masking.replacement"))))]),_("change",o,(e=>me(l,"replacement",e.target.value))),y(e,t)},o=e=>{var t=D(),c=p(t),r=e=>{var t=Q(),c=b(t),r=b(c),o=b(r,!0);L(r);var n=u(r,2);v(n,5,(()=>(i(re),f((()=>Object.entries(i(re)))))),h,((e,t)=>{var c=N((()=>I(i(t),2)));let r=()=>i(c)[0];var o=K(),n=b(o),m=b(n);j(m);var d=u(m,2),p=b(d,!0);L(d),L(n),L(o),g((e=>{A(m,"id",`pii-${l}-${r()??""}`),U(m,e),A(d,"for",`pii-${l}-${r()??""}`),k(p,i(c)[1])}),[()=>(i(a),r(),f((()=>i(a).entities&&-1!==i(a).entities.indexOf(r()))))]),_("change",m,(e=>function(e,a,l){i(ce)[e].entities||T(ce,i(ce)[e].entities=[]),l?-1===i(ce)[e].entities.indexOf(a)&&T(ce,i(ce)[e].entities=[...i(ce)[e].entities,a]):T(ce,i(ce)[e].entities=i(ce)[e].entities.filter((e=>e!==a))),s(ce,[...i(ce)]),ne()}(l,r(),e.target.checked))),y(e,o)})),L(n),L(c);var m=u(c,2),d=b(m),p=b(d,!0);L(d);var x=u(d,2);$(x),L(m);var w=u(m,2),S=b(w),O=b(S,!0);L(S);var D=u(S,2);j(D),L(w),L(t),g(((e,l,t,s,c,r)=>{k(o,e),k(p,l),H(x,t),x.disabled=s,k(O,c),H(D,(i(a),f((()=>i(a).replacement||"")))),A(D,"placeholder",r)}),[()=>(q(),f((()=>q()("masking.entities")))),()=>(q(),f((()=>q()("masking.email_domain_allow_list")||"Email Domain Allow List (one per line). Use __mailbox__ to allow all mailbox domains"))),()=>(i(a),f((()=>function(e){return(e.emailDomainAllowList||[]).join("\n")}(i(a))))),()=>(i(a),f((()=>!i(a).entities||-1===i(a).entities.indexOf("EMAIL_ADDRESS")))),()=>(q(),f((()=>q()("masking.replacement_mask_hint")))),()=>(q(),f((()=>q()("masking.placeholder_replacement"))))]),_("change",x,(e=>function(e,a){T(ce,i(ce)[e].emailDomainAllowList=a.split("\n").map((e=>e.trim())).filter((e=>""!==e))),s(ce,[...i(ce)]),ne()}(l,e.target.value))),_("change",D,(e=>me(l,"replacement",e.target.value))),y(e,t)},o=e=>{var t=D(),c=p(t),r=e=>{var t=V(),s=b(t),c=b(s),r=b(c),o=b(r,!0);L(r);var n=u(r,2),m=b(n),d=b(m,!0);L(m),m.value=m.__value="strict";var p=u(m),v=b(p,!0);L(p),p.value=p.__value="balanced";var h,x=u(p),w=b(x,!0);L(x),x.value=x.__value="permissive",L(n),M(n),L(c),L(s);var S=u(s,2),O=b(S),D=b(O),E=b(D,!0);L(D);var T=u(D,2);j(T),L(O),L(S),L(t),g(((e,l,t,s,c,r)=>{k(o,e),k(d,l),k(v,t),k(w,s),h!==(i(a),h=f((()=>i(a).threshold||"balanced")))&&(n.value=(n.__value=(i(a),f((()=>i(a).threshold||"balanced"))))??"",R(n,(i(a),f((()=>i(a).threshold||"balanced"))))),k(E,c),H(T,(i(a),f((()=>i(a).replacement||"")))),A(T,"placeholder",r)}),[()=>(q(),f((()=>q()("masking.threshold")))),()=>(q(),f((()=>q()("masking.threshold_strict")))),()=>(q(),f((()=>q()("masking.threshold_balanced")))),()=>(q(),f((()=>q()("masking.threshold_permissive")))),()=>(q(),f((()=>q()("masking.replacement_mask_hint")))),()=>(q(),f((()=>q()("masking.placeholder_replacement"))))]),_("change",n,(e=>me(l,"threshold",e.target.value))),_("change",T,(e=>me(l,"replacement",e.target.value))),y(e,t)},o=e=>{var t=D(),c=p(t),r=e=>{var t=W(),c=b(t),r=b(c),o=b(r,!0);L(r);var n=u(r,2);j(n),L(c);var m=u(c,2),d=b(m),p=b(d);j(p),J(2),L(d);var v=u(d,2),h=b(v);j(h),J(2),L(v);var x=u(v,2),w=b(x);j(w),J(2),L(x);var S=u(x,2),O=b(S);j(O),J(2),L(S),L(m);var D=u(m,2),E=b(D),N=b(E);j(N);var I=u(N,2),P=b(I,!0);L(I),L(E);var M=u(E,2),R=b(M);j(R);var C=u(R,2),F=b(C,!0);L(C),L(M);var z=u(M,2),B=b(z);j(B);var G=u(B,2),K=b(G,!0);L(G),L(z),L(D);var Q=u(D,2),V=b(Q),X=b(V,!0);L(V);var Y=u(V,2);$(Y),L(Q);var Z=u(Q,2),ee=b(Z),ae=b(ee,!0);L(ee);var le=u(ee,2);$(le),L(Z);var te=u(Z,2),se=b(te),ie=b(se),re=b(ie,!0);L(ie),L(se),L(te),L(t),g(((e,l,t,s,c,r,m,d,v,u,g,b,_,y)=>{k(o,e),H(n,(i(a),f((()=>i(a).replacement||"")))),A(n,"placeholder",l),U(p,t),U(h,s),U(w,c),U(O,r),U(N,(i(a),f((()=>void 0===i(a).blockUserinfo||i(a).blockUserinfo)))),k(P,m),U(R,(i(a),f((()=>i(a).allowSubdomains||!1)))),k(F,d),U(B,(i(a),f((()=>i(a).allowHostedHost||!1)))),k(K,v),k(X,u),H(Y,g),Y.disabled=(i(a),f((()=>(i(a).denyList||[]).length>0))),k(ae,b),H(le,_),le.disabled=(i(a),f((()=>(i(a).allowList||[]).length>0))),k(re,y)}),[()=>(q(),f((()=>q()("masking.replacement_mask_hint")))),()=>(q(),f((()=>q()("masking.placeholder_replacement")))),()=>(i(a),f((()=>-1!==(i(a).allowedSchemes||["https"]).indexOf("https")))),()=>(i(a),f((()=>-1!==(i(a).allowedSchemes||[]).indexOf("http")))),()=>(i(a),f((()=>-1!==(i(a).allowedSchemes||[]).indexOf("ftp")))),()=>(i(a),f((()=>-1!==(i(a).allowedSchemes||[]).indexOf("mailto")))),()=>(q(),f((()=>q()("masking.block_user_info")))),()=>(q(),f((()=>q()("masking.allow_subdomains")))),()=>(q(),f((()=>q()("masking.allow_hosted_host")))),()=>(q(),f((()=>q()("masking.allow_list")))),()=>(i(a),f((()=>function(e){return(e.allowList||[]).join("\n")}(i(a))))),()=>(q(),f((()=>q()("masking.deny_list")))),()=>(i(a),f((()=>function(e){return(e.denyList||[]).join("\n")}(i(a))))),()=>(q(),f((()=>q()("masking.list_exclusive_note"))))]),_("change",n,(e=>me(l,"replacement",e.target.value))),_("change",p,(e=>de(l,"https",e.target.checked))),_("change",h,(e=>de(l,"http",e.target.checked))),_("change",w,(e=>de(l,"ftp",e.target.checked))),_("change",O,(e=>de(l,"mailto",e.target.checked))),_("change",N,(e=>me(l,"blockUserinfo",e.target.checked))),_("change",R,(e=>me(l,"allowSubdomains",e.target.checked))),_("change",B,(e=>me(l,"allowHostedHost",e.target.checked))),_("change",Y,(e=>function(e,a){T(ce,i(ce)[e].allowList=a.split("\n").map((e=>e.trim())).filter((e=>""!==e))),i(ce)[e].allowList.length>0&&T(ce,i(ce)[e].denyList=[]),s(ce,[...i(ce)]),ne()}(l,e.target.value))),_("change",le,(e=>function(e,a){T(ce,i(ce)[e].denyList=a.split("\n").map((e=>e.trim())).filter((e=>""!==e))),i(ce)[e].denyList.length>0&&T(ce,i(ce)[e].allowList=[]),s(ce,[...i(ce)]),ne()}(l,e.target.value))),y(e,t)};O(c,(e=>{i(a),f((()=>"urls"===i(a).type))&&e(r)}),!0),y(e,t)};O(c,(e=>{i(a),f((()=>"secret_keys"===i(a).type))?e(r):e(o,!1)}),!0),y(e,t)};O(c,(e=>{i(a),f((()=>"pii"===i(a).type))?e(r):e(o,!1)}),!0),y(e,t)};O(c,(e=>{i(a),f((()=>"credit_card"===i(a).type))?e(r):e(o,!1)}),!0),y(e,t)};O(c,(e=>{i(a),f((()=>"email"===i(a).type))?e(r):e(o,!1)}),!0),y(e,t)};O(w,(e=>{i(a),f((()=>"regex"===i(a).type))?e(S):e(E,!1)})),L(x),L(c),L(t),g(((e,a)=>{k(n,e),k(d,a)}),[()=>(i(ae),i(a),f((()=>i(ae)[i(a).type]||i(a).type.toUpperCase()))),()=>(q(),f((()=>q()("masking.delete"))))]),_("click",m,(()=>function(e){s(ce,i(ce).filter(((a,l)=>l!==e))),ne()}(l))),y(e,t)})),L(he);var ue=u(he,2),ge=b(ue),be=b(ge);g((()=>{i(oe),E((()=>{i(le)}))})),v(be,5,(()=>i(le)),h,((e,a)=>{var l=Y(),t=b(l,!0);L(l);var s={};g((()=>{k(t,(i(a),f((()=>i(a).label)))),s!==(i(a),s=f((()=>i(a).value)))&&(l.value=(l.__value=(i(a),f((()=>i(a).value))))??"")})),y(e,l)})),L(be),L(ge);var fe=u(ge,2),ke=b(fe),_e=b(ke,!0);L(ke),L(fe),L(ue),g((e=>k(_e,e)),[()=>(q(),f((()=>q()("masking.add_rule"))))]),P(be,(()=>i(oe)),(e=>s(oe,e))),_("click",ke,(function(){const e={type:i(oe)};"email"===i(oe)?(e.replacement="$",e.replacement_domain="*"):"credit_card"===i(oe)?e.replacement="*":"regex"===i(oe)?(e.pattern="",e.replacement="",e.name=""):"pii"===i(oe)?(e.entities=[],e.emailDomainAllowList=[],e.replacement=""):"secret_keys"===i(oe)?e.threshold="balanced":"urls"===i(oe)&&(e.allowedSchemes=["https"],e.blockUserinfo=!0,e.allowSubdomains=!1,e.allowList=[],e.denyList=[],e.allowHostedHost=!1),s(ce,[...i(ce),e]),ne()})),y(e,ve);var ye=x(pe);return ee(),ye}customElements.define("lhc-masking-rules",e(ee,{pii_options:{},input_selector:{}},[],[],!1));export{ee as LHCMaskingRules};
//# sourceMappingURL=masking.js.map
