import{c as e,S as t,i as l,s as n,f as a,e as c,n as s,d as i,a as o,r,u as m,b as p,h as u,j as d,l as h,k as f,m as g,t as k,g as _,v,w as b,o as y,x,y as w}from"./index.DKABnuqJ.js";import{c as S}from"./createI18n.ChR7VkRx.js";const{t:L,initTranslations:O}=S("masking");function $(e,t,l){const n=e.slice();return n[42]=t[l],n}function A(e,t,l){const n=e.slice();return n[45]=t[l],n[47]=l,n}function H(e,t,l){const n=e.slice();return n[48]=t[l][0],n[49]=t[l][1],n}function U(e){let t,l,n,a,c,s,o,m,v,b,y,x,w,S,L,O,$,A,H,U,j,D,E,C,T,N,I,R,J,q,F,W,z,B,G,K,Q,V,X,Y,Z,ee,te,le,ne,ae,ce,se,ie,oe,re,me,pe,ue,de,he,fe,ge,ke,_e,ve,be,ye,xe,we,Se,Le,Oe,$e,Ae,He,Ue,je,De,Ee,Ce,Te,Ne,Ie=e[0]("masking.replacement_mask_hint")+"",Re=e[0]("masking.block_user_info")+"",Je=e[0]("masking.allow_subdomains")+"",Me=e[0]("masking.allow_hosted_host")+"",Pe=e[0]("masking.allow_list")+"",qe=e[0]("masking.deny_list")+"",Fe=e[0]("masking.list_exclusive_note")+"";function We(...t){return e[28](e[47],...t)}function ze(...t){return e[29](e[47],...t)}function Be(...t){return e[30](e[47],...t)}function Ge(...t){return e[31](e[47],...t)}function Ke(...t){return e[32](e[47],...t)}function Qe(...t){return e[33](e[47],...t)}function Ve(...t){return e[34](e[47],...t)}function Xe(...t){return e[35](e[47],...t)}function Ye(...t){return e[36](e[47],...t)}function Ze(...t){return e[37](e[47],...t)}return{c(){t=f("div"),l=f("div"),n=f("label"),a=k(Ie),c=g(),s=f("input"),v=g(),b=f("div"),y=f("div"),x=f("input"),S=g(),L=f("label"),L.textContent="HTTPS",O=g(),$=f("div"),A=f("input"),U=g(),j=f("label"),j.textContent="HTTP",D=g(),E=f("div"),C=f("input"),N=g(),I=f("label"),I.textContent="FTP",R=g(),J=f("div"),q=f("input"),W=g(),z=f("label"),z.textContent="Mailto",B=g(),G=f("div"),K=f("div"),Q=f("input"),X=g(),Y=f("label"),Z=k(Re),ee=g(),te=f("div"),le=f("input"),ae=g(),ce=f("label"),se=k(Je),ie=g(),oe=f("div"),re=f("input"),pe=g(),ue=f("label"),de=k(Me),he=g(),fe=f("div"),ge=f("label"),ke=k(Pe),_e=g(),ve=f("textarea"),xe=g(),we=f("div"),Se=f("label"),Le=k(qe),Oe=g(),$e=f("textarea"),Ue=g(),je=f("div"),De=f("small"),Ee=f("em"),Ce=k(Fe),_(s,"type","text"),_(s,"class","form-control form-control-sm"),s.value=o=e[45].replacement||"",_(s,"placeholder",m=e[0]("masking.placeholder_replacement")),_(l,"class","col-12 mb-2"),_(x,"class","form-check-input"),_(x,"type","checkbox"),x.checked=w=-1!==(e[45].allowedSchemes||["https"]).indexOf("https"),_(L,"class","form-check-label"),_(y,"class","form-check"),_(A,"class","form-check-input"),_(A,"type","checkbox"),A.checked=H=-1!==(e[45].allowedSchemes||[]).indexOf("http"),_(j,"class","form-check-label"),_($,"class","form-check"),_(C,"class","form-check-input"),_(C,"type","checkbox"),C.checked=T=-1!==(e[45].allowedSchemes||[]).indexOf("ftp"),_(I,"class","form-check-label"),_(E,"class","form-check"),_(q,"class","form-check-input"),_(q,"type","checkbox"),q.checked=F=-1!==(e[45].allowedSchemes||[]).indexOf("mailto"),_(z,"class","form-check-label"),_(J,"class","form-check"),_(b,"class","col-6"),_(Q,"class","form-check-input"),_(Q,"type","checkbox"),Q.checked=V=void 0===e[45].blockUserinfo||e[45].blockUserinfo,_(Y,"class","form-check-label"),_(K,"class","form-check"),_(le,"class","form-check-input"),_(le,"type","checkbox"),le.checked=ne=e[45].allowSubdomains||!1,_(ce,"class","form-check-label"),_(te,"class","form-check"),_(re,"class","form-check-input"),_(re,"type","checkbox"),re.checked=me=e[45].allowHostedHost||!1,_(ue,"class","form-check-label"),_(oe,"class","form-check"),_(G,"class","col-6"),_(ve,"class","form-control form-control-sm"),_(ve,"rows","3"),_(ve,"placeholder","e.g. example.com"),ve.value=be=M(e[45]),ve.disabled=ye=(e[45].denyList||[]).length>0,_(fe,"class","col-6 mt-2"),_($e,"class","form-control form-control-sm"),_($e,"rows","3"),_($e,"placeholder","e.g. example.com"),$e.value=Ae=P(e[45]),$e.disabled=He=(e[45].allowList||[]).length>0,_(we,"class","col-6 mt-2"),_(De,"class","text-muted"),_(je,"class","col-12 mt-1"),_(t,"class","row")},m(e,i){u(e,t,i),d(t,l),d(l,n),d(n,a),d(l,c),d(l,s),d(t,v),d(t,b),d(b,y),d(y,x),d(y,S),d(y,L),d(b,O),d(b,$),d($,A),d($,U),d($,j),d(b,D),d(b,E),d(E,C),d(E,N),d(E,I),d(b,R),d(b,J),d(J,q),d(J,W),d(J,z),d(t,B),d(t,G),d(G,K),d(K,Q),d(K,X),d(K,Y),d(Y,Z),d(G,ee),d(G,te),d(te,le),d(te,ae),d(te,ce),d(ce,se),d(G,ie),d(G,oe),d(oe,re),d(oe,pe),d(oe,ue),d(ue,de),d(t,he),d(t,fe),d(fe,ge),d(ge,ke),d(fe,_e),d(fe,ve),d(t,xe),d(t,we),d(we,Se),d(Se,Le),d(we,Oe),d(we,$e),d(t,Ue),d(t,je),d(je,De),d(De,Ee),d(Ee,Ce),Te||(Ne=[h(s,"change",We),h(x,"change",ze),h(A,"change",Be),h(C,"change",Ge),h(q,"change",Ke),h(Q,"change",Qe),h(le,"change",Ve),h(re,"change",Xe),h(ve,"change",Ye),h($e,"change",Ze)],Te=!0)},p(t,l){e=t,1&l[0]&&Ie!==(Ie=e[0]("masking.replacement_mask_hint")+"")&&p(a,Ie),2&l[0]&&o!==(o=e[45].replacement||"")&&s.value!==o&&(s.value=o),1&l[0]&&m!==(m=e[0]("masking.placeholder_replacement"))&&_(s,"placeholder",m),2&l[0]&&w!==(w=-1!==(e[45].allowedSchemes||["https"]).indexOf("https"))&&(x.checked=w),2&l[0]&&H!==(H=-1!==(e[45].allowedSchemes||[]).indexOf("http"))&&(A.checked=H),2&l[0]&&T!==(T=-1!==(e[45].allowedSchemes||[]).indexOf("ftp"))&&(C.checked=T),2&l[0]&&F!==(F=-1!==(e[45].allowedSchemes||[]).indexOf("mailto"))&&(q.checked=F),2&l[0]&&V!==(V=void 0===e[45].blockUserinfo||e[45].blockUserinfo)&&(Q.checked=V),1&l[0]&&Re!==(Re=e[0]("masking.block_user_info")+"")&&p(Z,Re),2&l[0]&&ne!==(ne=e[45].allowSubdomains||!1)&&(le.checked=ne),1&l[0]&&Je!==(Je=e[0]("masking.allow_subdomains")+"")&&p(se,Je),2&l[0]&&me!==(me=e[45].allowHostedHost||!1)&&(re.checked=me),1&l[0]&&Me!==(Me=e[0]("masking.allow_hosted_host")+"")&&p(de,Me),1&l[0]&&Pe!==(Pe=e[0]("masking.allow_list")+"")&&p(ke,Pe),2&l[0]&&be!==(be=M(e[45]))&&(ve.value=be),2&l[0]&&ye!==(ye=(e[45].denyList||[]).length>0)&&(ve.disabled=ye),1&l[0]&&qe!==(qe=e[0]("masking.deny_list")+"")&&p(Le,qe),2&l[0]&&Ae!==(Ae=P(e[45]))&&($e.value=Ae),2&l[0]&&He!==(He=(e[45].allowList||[]).length>0)&&($e.disabled=He),1&l[0]&&Fe!==(Fe=e[0]("masking.list_exclusive_note")+"")&&p(Ce,Fe)},d(e){e&&i(t),Te=!1,r(Ne)}}}function j(e){let t,l,n,a,c,s,o,v,b,y,w,S,L,O,$,A,H,U,j,D,E,C,T,N,I,R=e[0]("masking.threshold")+"",J=e[0]("masking.threshold_strict")+"",M=e[0]("masking.threshold_balanced")+"",P=e[0]("masking.threshold_permissive")+"",q=e[0]("masking.replacement_mask_hint")+"";function F(...t){return e[26](e[47],...t)}function W(...t){return e[27](e[47],...t)}return{c(){t=f("div"),l=f("div"),n=f("div"),a=f("label"),c=k(R),s=g(),o=f("select"),v=f("option"),b=k(J),y=f("option"),w=k(M),S=f("option"),L=k(P),$=g(),A=f("div"),H=f("div"),U=f("label"),j=k(q),D=g(),E=f("input"),v.__value="strict",x(v,v.__value),y.__value="balanced",x(y,y.__value),S.__value="permissive",x(S,S.__value),_(o,"class","form-control form-control-sm"),_(n,"class","form-group"),_(l,"class","col-6"),_(E,"type","text"),_(E,"class","form-control form-control-sm"),E.value=C=e[45].replacement||"",_(E,"placeholder",T=e[0]("masking.placeholder_replacement")),_(H,"class","form-group"),_(A,"class","col-6"),_(t,"class","row")},m(i,r){u(i,t,r),d(t,l),d(l,n),d(n,a),d(a,c),d(n,s),d(n,o),d(o,v),d(v,b),d(o,y),d(y,w),d(o,S),d(S,L),m(o,e[45].threshold||"balanced"),d(t,$),d(t,A),d(A,H),d(H,U),d(U,j),d(H,D),d(H,E),N||(I=[h(o,"change",F),h(E,"change",W)],N=!0)},p(t,l){e=t,1&l[0]&&R!==(R=e[0]("masking.threshold")+"")&&p(c,R),1&l[0]&&J!==(J=e[0]("masking.threshold_strict")+"")&&p(b,J),1&l[0]&&M!==(M=e[0]("masking.threshold_balanced")+"")&&p(w,M),1&l[0]&&P!==(P=e[0]("masking.threshold_permissive")+"")&&p(L,P),2&l[0]&&O!==(O=e[45].threshold||"balanced")&&m(o,e[45].threshold||"balanced"),1&l[0]&&q!==(q=e[0]("masking.replacement_mask_hint")+"")&&p(j,q),2&l[0]&&C!==(C=e[45].replacement||"")&&E.value!==C&&(E.value=C),1&l[0]&&T!==(T=e[0]("masking.placeholder_replacement"))&&_(E,"placeholder",T)},d(e){e&&i(t),N=!1,r(I)}}}function D(e){let t,l,n,a,s,m,v,b,y,x,w,S,L,O,$,A,U,j,D,E,C,T,I,R,J=e[0]("masking.entities")+"",M=(e[0]("masking.email_domain_allow_list")||"Email Domain Allow List (one per line). Use __mailbox__ to allow all mailbox domains")+"",P=e[0]("masking.replacement_mask_hint")+"",F=c(Object.entries(e[2])),W=[];for(let t=0;t<F.length;t+=1)W[t]=N(H(e,F,t));function z(...t){return e[24](e[47],...t)}function B(...t){return e[25](e[47],...t)}return{c(){t=f("div"),l=f("div"),n=f("label"),a=k(J),s=g(),m=f("div");for(let e=0;e<W.length;e+=1)W[e].c();v=g(),b=f("div"),y=f("label"),x=k(M),w=g(),S=f("textarea"),$=g(),A=f("div"),U=f("label"),j=k(P),D=g(),E=f("input"),_(m,"class","row"),_(l,"class","col-12 pb-2"),_(S,"class","form-control form-control-sm"),_(S,"rows","3"),_(S,"placeholder","e.g. example.com or __mailbox__"),S.value=L=q(e[45]),S.disabled=O=!e[45].entities||-1===e[45].entities.indexOf("EMAIL_ADDRESS"),_(b,"class","col-6 mb-2"),_(E,"type","text"),_(E,"class","form-control form-control-sm"),E.value=C=e[45].replacement||"",_(E,"placeholder",T=e[0]("masking.placeholder_replacement")),_(A,"class","col-6 mb-2"),_(t,"class","row")},m(e,c){u(e,t,c),d(t,l),d(l,n),d(n,a),d(l,s),d(l,m);for(let e=0;e<W.length;e+=1)W[e]&&W[e].m(m,null);d(t,v),d(t,b),d(b,y),d(y,x),d(b,w),d(b,S),d(t,$),d(t,A),d(A,U),d(U,j),d(A,D),d(A,E),I||(R=[h(S,"change",z),h(E,"change",B)],I=!0)},p(t,l){if(e=t,1&l[0]&&J!==(J=e[0]("masking.entities")+"")&&p(a,J),518&l[0]){let t;for(F=c(Object.entries(e[2])),t=0;t<F.length;t+=1){const n=H(e,F,t);W[t]?W[t].p(n,l):(W[t]=N(n),W[t].c(),W[t].m(m,null))}for(;t<W.length;t+=1)W[t].d(1);W.length=F.length}1&l[0]&&M!==(M=(e[0]("masking.email_domain_allow_list")||"Email Domain Allow List (one per line). Use __mailbox__ to allow all mailbox domains")+"")&&p(x,M),2&l[0]&&L!==(L=q(e[45]))&&(S.value=L),2&l[0]&&O!==(O=!e[45].entities||-1===e[45].entities.indexOf("EMAIL_ADDRESS"))&&(S.disabled=O),1&l[0]&&P!==(P=e[0]("masking.replacement_mask_hint")+"")&&p(j,P),2&l[0]&&C!==(C=e[45].replacement||"")&&E.value!==C&&(E.value=C),1&l[0]&&T!==(T=e[0]("masking.placeholder_replacement"))&&_(E,"placeholder",T)},d(e){e&&i(t),o(W,e),I=!1,r(R)}}}function E(e){let t,l,n,a,c,s,o,r,m,v=e[0]("masking.replacement")+"";function b(...t){return e[22](e[47],...t)}return{c(){t=f("div"),l=f("div"),n=f("label"),a=k(v),c=g(),s=f("input"),_(s,"type","text"),_(s,"class","form-control form-control-sm"),s.value=o=e[45].replacement||"*",_(l,"class","col-6"),_(t,"class","row")},m(e,i){u(e,t,i),d(t,l),d(l,n),d(n,a),d(l,c),d(l,s),r||(m=h(s,"change",b),r=!0)},p(t,l){e=t,1&l[0]&&v!==(v=e[0]("masking.replacement")+"")&&p(a,v),2&l[0]&&o!==(o=e[45].replacement||"*")&&s.value!==o&&(s.value=o)},d(e){e&&i(t),r=!1,m()}}}function C(e){let t,l,n,a,c,s,o,m,v,b,y,x,w,S,L,O,$=e[0]("masking.replacement")+"",A=e[0]("masking.replacement_domain")+"";function H(...t){return e[20](e[47],...t)}function U(...t){return e[21](e[47],...t)}return{c(){t=f("div"),l=f("div"),n=f("label"),a=k($),c=g(),s=f("input"),m=g(),v=f("div"),b=f("label"),y=k(A),x=g(),w=f("input"),_(s,"type","text"),_(s,"class","form-control form-control-sm"),s.value=o=e[45].replacement||"$",_(l,"class","col-6"),_(w,"type","text"),_(w,"class","form-control form-control-sm"),w.value=S=e[45].replacement_domain||"*",_(v,"class","col-6"),_(t,"class","row")},m(e,i){u(e,t,i),d(t,l),d(l,n),d(n,a),d(l,c),d(l,s),d(t,m),d(t,v),d(v,b),d(b,y),d(v,x),d(v,w),L||(O=[h(s,"change",H),h(w,"change",U)],L=!0)},p(t,l){e=t,1&l[0]&&$!==($=e[0]("masking.replacement")+"")&&p(a,$),2&l[0]&&o!==(o=e[45].replacement||"$")&&s.value!==o&&(s.value=o),1&l[0]&&A!==(A=e[0]("masking.replacement_domain")+"")&&p(y,A),2&l[0]&&S!==(S=e[45].replacement_domain||"*")&&w.value!==S&&(w.value=S)},d(e){e&&i(t),L=!1,r(O)}}}function T(e){let t,l,n,a,c,s,o,m,v,b,y,x,w,S,L,O,$,A,H,U,j,D,E,C,T,N=(e[0]("masking.name")||"Name")+"",I=e[0]("masking.pattern")+"",R=(e[0]("masking.replacement_optional")||"Replacement (optional)")+"";function J(...t){return e[17](e[47],...t)}function M(...t){return e[18](e[47],...t)}function P(...t){return e[19](e[47],...t)}return{c(){t=f("div"),l=f("div"),n=f("label"),a=k(N),c=g(),s=f("input"),v=g(),b=f("div"),y=f("label"),x=k(I),w=g(),S=f("input"),O=g(),$=f("div"),A=f("label"),H=k(R),U=g(),j=f("input"),_(s,"type","text"),_(s,"class","form-control form-control-sm"),s.value=o=e[45].name||"",_(s,"placeholder",m=e[0]("masking.placeholder_name")),_(l,"class","col-4"),_(S,"type","text"),_(S,"class","form-control form-control-sm"),S.value=L=e[45].pattern||"",_(b,"class","col-4"),_(j,"type","text"),_(j,"class","form-control form-control-sm"),j.value=D=e[45].replacement||"",_(j,"placeholder",E=e[0]("masking.placeholder_replacement")),_($,"class","col-4"),_(t,"class","row")},m(e,i){u(e,t,i),d(t,l),d(l,n),d(n,a),d(l,c),d(l,s),d(t,v),d(t,b),d(b,y),d(y,x),d(b,w),d(b,S),d(t,O),d(t,$),d($,A),d(A,H),d($,U),d($,j),C||(T=[h(s,"change",J),h(S,"change",M),h(j,"change",P)],C=!0)},p(t,l){e=t,1&l[0]&&N!==(N=(e[0]("masking.name")||"Name")+"")&&p(a,N),2&l[0]&&o!==(o=e[45].name||"")&&s.value!==o&&(s.value=o),1&l[0]&&m!==(m=e[0]("masking.placeholder_name"))&&_(s,"placeholder",m),1&l[0]&&I!==(I=e[0]("masking.pattern")+"")&&p(x,I),2&l[0]&&L!==(L=e[45].pattern||"")&&S.value!==L&&(S.value=L),1&l[0]&&R!==(R=(e[0]("masking.replacement_optional")||"Replacement (optional)")+"")&&p(H,R),2&l[0]&&D!==(D=e[45].replacement||"")&&j.value!==D&&(j.value=D),1&l[0]&&E!==(E=e[0]("masking.placeholder_replacement"))&&_(j,"placeholder",E)},d(e){e&&i(t),C=!1,r(T)}}}function N(e){let t,l,n,a,c,s,o,r,m,v,b,y,x=e[49]+"";function w(...t){return e[23](e[47],e[48],...t)}return{c(){t=f("div"),l=f("div"),n=f("input"),s=g(),o=f("label"),r=k(x),v=g(),_(n,"class","form-check-input"),_(n,"type","checkbox"),_(n,"id",a="pii-"+e[47]+"-"+e[48]),n.checked=c=e[45].entities&&-1!==e[45].entities.indexOf(e[48]),_(o,"class","form-check-label"),_(o,"for",m="pii-"+e[47]+"-"+e[48]),_(l,"class","form-check"),_(t,"class","col-4")},m(e,a){u(e,t,a),d(t,l),d(l,n),d(l,s),d(l,o),d(o,r),d(t,v),b||(y=h(n,"change",w),b=!0)},p(t,l){e=t,4&l[0]&&a!==(a="pii-"+e[47]+"-"+e[48])&&_(n,"id",a),6&l[0]&&c!==(c=e[45].entities&&-1!==e[45].entities.indexOf(e[48]))&&(n.checked=c),4&l[0]&&x!==(x=e[49]+"")&&p(r,x),4&l[0]&&m!==(m="pii-"+e[47]+"-"+e[48])&&_(o,"for",m)},d(e){e&&i(t),b=!1,y()}}}function I(e){let t,l,n,a,c,s,o,r,m,v,b,y,x,w=(e[5][e[45].type]||e[45].type.toUpperCase())+"",S=e[0]("masking.delete")+"";function L(){return e[16](e[47])}function O(e,t){return"regex"===e[45].type?T:"email"===e[45].type?C:"credit_card"===e[45].type?E:"pii"===e[45].type?D:"secret_keys"===e[45].type?j:"urls"===e[45].type?U:void 0}let $=O(e),A=$&&$(e);return{c(){t=f("div"),l=f("div"),n=f("div"),a=f("strong"),c=k(w),s=g(),o=f("button"),r=k(S),m=g(),v=f("div"),A&&A.c(),b=g(),_(o,"type","button"),_(o,"class","btn btn-sm btn-danger"),_(n,"class","d-flex justify-content-between align-items-center mb-2"),_(l,"class","card-body p-2"),_(t,"class","card mb-2")},m(e,i){u(e,t,i),d(t,l),d(l,n),d(n,a),d(a,c),d(n,s),d(n,o),d(o,r),d(l,m),d(l,v),A&&A.m(v,null),d(t,b),y||(x=h(o,"click",L),y=!0)},p(t,l){e=t,34&l[0]&&w!==(w=(e[5][e[45].type]||e[45].type.toUpperCase())+"")&&p(c,w),1&l[0]&&S!==(S=e[0]("masking.delete")+"")&&p(r,S),$===($=O(e))&&A?A.p(e,l):(A&&A.d(1),A=$&&$(e),A&&(A.c(),A.m(v,null)))},d(e){e&&i(t),A&&A.d(),y=!1,x()}}}function R(e){let t,l,n,a=e[42].label+"";return{c(){t=f("option"),l=k(a),t.__value=n=e[42].value,x(t,t.__value)},m(e,n){u(e,t,n),d(t,l)},p(e,c){16&c[0]&&a!==(a=e[42].label+"")&&p(l,a),16&c[0]&&n!==(n=e[42].value)&&(t.__value=n,x(t,t.__value))},d(e){e&&i(t)}}}function J(e){let t,l,n,a,b,y,x,w,S,L,O,H=e[0]("masking.add_rule")+"",U=c(e[1]),j=[];for(let t=0;t<U.length;t+=1)j[t]=I(A(e,U,t));let D=c(e[4]),E=[];for(let t=0;t<D.length;t+=1)E[t]=R($(e,D,t));return{c(){t=f("div");for(let e=0;e<j.length;e+=1)j[e].c();l=g(),n=f("div"),a=f("div"),b=f("select");for(let e=0;e<E.length;e+=1)E[e].c();y=g(),x=f("div"),w=f("button"),S=k(H),_(t,"id","rules-container"),_(b,"class","form-control form-control-sm"),void 0===e[3]&&v((()=>e[38].call(b))),_(a,"class","col-auto"),_(w,"type","button"),_(w,"class","btn btn-sm btn-secondary"),_(x,"class","col-auto"),_(n,"class","row mt-2")},m(c,s){u(c,t,s);for(let e=0;e<j.length;e+=1)j[e]&&j[e].m(t,null);u(c,l,s),u(c,n,s),d(n,a),d(a,b);for(let e=0;e<E.length;e+=1)E[e]&&E[e].m(b,null);m(b,e[3],!0),d(n,y),d(n,x),d(x,w),d(w,S),L||(O=[h(b,"change",e[38]),h(w,"click",e[6])],L=!0)},p(e,l){if(16295&l[0]){let n;for(U=c(e[1]),n=0;n<U.length;n+=1){const a=A(e,U,n);j[n]?j[n].p(a,l):(j[n]=I(a),j[n].c(),j[n].m(t,null))}for(;n<j.length;n+=1)j[n].d(1);j.length=U.length}if(16&l[0]){let t;for(D=c(e[4]),t=0;t<D.length;t+=1){const n=$(e,D,t);E[t]?E[t].p(n,l):(E[t]=R(n),E[t].c(),E[t].m(b,null))}for(;t<E.length;t+=1)E[t].d(1);E.length=D.length}24&l[0]&&m(b,e[3]),1&l[0]&&H!==(H=e[0]("masking.add_rule")+"")&&p(S,H)},i:s,o:s,d(e){e&&(i(t),i(l),i(n)),o(j,e),o(E,e),L=!1,r(O)}}}function M(e){return(e.allowList||[]).join("\n")}function P(e){return(e.denyList||[]).join("\n")}function q(e){return(e.emailDomainAllowList||[]).join("\n")}function F(e,t,l){let n,a,c;b(e,L,(e=>l(0,c=e)));let{pii_options:s="{}"}=t,{input_selector:i='textarea[name="AbstractInput_pattern"]'}=t,o=[],r=null,m={},p="regex";function u(){r&&(r.value=JSON.stringify(o))}function d(e){l(1,o=o.filter(((t,l)=>l!==e))),u()}function h(e,t,n){l(1,o[e][t]=n,o),l(1,o=[...o]),u()}function f(e,t,n){o[e].entities||l(1,o[e].entities=[],o),n?-1===o[e].entities.indexOf(t)&&l(1,o[e].entities=[...o[e].entities,t],o):l(1,o[e].entities=o[e].entities.filter((e=>e!==t)),o),l(1,o=[...o]),u()}function g(e,t,n){o[e].allowedSchemes||l(1,o[e].allowedSchemes=[],o),n?-1===o[e].allowedSchemes.indexOf(t)&&l(1,o[e].allowedSchemes=[...o[e].allowedSchemes,t],o):l(1,o[e].allowedSchemes=o[e].allowedSchemes.filter((e=>e!==t)),o),l(1,o=[...o]),u()}function k(e,t){l(1,o[e].allowList=t.split("\n").map((e=>e.trim())).filter((e=>""!==e)),o),o[e].allowList.length>0&&l(1,o[e].denyList=[],o),l(1,o=[...o]),u()}function _(e,t){l(1,o[e].denyList=t.split("\n").map((e=>e.trim())).filter((e=>""!==e)),o),o[e].denyList.length>0&&l(1,o[e].allowList=[],o),l(1,o=[...o]),u()}function v(e,t){l(1,o[e].emailDomainAllowList=t.split("\n").map((e=>e.trim())).filter((e=>""!==e)),o),l(1,o=[...o]),u()}y((async()=>{l(2,m="string"==typeof s?JSON.parse(s):s),r=document.querySelector(i),r&&function(e){try{if(e.trim().startsWith("["))l(1,o=JSON.parse(e));else if(""!==e.trim()){const t=e.split("\n");l(1,o=[]),t.forEach((function(e){if(""===e.trim())return;const t=e.split("|||"),l={type:"regex",pattern:t[0]};t.length>1&&(l.replacement=t[1]),t.length>2&&"__email__"===t[0]&&(l.replacement_domain=t[2]),o.push(l)}))}}catch(e){console.error("Error parsing rules",e),l(1,o=[])}}(r.value)}));return e.$$set=e=>{"pii_options"in e&&l(14,s=e.pii_options),"input_selector"in e&&l(15,i=e.input_selector)},e.$$.update=()=>{1&e.$$.dirty[0]&&l(5,n={regex:c("masking.type_regex"),email:c("masking.type_email"),credit_card:c("masking.type_credit_card"),pii:c("masking.type_pii"),secret_keys:c("masking.type_secret_keys"),urls:c("masking.type_urls")}),1&e.$$.dirty[0]&&l(4,a=[{value:"regex",label:c("masking.type_regex")},{value:"email",label:c("masking.type_email")},{value:"credit_card",label:c("masking.type_credit_card")},{value:"pii",label:c("masking.type_pii")},{value:"secret_keys",label:c("masking.type_secret_keys")},{value:"urls",label:c("masking.type_urls")}])},[c,o,m,p,a,n,function(){const e={type:p};"email"===p?(e.replacement="$",e.replacement_domain="*"):"credit_card"===p?e.replacement="*":"regex"===p?(e.pattern="",e.replacement="",e.name=""):"pii"===p?(e.entities=[],e.emailDomainAllowList=[],e.replacement=""):"secret_keys"===p?e.threshold="balanced":"urls"===p&&(e.allowedSchemes=["https"],e.blockUserinfo=!0,e.allowSubdomains=!1,e.allowList=[],e.denyList=[],e.allowHostedHost=!1),l(1,o=[...o,e]),u()},d,h,f,g,k,_,v,s,i,e=>d(e),(e,t)=>h(e,"name",t.target.value),(e,t)=>h(e,"pattern",t.target.value),(e,t)=>h(e,"replacement",t.target.value),(e,t)=>h(e,"replacement",t.target.value),(e,t)=>h(e,"replacement_domain",t.target.value),(e,t)=>h(e,"replacement",t.target.value),(e,t,l)=>f(e,t,l.target.checked),(e,t)=>v(e,t.target.value),(e,t)=>h(e,"replacement",t.target.value),(e,t)=>h(e,"threshold",t.target.value),(e,t)=>h(e,"replacement",t.target.value),(e,t)=>h(e,"replacement",t.target.value),(e,t)=>g(e,"https",t.target.checked),(e,t)=>g(e,"http",t.target.checked),(e,t)=>g(e,"ftp",t.target.checked),(e,t)=>g(e,"mailto",t.target.checked),(e,t)=>h(e,"blockUserinfo",t.target.checked),(e,t)=>h(e,"allowSubdomains",t.target.checked),(e,t)=>h(e,"allowHostedHost",t.target.checked),(e,t)=>k(e,t.target.value),(e,t)=>_(e,t.target.value),function(){p=w(this),l(3,p),l(4,a),l(0,c)}]}O();class W extends t{constructor(e){super(),l(this,e,F,J,n,{pii_options:14,input_selector:15},null,[-1,-1])}get pii_options(){return this.$$.ctx[14]}set pii_options(e){this.$$set({pii_options:e}),a()}get input_selector(){return this.$$.ctx[15]}set input_selector(e){this.$$set({input_selector:e}),a()}}customElements.define("lhc-masking-rules",e(W,{pii_options:{},input_selector:{}},[],[],!1));export{W as LHCMaskingRules};
//# sourceMappingURL=masking.js.map
