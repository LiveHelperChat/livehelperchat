import{c as e,S as t,i as l,s as n,f as a,e as c,n as s,d as i,a as o,r,u as m,b as p,h as u,j as d,l as h,k as f,m as g,t as k,g as _,v,w as b,o as y,x,y as w}from"./index.DKABnuqJ.js";import{c as S}from"./createI18n.dbi3yoQO.js";const{t:$,initTranslations:O}=S("masking");function L(e,t,l){const n=e.slice();return n[40]=t[l],n}function H(e,t,l){const n=e.slice();return n[43]=t[l],n[45]=l,n}function j(e,t,l){const n=e.slice();return n[46]=t[l][0],n[47]=t[l][1],n}function U(e){let t,l,n,a,c,s,o,m,v,b,y,x,w,S,$,O,L,H,j,U,C,T,N,E,J,P,I,R,q,M,W,z,B,D,G,K,Q,V,X,Y,Z,ee,te,le,ne,ae,ce,se,ie,oe,re,me,pe,ue,de,he,fe,ge,ke,_e,ve,be,ye,xe,we,Se,$e,Oe,Le,He,je,Ue,Ce,Te,Ne,Ee,Je,Pe,Ie=e[0]("masking.replacement_mask_hint")+"",Re=e[0]("masking.block_user_info")+"",qe=e[0]("masking.allow_subdomains")+"",Ae=e[0]("masking.allow_hosted_host")+"",Fe=e[0]("masking.allow_list")+"",Me=e[0]("masking.deny_list")+"",We=e[0]("masking.list_exclusive_note")+"";function ze(...t){return e[26](e[45],...t)}function Be(...t){return e[27](e[45],...t)}function De(...t){return e[28](e[45],...t)}function Ge(...t){return e[29](e[45],...t)}function Ke(...t){return e[30](e[45],...t)}function Qe(...t){return e[31](e[45],...t)}function Ve(...t){return e[32](e[45],...t)}function Xe(...t){return e[33](e[45],...t)}function Ye(...t){return e[34](e[45],...t)}function Ze(...t){return e[35](e[45],...t)}return{c(){t=f("div"),l=f("div"),n=f("label"),a=k(Ie),c=g(),s=f("input"),v=g(),b=f("div"),y=f("div"),x=f("input"),S=g(),$=f("label"),$.textContent="HTTPS",O=g(),L=f("div"),H=f("input"),U=g(),C=f("label"),C.textContent="HTTP",T=g(),N=f("div"),E=f("input"),P=g(),I=f("label"),I.textContent="FTP",R=g(),q=f("div"),M=f("input"),z=g(),B=f("label"),B.textContent="Mailto",D=g(),G=f("div"),K=f("div"),Q=f("input"),X=g(),Y=f("label"),Z=k(Re),ee=g(),te=f("div"),le=f("input"),ae=g(),ce=f("label"),se=k(qe),ie=g(),oe=f("div"),re=f("input"),pe=g(),ue=f("label"),de=k(Ae),he=g(),fe=f("div"),ge=f("label"),ke=k(Fe),_e=g(),ve=f("textarea"),xe=g(),we=f("div"),Se=f("label"),$e=k(Me),Oe=g(),Le=f("textarea"),Ue=g(),Ce=f("div"),Te=f("small"),Ne=f("em"),Ee=k(We),_(s,"type","text"),_(s,"class","form-control form-control-sm"),s.value=o=e[43].replacement||"",_(s,"placeholder",m=e[0]("masking.placeholder_replacement")),_(l,"class","col-12 mb-2"),_(x,"class","form-check-input"),_(x,"type","checkbox"),x.checked=w=-1!==(e[43].allowedSchemes||["https"]).indexOf("https"),_($,"class","form-check-label"),_(y,"class","form-check"),_(H,"class","form-check-input"),_(H,"type","checkbox"),H.checked=j=-1!==(e[43].allowedSchemes||[]).indexOf("http"),_(C,"class","form-check-label"),_(L,"class","form-check"),_(E,"class","form-check-input"),_(E,"type","checkbox"),E.checked=J=-1!==(e[43].allowedSchemes||[]).indexOf("ftp"),_(I,"class","form-check-label"),_(N,"class","form-check"),_(M,"class","form-check-input"),_(M,"type","checkbox"),M.checked=W=-1!==(e[43].allowedSchemes||[]).indexOf("mailto"),_(B,"class","form-check-label"),_(q,"class","form-check"),_(b,"class","col-6"),_(Q,"class","form-check-input"),_(Q,"type","checkbox"),Q.checked=V=void 0===e[43].blockUserinfo||e[43].blockUserinfo,_(Y,"class","form-check-label"),_(K,"class","form-check"),_(le,"class","form-check-input"),_(le,"type","checkbox"),le.checked=ne=e[43].allowSubdomains||!1,_(ce,"class","form-check-label"),_(te,"class","form-check"),_(re,"class","form-check-input"),_(re,"type","checkbox"),re.checked=me=e[43].allowHostedHost||!1,_(ue,"class","form-check-label"),_(oe,"class","form-check"),_(G,"class","col-6"),_(ve,"class","form-control form-control-sm"),_(ve,"rows","3"),_(ve,"placeholder","e.g. example.com"),ve.value=be=A(e[43]),ve.disabled=ye=(e[43].denyList||[]).length>0,_(fe,"class","col-6 mt-2"),_(Le,"class","form-control form-control-sm"),_(Le,"rows","3"),_(Le,"placeholder","e.g. example.com"),Le.value=He=F(e[43]),Le.disabled=je=(e[43].allowList||[]).length>0,_(we,"class","col-6 mt-2"),_(Te,"class","text-muted"),_(Ce,"class","col-12 mt-1"),_(t,"class","row")},m(e,i){u(e,t,i),d(t,l),d(l,n),d(n,a),d(l,c),d(l,s),d(t,v),d(t,b),d(b,y),d(y,x),d(y,S),d(y,$),d(b,O),d(b,L),d(L,H),d(L,U),d(L,C),d(b,T),d(b,N),d(N,E),d(N,P),d(N,I),d(b,R),d(b,q),d(q,M),d(q,z),d(q,B),d(t,D),d(t,G),d(G,K),d(K,Q),d(K,X),d(K,Y),d(Y,Z),d(G,ee),d(G,te),d(te,le),d(te,ae),d(te,ce),d(ce,se),d(G,ie),d(G,oe),d(oe,re),d(oe,pe),d(oe,ue),d(ue,de),d(t,he),d(t,fe),d(fe,ge),d(ge,ke),d(fe,_e),d(fe,ve),d(t,xe),d(t,we),d(we,Se),d(Se,$e),d(we,Oe),d(we,Le),d(t,Ue),d(t,Ce),d(Ce,Te),d(Te,Ne),d(Ne,Ee),Je||(Pe=[h(s,"change",ze),h(x,"change",Be),h(H,"change",De),h(E,"change",Ge),h(M,"change",Ke),h(Q,"change",Qe),h(le,"change",Ve),h(re,"change",Xe),h(ve,"change",Ye),h(Le,"change",Ze)],Je=!0)},p(t,l){e=t,1&l[0]&&Ie!==(Ie=e[0]("masking.replacement_mask_hint")+"")&&p(a,Ie),2&l[0]&&o!==(o=e[43].replacement||"")&&s.value!==o&&(s.value=o),1&l[0]&&m!==(m=e[0]("masking.placeholder_replacement"))&&_(s,"placeholder",m),2&l[0]&&w!==(w=-1!==(e[43].allowedSchemes||["https"]).indexOf("https"))&&(x.checked=w),2&l[0]&&j!==(j=-1!==(e[43].allowedSchemes||[]).indexOf("http"))&&(H.checked=j),2&l[0]&&J!==(J=-1!==(e[43].allowedSchemes||[]).indexOf("ftp"))&&(E.checked=J),2&l[0]&&W!==(W=-1!==(e[43].allowedSchemes||[]).indexOf("mailto"))&&(M.checked=W),2&l[0]&&V!==(V=void 0===e[43].blockUserinfo||e[43].blockUserinfo)&&(Q.checked=V),1&l[0]&&Re!==(Re=e[0]("masking.block_user_info")+"")&&p(Z,Re),2&l[0]&&ne!==(ne=e[43].allowSubdomains||!1)&&(le.checked=ne),1&l[0]&&qe!==(qe=e[0]("masking.allow_subdomains")+"")&&p(se,qe),2&l[0]&&me!==(me=e[43].allowHostedHost||!1)&&(re.checked=me),1&l[0]&&Ae!==(Ae=e[0]("masking.allow_hosted_host")+"")&&p(de,Ae),1&l[0]&&Fe!==(Fe=e[0]("masking.allow_list")+"")&&p(ke,Fe),2&l[0]&&be!==(be=A(e[43]))&&(ve.value=be),2&l[0]&&ye!==(ye=(e[43].denyList||[]).length>0)&&(ve.disabled=ye),1&l[0]&&Me!==(Me=e[0]("masking.deny_list")+"")&&p($e,Me),2&l[0]&&He!==(He=F(e[43]))&&(Le.value=He),2&l[0]&&je!==(je=(e[43].allowList||[]).length>0)&&(Le.disabled=je),1&l[0]&&We!==(We=e[0]("masking.list_exclusive_note")+"")&&p(Ee,We)},d(e){e&&i(t),Je=!1,r(Pe)}}}function C(e){let t,l,n,a,c,s,o,v,b,y,w,S,$,O,L,H,j,U,C,T,N,E,J,P,I,R=e[0]("masking.threshold")+"",q=e[0]("masking.threshold_strict")+"",A=e[0]("masking.threshold_balanced")+"",F=e[0]("masking.threshold_permissive")+"",M=e[0]("masking.replacement_mask_hint")+"";function W(...t){return e[24](e[45],...t)}function z(...t){return e[25](e[45],...t)}return{c(){t=f("div"),l=f("div"),n=f("div"),a=f("label"),c=k(R),s=g(),o=f("select"),v=f("option"),b=k(q),y=f("option"),w=k(A),S=f("option"),$=k(F),L=g(),H=f("div"),j=f("div"),U=f("label"),C=k(M),T=g(),N=f("input"),v.__value="strict",x(v,v.__value),y.__value="balanced",x(y,y.__value),S.__value="permissive",x(S,S.__value),_(o,"class","form-control form-control-sm"),_(n,"class","form-group"),_(l,"class","col-6"),_(N,"type","text"),_(N,"class","form-control form-control-sm"),N.value=E=e[43].replacement||"",_(N,"placeholder",J=e[0]("masking.placeholder_replacement")),_(j,"class","form-group"),_(H,"class","col-6"),_(t,"class","row")},m(i,r){u(i,t,r),d(t,l),d(l,n),d(n,a),d(a,c),d(n,s),d(n,o),d(o,v),d(v,b),d(o,y),d(y,w),d(o,S),d(S,$),m(o,e[43].threshold||"balanced"),d(t,L),d(t,H),d(H,j),d(j,U),d(U,C),d(j,T),d(j,N),P||(I=[h(o,"change",W),h(N,"change",z)],P=!0)},p(t,l){e=t,1&l[0]&&R!==(R=e[0]("masking.threshold")+"")&&p(c,R),1&l[0]&&q!==(q=e[0]("masking.threshold_strict")+"")&&p(b,q),1&l[0]&&A!==(A=e[0]("masking.threshold_balanced")+"")&&p(w,A),1&l[0]&&F!==(F=e[0]("masking.threshold_permissive")+"")&&p($,F),2&l[0]&&O!==(O=e[43].threshold||"balanced")&&m(o,e[43].threshold||"balanced"),1&l[0]&&M!==(M=e[0]("masking.replacement_mask_hint")+"")&&p(C,M),2&l[0]&&E!==(E=e[43].replacement||"")&&N.value!==E&&(N.value=E),1&l[0]&&J!==(J=e[0]("masking.placeholder_replacement"))&&_(N,"placeholder",J)},d(e){e&&i(t),P=!1,r(I)}}}function T(e){let t,l,n,a,s,r,m,v,b,y,x,w,S,$,O,L,H=e[0]("masking.replacement_mask_hint")+"",U=e[0]("masking.entities")+"";function C(...t){return e[22](e[45],...t)}let T=c(Object.entries(e[2])),N=[];for(let t=0;t<T.length;t+=1)N[t]=P(j(e,T,t));return{c(){t=f("div"),l=f("div"),n=f("label"),a=k(H),s=g(),r=f("input"),b=g(),y=f("div"),x=f("label"),w=k(U),S=g(),$=f("div");for(let e=0;e<N.length;e+=1)N[e].c();_(r,"type","text"),_(r,"class","form-control form-control-sm"),r.value=m=e[43].replacement||"",_(r,"placeholder",v=e[0]("masking.placeholder_replacement")),_(l,"class","col-12 mb-2"),_($,"class","row"),_(y,"class","col-12"),_(t,"class","row")},m(e,c){u(e,t,c),d(t,l),d(l,n),d(n,a),d(l,s),d(l,r),d(t,b),d(t,y),d(y,x),d(x,w),d(y,S),d(y,$);for(let e=0;e<N.length;e+=1)N[e]&&N[e].m($,null);O||(L=h(r,"change",C),O=!0)},p(t,l){if(e=t,1&l[0]&&H!==(H=e[0]("masking.replacement_mask_hint")+"")&&p(a,H),2&l[0]&&m!==(m=e[43].replacement||"")&&r.value!==m&&(r.value=m),1&l[0]&&v!==(v=e[0]("masking.placeholder_replacement"))&&_(r,"placeholder",v),1&l[0]&&U!==(U=e[0]("masking.entities")+"")&&p(w,U),518&l[0]){let t;for(T=c(Object.entries(e[2])),t=0;t<T.length;t+=1){const n=j(e,T,t);N[t]?N[t].p(n,l):(N[t]=P(n),N[t].c(),N[t].m($,null))}for(;t<N.length;t+=1)N[t].d(1);N.length=T.length}},d(e){e&&i(t),o(N,e),O=!1,L()}}}function N(e){let t,l,n,a,c,s,o,r,m,v=e[0]("masking.replacement")+"";function b(...t){return e[21](e[45],...t)}return{c(){t=f("div"),l=f("div"),n=f("label"),a=k(v),c=g(),s=f("input"),_(s,"type","text"),_(s,"class","form-control form-control-sm"),s.value=o=e[43].replacement||"*",_(l,"class","col-6"),_(t,"class","row")},m(e,i){u(e,t,i),d(t,l),d(l,n),d(n,a),d(l,c),d(l,s),r||(m=h(s,"change",b),r=!0)},p(t,l){e=t,1&l[0]&&v!==(v=e[0]("masking.replacement")+"")&&p(a,v),2&l[0]&&o!==(o=e[43].replacement||"*")&&s.value!==o&&(s.value=o)},d(e){e&&i(t),r=!1,m()}}}function E(e){let t,l,n,a,c,s,o,m,v,b,y,x,w,S,$,O,L=e[0]("masking.replacement")+"",H=e[0]("masking.replacement_domain")+"";function j(...t){return e[19](e[45],...t)}function U(...t){return e[20](e[45],...t)}return{c(){t=f("div"),l=f("div"),n=f("label"),a=k(L),c=g(),s=f("input"),m=g(),v=f("div"),b=f("label"),y=k(H),x=g(),w=f("input"),_(s,"type","text"),_(s,"class","form-control form-control-sm"),s.value=o=e[43].replacement||"$",_(l,"class","col-6"),_(w,"type","text"),_(w,"class","form-control form-control-sm"),w.value=S=e[43].replacement_domain||"*",_(v,"class","col-6"),_(t,"class","row")},m(e,i){u(e,t,i),d(t,l),d(l,n),d(n,a),d(l,c),d(l,s),d(t,m),d(t,v),d(v,b),d(b,y),d(v,x),d(v,w),$||(O=[h(s,"change",j),h(w,"change",U)],$=!0)},p(t,l){e=t,1&l[0]&&L!==(L=e[0]("masking.replacement")+"")&&p(a,L),2&l[0]&&o!==(o=e[43].replacement||"$")&&s.value!==o&&(s.value=o),1&l[0]&&H!==(H=e[0]("masking.replacement_domain")+"")&&p(y,H),2&l[0]&&S!==(S=e[43].replacement_domain||"*")&&w.value!==S&&(w.value=S)},d(e){e&&i(t),$=!1,r(O)}}}function J(e){let t,l,n,a,c,s,o,m,v,b,y,x,w,S,$,O,L,H,j,U,C,T,N,E,J,P=(e[0]("masking.name")||"Name")+"",I=e[0]("masking.pattern")+"",R=(e[0]("masking.replacement_optional")||"Replacement (optional)")+"";function q(...t){return e[16](e[45],...t)}function A(...t){return e[17](e[45],...t)}function F(...t){return e[18](e[45],...t)}return{c(){t=f("div"),l=f("div"),n=f("label"),a=k(P),c=g(),s=f("input"),v=g(),b=f("div"),y=f("label"),x=k(I),w=g(),S=f("input"),O=g(),L=f("div"),H=f("label"),j=k(R),U=g(),C=f("input"),_(s,"type","text"),_(s,"class","form-control form-control-sm"),s.value=o=e[43].name||"",_(s,"placeholder",m=e[0]("masking.placeholder_name")),_(l,"class","col-4"),_(S,"type","text"),_(S,"class","form-control form-control-sm"),S.value=$=e[43].pattern||"",_(b,"class","col-4"),_(C,"type","text"),_(C,"class","form-control form-control-sm"),C.value=T=e[43].replacement||"",_(C,"placeholder",N=e[0]("masking.placeholder_replacement")),_(L,"class","col-4"),_(t,"class","row")},m(e,i){u(e,t,i),d(t,l),d(l,n),d(n,a),d(l,c),d(l,s),d(t,v),d(t,b),d(b,y),d(y,x),d(b,w),d(b,S),d(t,O),d(t,L),d(L,H),d(H,j),d(L,U),d(L,C),E||(J=[h(s,"change",q),h(S,"change",A),h(C,"change",F)],E=!0)},p(t,l){e=t,1&l[0]&&P!==(P=(e[0]("masking.name")||"Name")+"")&&p(a,P),2&l[0]&&o!==(o=e[43].name||"")&&s.value!==o&&(s.value=o),1&l[0]&&m!==(m=e[0]("masking.placeholder_name"))&&_(s,"placeholder",m),1&l[0]&&I!==(I=e[0]("masking.pattern")+"")&&p(x,I),2&l[0]&&$!==($=e[43].pattern||"")&&S.value!==$&&(S.value=$),1&l[0]&&R!==(R=(e[0]("masking.replacement_optional")||"Replacement (optional)")+"")&&p(j,R),2&l[0]&&T!==(T=e[43].replacement||"")&&C.value!==T&&(C.value=T),1&l[0]&&N!==(N=e[0]("masking.placeholder_replacement"))&&_(C,"placeholder",N)},d(e){e&&i(t),E=!1,r(J)}}}function P(e){let t,l,n,a,c,s,o,r,m,v,b,y,x=e[47]+"";function w(...t){return e[23](e[45],e[46],...t)}return{c(){t=f("div"),l=f("div"),n=f("input"),s=g(),o=f("label"),r=k(x),v=g(),_(n,"class","form-check-input"),_(n,"type","checkbox"),_(n,"id",a="pii-"+e[45]+"-"+e[46]),n.checked=c=e[43].entities&&-1!==e[43].entities.indexOf(e[46]),_(o,"class","form-check-label"),_(o,"for",m="pii-"+e[45]+"-"+e[46]),_(l,"class","form-check"),_(t,"class","col-4")},m(e,a){u(e,t,a),d(t,l),d(l,n),d(l,s),d(l,o),d(o,r),d(t,v),b||(y=h(n,"change",w),b=!0)},p(t,l){e=t,4&l[0]&&a!==(a="pii-"+e[45]+"-"+e[46])&&_(n,"id",a),6&l[0]&&c!==(c=e[43].entities&&-1!==e[43].entities.indexOf(e[46]))&&(n.checked=c),4&l[0]&&x!==(x=e[47]+"")&&p(r,x),4&l[0]&&m!==(m="pii-"+e[45]+"-"+e[46])&&_(o,"for",m)},d(e){e&&i(t),b=!1,y()}}}function I(e){let t,l,n,a,c,s,o,r,m,v,b,y,x,w=(e[5][e[43].type]||e[43].type.toUpperCase())+"",S=e[0]("masking.delete")+"";function $(){return e[15](e[45])}function O(e,t){return"regex"===e[43].type?J:"email"===e[43].type?E:"credit_card"===e[43].type?N:"pii"===e[43].type?T:"secret_keys"===e[43].type?C:"urls"===e[43].type?U:void 0}let L=O(e),H=L&&L(e);return{c(){t=f("div"),l=f("div"),n=f("div"),a=f("strong"),c=k(w),s=g(),o=f("button"),r=k(S),m=g(),v=f("div"),H&&H.c(),b=g(),_(o,"type","button"),_(o,"class","btn btn-sm btn-danger"),_(n,"class","d-flex justify-content-between align-items-center mb-2"),_(l,"class","card-body p-2"),_(t,"class","card mb-2")},m(e,i){u(e,t,i),d(t,l),d(l,n),d(n,a),d(a,c),d(n,s),d(n,o),d(o,r),d(l,m),d(l,v),H&&H.m(v,null),d(t,b),y||(x=h(o,"click",$),y=!0)},p(t,l){e=t,34&l[0]&&w!==(w=(e[5][e[43].type]||e[43].type.toUpperCase())+"")&&p(c,w),1&l[0]&&S!==(S=e[0]("masking.delete")+"")&&p(r,S),L===(L=O(e))&&H?H.p(e,l):(H&&H.d(1),H=L&&L(e),H&&(H.c(),H.m(v,null)))},d(e){e&&i(t),H&&H.d(),y=!1,x()}}}function R(e){let t,l,n,a=e[40].label+"";return{c(){t=f("option"),l=k(a),t.__value=n=e[40].value,x(t,t.__value)},m(e,n){u(e,t,n),d(t,l)},p(e,c){16&c[0]&&a!==(a=e[40].label+"")&&p(l,a),16&c[0]&&n!==(n=e[40].value)&&(t.__value=n,x(t,t.__value))},d(e){e&&i(t)}}}function q(e){let t,l,n,a,b,y,x,w,S,$,O,j=e[0]("masking.add_rule")+"",U=c(e[1]),C=[];for(let t=0;t<U.length;t+=1)C[t]=I(H(e,U,t));let T=c(e[4]),N=[];for(let t=0;t<T.length;t+=1)N[t]=R(L(e,T,t));return{c(){t=f("div");for(let e=0;e<C.length;e+=1)C[e].c();l=g(),n=f("div"),a=f("div"),b=f("select");for(let e=0;e<N.length;e+=1)N[e].c();y=g(),x=f("div"),w=f("button"),S=k(j),_(t,"id","rules-container"),_(b,"class","form-control form-control-sm"),void 0===e[3]&&v((()=>e[36].call(b))),_(a,"class","col-auto"),_(w,"type","button"),_(w,"class","btn btn-sm btn-secondary"),_(x,"class","col-auto"),_(n,"class","row mt-2")},m(c,s){u(c,t,s);for(let e=0;e<C.length;e+=1)C[e]&&C[e].m(t,null);u(c,l,s),u(c,n,s),d(n,a),d(a,b);for(let e=0;e<N.length;e+=1)N[e]&&N[e].m(b,null);m(b,e[3],!0),d(n,y),d(n,x),d(x,w),d(w,S),$||(O=[h(b,"change",e[36]),h(w,"click",e[6])],$=!0)},p(e,l){if(8103&l[0]){let n;for(U=c(e[1]),n=0;n<U.length;n+=1){const a=H(e,U,n);C[n]?C[n].p(a,l):(C[n]=I(a),C[n].c(),C[n].m(t,null))}for(;n<C.length;n+=1)C[n].d(1);C.length=U.length}if(16&l[0]){let t;for(T=c(e[4]),t=0;t<T.length;t+=1){const n=L(e,T,t);N[t]?N[t].p(n,l):(N[t]=R(n),N[t].c(),N[t].m(b,null))}for(;t<N.length;t+=1)N[t].d(1);N.length=T.length}24&l[0]&&m(b,e[3]),1&l[0]&&j!==(j=e[0]("masking.add_rule")+"")&&p(S,j)},i:s,o:s,d(e){e&&(i(t),i(l),i(n)),o(C,e),o(N,e),$=!1,r(O)}}}function A(e){return(e.allowList||[]).join("\n")}function F(e){return(e.denyList||[]).join("\n")}function M(e,t,l){let n,a,c;b(e,$,(e=>l(0,c=e)));let{pii_options:s="{}"}=t,{input_selector:i='textarea[name="AbstractInput_pattern"]'}=t,o=[],r=null,m={},p="regex";function u(){r&&(r.value=JSON.stringify(o))}function d(e){l(1,o=o.filter(((t,l)=>l!==e))),u()}function h(e,t,n){l(1,o[e][t]=n,o),l(1,o=[...o]),u()}function f(e,t,n){o[e].entities||l(1,o[e].entities=[],o),n?-1===o[e].entities.indexOf(t)&&l(1,o[e].entities=[...o[e].entities,t],o):l(1,o[e].entities=o[e].entities.filter((e=>e!==t)),o),l(1,o=[...o]),u()}function g(e,t,n){o[e].allowedSchemes||l(1,o[e].allowedSchemes=[],o),n?-1===o[e].allowedSchemes.indexOf(t)&&l(1,o[e].allowedSchemes=[...o[e].allowedSchemes,t],o):l(1,o[e].allowedSchemes=o[e].allowedSchemes.filter((e=>e!==t)),o),l(1,o=[...o]),u()}function k(e,t){l(1,o[e].allowList=t.split("\n").map((e=>e.trim())).filter((e=>""!==e)),o),o[e].allowList.length>0&&l(1,o[e].denyList=[],o),l(1,o=[...o]),u()}function _(e,t){l(1,o[e].denyList=t.split("\n").map((e=>e.trim())).filter((e=>""!==e)),o),o[e].denyList.length>0&&l(1,o[e].allowList=[],o),l(1,o=[...o]),u()}y((async()=>{l(2,m="string"==typeof s?JSON.parse(s):s),r=document.querySelector(i),r&&function(e){try{if(e.trim().startsWith("["))l(1,o=JSON.parse(e));else if(""!==e.trim()){const t=e.split("\n");l(1,o=[]),t.forEach((function(e){if(""===e.trim())return;const t=e.split("|||"),l={type:"regex",pattern:t[0]};t.length>1&&(l.replacement=t[1]),t.length>2&&"__email__"===t[0]&&(l.replacement_domain=t[2]),o.push(l)}))}}catch(e){console.error("Error parsing rules",e),l(1,o=[])}}(r.value)}));return e.$$set=e=>{"pii_options"in e&&l(13,s=e.pii_options),"input_selector"in e&&l(14,i=e.input_selector)},e.$$.update=()=>{1&e.$$.dirty[0]&&l(5,n={regex:c("masking.type_regex"),email:c("masking.type_email"),credit_card:c("masking.type_credit_card"),pii:c("masking.type_pii"),secret_keys:c("masking.type_secret_keys"),urls:c("masking.type_urls")}),1&e.$$.dirty[0]&&l(4,a=[{value:"regex",label:c("masking.type_regex")},{value:"email",label:c("masking.type_email")},{value:"credit_card",label:c("masking.type_credit_card")},{value:"pii",label:c("masking.type_pii")},{value:"secret_keys",label:c("masking.type_secret_keys")},{value:"urls",label:c("masking.type_urls")}])},[c,o,m,p,a,n,function(){const e={type:p};"email"===p?(e.replacement="$",e.replacement_domain="*"):"credit_card"===p?e.replacement="*":"regex"===p?(e.pattern="",e.replacement="",e.name=""):"pii"===p?e.entities=[]:"secret_keys"===p?e.threshold="balanced":"urls"===p&&(e.allowedSchemes=["https"],e.blockUserinfo=!0,e.allowSubdomains=!1,e.allowList=[],e.denyList=[],e.allowHostedHost=!1),l(1,o=[...o,e]),u()},d,h,f,g,k,_,s,i,e=>d(e),(e,t)=>h(e,"name",t.target.value),(e,t)=>h(e,"pattern",t.target.value),(e,t)=>h(e,"replacement",t.target.value),(e,t)=>h(e,"replacement",t.target.value),(e,t)=>h(e,"replacement_domain",t.target.value),(e,t)=>h(e,"replacement",t.target.value),(e,t)=>h(e,"replacement",t.target.value),(e,t,l)=>f(e,t,l.target.checked),(e,t)=>h(e,"threshold",t.target.value),(e,t)=>h(e,"replacement",t.target.value),(e,t)=>h(e,"replacement",t.target.value),(e,t)=>g(e,"https",t.target.checked),(e,t)=>g(e,"http",t.target.checked),(e,t)=>g(e,"ftp",t.target.checked),(e,t)=>g(e,"mailto",t.target.checked),(e,t)=>h(e,"blockUserinfo",t.target.checked),(e,t)=>h(e,"allowSubdomains",t.target.checked),(e,t)=>h(e,"allowHostedHost",t.target.checked),(e,t)=>k(e,t.target.value),(e,t)=>_(e,t.target.value),function(){p=w(this),l(3,p),l(4,a),l(0,c)}]}O();class W extends t{constructor(e){super(),l(this,e,M,q,n,{pii_options:13,input_selector:14},null,[-1,-1])}get pii_options(){return this.$$.ctx[13]}set pii_options(e){this.$$set({pii_options:e}),a()}get input_selector(){return this.$$.ctx[14]}set input_selector(e){this.$$set({input_selector:e}),a()}}customElements.define("lhc-masking-rules",e(W,{pii_options:{},input_selector:{}},[],[],!1));export{W as LHCMaskingRules};
//# sourceMappingURL=masking.js.map
