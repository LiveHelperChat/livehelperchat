{"version":3,"file":"createI18n.BB63WmYP.js","sources":["../../node_modules/svelte/src/runtime/store/index.js","../../src/i18n/createI18n.js"],"sourcesContent":["import {\n\trun_all,\n\tsubscribe,\n\tnoop,\n\tsafe_not_equal,\n\tis_function,\n\tget_store_value\n} from '../internal/index.js';\n\nconst subscriber_queue = [];\n\n/**\n * Creates a `Readable` store that allows reading by subscription.\n *\n * https://svelte.dev/docs/svelte-store#readable\n * @template T\n * @param {T} [value] initial value\n * @param {import('./public.js').StartStopNotifier<T>} [start]\n * @returns {import('./public.js').Readable<T>}\n */\nexport function readable(value, start) {\n\treturn {\n\t\tsubscribe: writable(value, start).subscribe\n\t};\n}\n\n/**\n * Create a `Writable` store that allows both updating and reading by subscription.\n *\n * https://svelte.dev/docs/svelte-store#writable\n * @template T\n * @param {T} [value] initial value\n * @param {import('./public.js').StartStopNotifier<T>} [start]\n * @returns {import('./public.js').Writable<T>}\n */\nexport function writable(value, start = noop) {\n\t/** @type {import('./public.js').Unsubscriber} */\n\tlet stop;\n\t/** @type {Set<import('./private.js').SubscribeInvalidateTuple<T>>} */\n\tconst subscribers = new Set();\n\t/** @param {T} new_value\n\t * @returns {void}\n\t */\n\tfunction set(new_value) {\n\t\tif (safe_not_equal(value, new_value)) {\n\t\t\tvalue = new_value;\n\t\t\tif (stop) {\n\t\t\t\t// store is ready\n\t\t\t\tconst run_queue = !subscriber_queue.length;\n\t\t\t\tfor (const subscriber of subscribers) {\n\t\t\t\t\tsubscriber[1]();\n\t\t\t\t\tsubscriber_queue.push(subscriber, value);\n\t\t\t\t}\n\t\t\t\tif (run_queue) {\n\t\t\t\t\tfor (let i = 0; i < subscriber_queue.length; i += 2) {\n\t\t\t\t\t\tsubscriber_queue[i][0](subscriber_queue[i + 1]);\n\t\t\t\t\t}\n\t\t\t\t\tsubscriber_queue.length = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @param {import('./public.js').Updater<T>} fn\n\t * @returns {void}\n\t */\n\tfunction update(fn) {\n\t\tset(fn(value));\n\t}\n\n\t/**\n\t * @param {import('./public.js').Subscriber<T>} run\n\t * @param {import('./private.js').Invalidator<T>} [invalidate]\n\t * @returns {import('./public.js').Unsubscriber}\n\t */\n\tfunction subscribe(run, invalidate = noop) {\n\t\t/** @type {import('./private.js').SubscribeInvalidateTuple<T>} */\n\t\tconst subscriber = [run, invalidate];\n\t\tsubscribers.add(subscriber);\n\t\tif (subscribers.size === 1) {\n\t\t\tstop = start(set, update) || noop;\n\t\t}\n\t\trun(value);\n\t\treturn () => {\n\t\t\tsubscribers.delete(subscriber);\n\t\t\tif (subscribers.size === 0 && stop) {\n\t\t\t\tstop();\n\t\t\t\tstop = null;\n\t\t\t}\n\t\t};\n\t}\n\treturn { set, update, subscribe };\n}\n\n/**\n * Derived value store by synchronizing one or more readable stores and\n * applying an aggregation function over its input values.\n *\n * https://svelte.dev/docs/svelte-store#derived\n * @template {import('./private.js').Stores} S\n * @template T\n * @overload\n * @param {S} stores - input stores\n * @param {(values: import('./private.js').StoresValues<S>, set: (value: T) => void, update: (fn: import('./public.js').Updater<T>) => void) => import('./public.js').Unsubscriber | void} fn - function callback that aggregates the values\n * @param {T} [initial_value] - initial value\n * @returns {import('./public.js').Readable<T>}\n */\n\n/**\n * Derived value store by synchronizing one or more readable stores and\n * applying an aggregation function over its input values.\n *\n * https://svelte.dev/docs/svelte-store#derived\n * @template {import('./private.js').Stores} S\n * @template T\n * @overload\n * @param {S} stores - input stores\n * @param {(values: import('./private.js').StoresValues<S>) => T} fn - function callback that aggregates the values\n * @param {T} [initial_value] - initial value\n * @returns {import('./public.js').Readable<T>}\n */\n\n/**\n * @template {import('./private.js').Stores} S\n * @template T\n * @param {S} stores\n * @param {Function} fn\n * @param {T} [initial_value]\n * @returns {import('./public.js').Readable<T>}\n */\nexport function derived(stores, fn, initial_value) {\n\tconst single = !Array.isArray(stores);\n\t/** @type {Array<import('./public.js').Readable<any>>} */\n\tconst stores_array = single ? [stores] : stores;\n\tif (!stores_array.every(Boolean)) {\n\t\tthrow new Error('derived() expects stores as input, got a falsy value');\n\t}\n\tconst auto = fn.length < 2;\n\treturn readable(initial_value, (set, update) => {\n\t\tlet started = false;\n\t\tconst values = [];\n\t\tlet pending = 0;\n\t\tlet cleanup = noop;\n\t\tconst sync = () => {\n\t\t\tif (pending) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tcleanup();\n\t\t\tconst result = fn(single ? values[0] : values, set, update);\n\t\t\tif (auto) {\n\t\t\t\tset(result);\n\t\t\t} else {\n\t\t\t\tcleanup = is_function(result) ? result : noop;\n\t\t\t}\n\t\t};\n\t\tconst unsubscribers = stores_array.map((store, i) =>\n\t\t\tsubscribe(\n\t\t\t\tstore,\n\t\t\t\t(value) => {\n\t\t\t\t\tvalues[i] = value;\n\t\t\t\t\tpending &= ~(1 << i);\n\t\t\t\t\tif (started) {\n\t\t\t\t\t\tsync();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t() => {\n\t\t\t\t\tpending |= 1 << i;\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\tstarted = true;\n\t\tsync();\n\t\treturn function stop() {\n\t\t\trun_all(unsubscribers);\n\t\t\tcleanup();\n\t\t\t// We need to set this to false because callbacks can still happen despite having unsubscribed:\n\t\t\t// Callbacks might already be placed in the queue which doesn't know it should no longer\n\t\t\t// invoke this derived store.\n\t\t\tstarted = false;\n\t\t};\n\t});\n}\n\n/**\n * Takes a store and returns a new one derived from the old one that is readable.\n *\n * https://svelte.dev/docs/svelte-store#readonly\n * @template T\n * @param {import('./public.js').Readable<T>} store  - store to make readonly\n * @returns {import('./public.js').Readable<T>}\n */\nexport function readonly(store) {\n\treturn {\n\t\tsubscribe: store.subscribe.bind(store)\n\t};\n}\n\nexport { get_store_value as get };\n","import { derived, writable } from \"svelte/store\";\r\n\r\n/**\r\n * Creates an i18n instance for a specific scope/namespace\r\n * @param {string} scope - The translation namespace (e.g., 'lhcbo', 'masking', 'group_chat')\r\n * @returns {Object} - { t, translations, initTranslations }\r\n */\r\nexport function createI18n(scope) {\r\n    const translations = writable({});\r\n    let loaded = false;\r\n\r\n    async function loadTranslations() {\r\n        if (loaded) return;\r\n        \r\n        try {\r\n            const response = await fetch(WWW_DIR_JAVASCRIPT + \"restapi/lang/\" + scope + '/v12', {\r\n                method: \"GET\",\r\n                headers: {\r\n                    Accept: \"application/json\",\r\n                    \"Content-Type\": \"application/json\",\r\n                    \"X-CSRFToken\": confLH.csrf_token\r\n                }\r\n            });\r\n            const data = await response.json();\r\n            translations.set(data);\r\n            loaded = true;\r\n        } catch (error) {\r\n            console.log(`Translations for scope \"${scope}\" could not be loaded!`);\r\n        }\r\n    }\r\n\r\n    function translate($translations, key, vars) {\r\n        if (!key) throw new Error(\"no key provided to $t()\");\r\n\r\n        let text = $translations[key];\r\n\r\n        if (!text) {\r\n            return key;\r\n        }\r\n\r\n        // Replace any passed in variables in the translation string.\r\n        Object.keys(vars).map((k) => {\r\n            const regex = new RegExp(`{{${k}}}`, \"g\");\r\n            text = text.replace(regex, vars[k]);\r\n        });\r\n\r\n        return text;\r\n    }\r\n\r\n    const t = derived(translations, ($translations) => (key, vars = {}) => {\r\n        return translate($translations, key, vars);\r\n    });\r\n\r\n    return {\r\n        t,\r\n        translations,\r\n        initTranslations: loadTranslations\r\n    };\r\n}\r\n"],"names":["subscriber_queue","writable","value","start","noop","stop","subscribers","Set","set","new_value","safe_not_equal","run_queue","length","subscriber","push","i","update","fn","subscribe","run","invalidate","add","size","delete","derived","stores","initial_value","single","Array","isArray","stores_array","every","Boolean","Error","auto","started","values","pending","cleanup","sync","result","is_function","unsubscribers","map","store","run_all","createI18n","scope","translations","loaded","t","$translations","key","vars","text","Object","keys","k","regex","RegExp","replace","translate","initTranslations","async","response","fetch","WWW_DIR_JAVASCRIPT","method","headers","Accept","confLH","csrf_token","data","json","error","console","log"],"mappings":"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","x_google_ignoreList":[0]}