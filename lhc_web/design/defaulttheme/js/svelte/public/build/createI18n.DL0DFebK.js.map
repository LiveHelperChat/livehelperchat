{"version":3,"file":"createI18n.DL0DFebK.js","sources":["../../src/i18n/createI18n.js"],"sourcesContent":["import { derived, writable } from \"svelte/store\";\r\n\r\n/**\r\n * Creates an i18n instance for a specific scope/namespace\r\n * @param {string} scope - The translation namespace (e.g., 'lhcbo', 'masking', 'group_chat')\r\n * @returns {Object} - { t, translations, initTranslations }\r\n */\r\nexport function createI18n(scope) {\r\n    const translations = writable({});\r\n    let loaded = false;\r\n\r\n    async function loadTranslations() {\r\n        if (loaded) return;\r\n        \r\n        try {\r\n            const response = await fetch(WWW_DIR_JAVASCRIPT + \"restapi/lang/\" + scope + '/v16', {\r\n                method: \"GET\",\r\n                headers: {\r\n                    Accept: \"application/json\",\r\n                    \"Content-Type\": \"application/json\",\r\n                    \"X-CSRFToken\": confLH.csrf_token\r\n                }\r\n            });\r\n            const data = await response.json();\r\n            translations.set(data);\r\n            loaded = true;\r\n        } catch (error) {\r\n            console.log(`Translations for scope \"${scope}\" could not be loaded!`);\r\n        }\r\n    }\r\n\r\n    function translate($translations, key, vars) {\r\n        if (!key) throw new Error(\"no key provided to $t()\");\r\n\r\n        let text = $translations[key];\r\n\r\n        if (!text) {\r\n            return key;\r\n        }\r\n\r\n        // Replace any passed in variables in the translation string.\r\n        Object.keys(vars).map((k) => {\r\n            const regex = new RegExp(`{{${k}}}`, \"g\");\r\n            text = text.replace(regex, vars[k]);\r\n        });\r\n\r\n        return text;\r\n    }\r\n\r\n    const t = derived(translations, ($translations) => (key, vars = {}) => {\r\n        return translate($translations, key, vars);\r\n    });\r\n\r\n    return {\r\n        t,\r\n        translations,\r\n        initTranslations: loadTranslations\r\n    };\r\n}\r\n"],"names":["createI18n","scope","translations","writable","loaded","t","derived","$translations","key","vars","Error","text","Object","keys","map","k","regex","RegExp","replace","translate","initTranslations","async","response","fetch","WWW_DIR_JAVASCRIPT","method","headers","Accept","confLH","csrf_token","data","json","set","error","console","log"],"mappings":"wDAOO,SAASA,EAAWC,GACvB,MAAMC,EAAeC,EAAS,CAAA,GAC9B,IAAIC,GAAS,EA4Cb,MAAO,CACHC,EALMC,EAAQJ,GAAeK,GAAkB,CAACC,EAAKC,EAAO,KAlBhE,SAAmBF,EAAeC,EAAKC,GACnC,IAAKD,EAAK,MAAM,IAAIE,MAAM,2BAE1B,IAAIC,EAAOJ,EAAcC,GAEzB,OAAKG,GAKLC,OAAOC,KAAKJ,GAAMK,KAAKC,IACnB,MAAMC,EAAQ,IAAIC,OAAO,KAAKF,MAAO,KACrCJ,EAAOA,EAAKO,QAAQF,EAAOP,EAAKM,GAAG,IAGhCJ,GATIH,CAUf,CAGWW,CAAUZ,EAAeC,EAAKC,KAKrCP,eACAkB,iBA7CJC,iBACI,IAAIjB,EAEJ,IACI,MAAMkB,QAAiBC,MAAMC,mBAAqB,gBAAkBvB,EAAQ,OAAQ,CAChFwB,OAAQ,MACRC,QAAS,CACLC,OAAQ,mBACR,eAAgB,mBAChB,cAAeC,OAAOC,cAGxBC,QAAaR,EAASS,OAC5B7B,EAAa8B,IAAIF,GACjB1B,GAAS,CACb,CAAE,MAAO6B,GACLC,QAAQC,IAAI,2BAA2BlC,0BAC3C,CACJ,EA6BJ"}