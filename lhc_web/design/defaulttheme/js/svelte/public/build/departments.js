import{c as e,S as t,i as n,s as l,f as a,e as s,n as r,d as i,a as o,b as c,g as u,h as d,j as p,l as m,k as h,t as f,m as g,o as _,p as $,q as v}from"./index.DKABnuqJ.js";function b(e,t,n){const l=e.slice();return l[25]=t[n],l}function x(e,t,n){const l=e.slice();return l[28]=t[n],l}function j(e,t,n){const l=e.slice();return l[25]=t[n],l}function y(e){let t,n,l,a,s,r,o,_,v,b,x,j=e[11](e[25])+"";function y(){return e[16](e[25])}return{c(){t=h("div"),n=h("a"),l=h("input"),s=g(),r=h("i"),r.textContent="delete",o=f(j),v=g(),u(l,"type","hidden"),l.value=a=e[25],u(l,"name",e[0]),u(r,"class","material-icons chat-unread"),u(n,"data-stoppropagation","true"),u(n,"class","delete-item"),u(n,"data-value",_=e[25]),u(t,"class","fs12")},m(e,a){d(e,t,a),p(t,n),p(n,l),p(n,s),p(n,r),p(n,o),p(t,v),b||(x=m(n,"click",$(y)),b=!0)},p(t,s){e=t,16&s[0]&&a!==(a=e[25])&&(l.value=a),1&s[0]&&u(l,"name",e[0]),16&s[0]&&j!==(j=e[11](e[25])+"")&&c(o,j),16&s[0]&&_!==(_=e[25])&&u(n,"data-value",_)},d(e){e&&i(t),b=!1,x()}}}function w(e){let t,n=s(e[3]),l=[];for(let t=0;t<n.length;t+=1)l[t]=A(x(e,n,t));return{c(){for(let e=0;e<l.length;e+=1)l[e].c();t=v()},m(e,n){for(let t=0;t<l.length;t+=1)l[t]&&l[t].m(e,n);d(e,t,n)},p(e,a){if(1289&a[0]){let r;for(n=s(e[3]),r=0;r<n.length;r+=1){const s=x(e,n,r);l[r]?l[r].p(s,a):(l[r]=A(s),l[r].c(),l[r].m(t.parentNode,t))}for(;r<l.length;r+=1)l[r].d(1);l.length=n.length}},d(e){e&&i(t),o(l,e)}}}function k(e){let t;return{c(){t=h("li"),t.innerHTML="<small>No departments found</small>",u(t,"data-stoppropagation","true"),u(t,"class","search-option-item text-center")},m(e,n){d(e,t,n)},p:r,d(e){e&&i(t)}}}function S(e){let t;return{c(){t=h("li"),t.innerHTML="<small>Loading...</small>",u(t,"data-stoppropagation","true"),u(t,"class","search-option-item text-center")},m(e,n){d(e,t,n)},p:r,d(e){e&&i(t)}}}function A(e){let t,n,l,a,s,r,o,_,$,v,b,x,j=e[28].name+"";function y(){return e[17](e[28])}return{c(){t=h("li"),n=h("label"),l=h("input"),_=g(),$=f(j),v=g(),u(l,"title",a=e[28].id),u(l,"class","me-1"),u(l,"type","radio"),u(l,"name",s="selector-"+e[0]),l.checked=r=e[10](e[28].id),l.value=o=e[28].id,u(t,"data-stoppropagation","true"),u(t,"class","search-option-item")},m(e,a){d(e,t,a),p(t,n),p(n,l),p(n,_),p(n,$),p(t,v),b||(x=m(l,"change",y),b=!0)},p(t,n){e=t,8&n[0]&&a!==(a=e[28].id)&&u(l,"title",a),1&n[0]&&s!==(s="selector-"+e[0])&&u(l,"name",s),8&n[0]&&r!==(r=e[10](e[28].id))&&(l.checked=r),8&n[0]&&o!==(o=e[28].id)&&(l.value=o),8&n[0]&&j!==(j=e[28].name+"")&&c($,j)},d(e){e&&i(t),b=!1,x()}}}function C(e){let t,n,l,a,s,r,o,_=e[11](e[25])+"";function $(){return e[18](e[25])}return{c(){t=h("span"),n=f(_),l=g(),a=h("span"),a.textContent="delete",s=g(),u(a,"class","material-icons text-warning me-0"),u(t,"role","tabpanel"),u(t,"title","Click to remove"),u(t,"class","badge bg-secondary m-1 action-image")},m(e,i){d(e,t,i),p(t,n),p(t,l),p(t,a),p(t,s),r||(o=m(t,"click",$),r=!0)},p(t,l){e=t,16&l[0]&&_!==(_=e[11](e[25])+"")&&c(n,_)},d(e){e&&i(t),r=!1,o()}}}function J(e){let t,n,l,a,_,$,v,x,A,J,N,W,D,E,R,q,I,L,O,T,P,H=s(e[4]),M=[];for(let t=0;t<H.length;t+=1)M[t]=y(j(e,H,t));function V(e,t){return e[6]?S:0===e[3].length?k:w}let U=V(e),z=U(e),B=s(e[4]),F=[];for(let t=0;t<B.length;t+=1)F[t]=C(b(e,B,t));return{c(){t=h("div"),n=h("div"),l=h("div"),a=h("ul"),_=h("li"),$=h("button"),v=f(e[2]),x=g(),A=h("ul"),J=h("li"),N=h("input"),D=g(),E=h("div");for(let e=0;e<M.length;e+=1)M[e].c();R=g(),q=h("li"),I=h("ul"),z.c(),L=g(),O=h("div");for(let e=0;e<F.length;e+=1)F[e].c();u($,"type","button"),u($,"class","btn btn-light btn-block btn-sm dropdown-toggle btn-department-dropdown"),u($,"data-bs-toggle","dropdown"),u($,"aria-expanded","false"),u(N,"data-scope",W=e[0].replace("[]","")),u(N,"ajax-provider",e[1]),u(N,"type","text"),u(N,"class","form-control input-sm"),N.value=e[5],u(E,"class","selected-items-filter"),u(J,"class","btn-block-department-filter"),u(I,"class","list-unstyled dropdown-lhc"),u(q,"class","dropdown-result"),u(A,"class","dropdown-menu"),u(A,"role","menu"),u(_,"class","dropdown w-100"),u(a,"class","nav"),u(l,"class","btn-block-department"),u(l,"data-limit","1"),u(n,"class","col-4"),u(O,"class","col-8"),u(t,"class","row")},m(s,r){d(s,t,r),p(t,n),p(n,l),p(l,a),p(a,_),p(_,$),p($,v),p(_,x),p(_,A),p(A,J),p(J,N),p(J,D),p(J,E);for(let e=0;e<M.length;e+=1)M[e]&&M[e].m(E,null);p(A,R),p(A,q),p(q,I),z.m(I,null),p(t,L),p(t,O);for(let e=0;e<F.length;e+=1)F[e]&&F[e].m(O,null);T||(P=m(N,"input",e[7]),T=!0)},p(e,t){if(4&t[0]&&c(v,e[2]),1&t[0]&&W!==(W=e[0].replace("[]",""))&&u(N,"data-scope",W),2&t[0]&&u(N,"ajax-provider",e[1]),32&t[0]&&N.value!==e[5]&&(N.value=e[5]),2577&t[0]){let n;for(H=s(e[4]),n=0;n<H.length;n+=1){const l=j(e,H,n);M[n]?M[n].p(l,t):(M[n]=y(l),M[n].c(),M[n].m(E,null))}for(;n<M.length;n+=1)M[n].d(1);M.length=H.length}if(U===(U=V(e))&&z?z.p(e,t):(z.d(1),z=U(e),z&&(z.c(),z.m(I,null))),2576&t[0]){let n;for(B=s(e[4]),n=0;n<B.length;n+=1){const l=b(e,B,n);F[n]?F[n].p(l,t):(F[n]=C(l),F[n].c(),F[n].m(O,null))}for(;n<F.length;n+=1)F[n].d(1);F.length=B.length}},i:r,o:r,d(e){e&&i(t),o(M,e),z.d(),o(F,e),T=!1,P()}}}function N(e,t,n){let{input_name:l="department_ids[]"}=t,{input_selector:a=""}=t,{selected_ids:s="[]"}=t,{ajax_url:r="chat/searchprovider/deps"}=t,{placeholder:i="Choose department"}=t,{base_url:o=""}=t,{json_input:c=""}=t,u=[],d=[],p="",m=!1,h=null,f=null,g={};async function $(e=""){n(6,m=!0);try{const t=new URL((o||(void 0!==window.WWW_DIR_JAVASCRIPT?window.WWW_DIR_JAVASCRIPT:"/"))+r,window.location.origin);e&&t.searchParams.set("q",e);const l=await fetch(t.toString()),a=await l.json();a.items&&(n(3,u=a.items),u.forEach((e=>{g[e.id]=e.name})),g={...g})}catch(e){console.error("Error loading departments",e)}n(6,m=!1)}function v(e){d.includes(e.id)||(g[e.id]=e.name,n(4,d=[...d,e.id]),x())}function b(e){n(4,d=d.filter((t=>t!==e))),x()}function x(){h&&(h.value=JSON.stringify(d)),f&&(f.value=JSON.stringify(d))}_((()=>{c&&(f=document.querySelector('input[name="'+c+'"], textarea[name="'+c+'"]'));try{const e="string"==typeof s?JSON.parse(s):s;Array.isArray(e)&&n(4,d=e.map((e=>"object"==typeof e&&void 0!==e.id?(g[e.id]=e.name||`Department #${e.id}`,e.id):e)))}catch(e){console.error("Error parsing selected_ids",e)}if(a&&(h=document.querySelector(a),h&&h.value))try{const e=JSON.parse(h.value);Array.isArray(e)&&n(4,d=e.map((e=>"object"==typeof e&&void 0!==e.id?(g[e.id]=e.name||`Department #${e.id}`,e.id):e)))}catch(e){console.error("Error parsing hidden input value",e)}$()}));return e.$$set=e=>{"input_name"in e&&n(0,l=e.input_name),"input_selector"in e&&n(12,a=e.input_selector),"selected_ids"in e&&n(13,s=e.selected_ids),"ajax_url"in e&&n(1,r=e.ajax_url),"placeholder"in e&&n(2,i=e.placeholder),"base_url"in e&&n(14,o=e.base_url),"json_input"in e&&n(15,c=e.json_input)},[l,r,i,u,d,p,m,function(e){n(5,p=e.target.value),$(p)},v,b,function(e){return d.includes(e)},function(e){return g[e]||`Department #${e}`},a,s,o,c,e=>b(e),e=>v(e),e=>b(e)]}class W extends t{constructor(e){super(),n(this,e,N,J,l,{input_name:0,input_selector:12,selected_ids:13,ajax_url:1,placeholder:2,base_url:14,json_input:15},null,[-1,-1])}get input_name(){return this.$$.ctx[0]}set input_name(e){this.$$set({input_name:e}),a()}get input_selector(){return this.$$.ctx[12]}set input_selector(e){this.$$set({input_selector:e}),a()}get selected_ids(){return this.$$.ctx[13]}set selected_ids(e){this.$$set({selected_ids:e}),a()}get ajax_url(){return this.$$.ctx[1]}set ajax_url(e){this.$$set({ajax_url:e}),a()}get placeholder(){return this.$$.ctx[2]}set placeholder(e){this.$$set({placeholder:e}),a()}get base_url(){return this.$$.ctx[14]}set base_url(e){this.$$set({base_url:e}),a()}get json_input(){return this.$$.ctx[15]}set json_input(e){this.$$set({json_input:e}),a()}}customElements.define("lhc-department-picker",e(W,{input_name:{},input_selector:{},selected_ids:{},ajax_url:{},placeholder:{},base_url:{},json_input:{}},[],[],!1));export{W as LHCDepartmentPicker};
//# sourceMappingURL=departments.js.map
