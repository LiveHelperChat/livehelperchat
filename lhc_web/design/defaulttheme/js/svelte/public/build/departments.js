import{b as e,f as t,g as a,o as s,h as r,m as n,j as i,r as l,u as o,z as d,B as c,x as p,y as u,K as m,A as v,C as g,W as _,D as f,N as b,M as h,E as y,F as w,G as j,I as x,J as A,L as S,V as k,O as D,v as J,R as W}from"./custom-element.D-YWh2og.js";var E=o('<div class="fs12"><a data-stoppropagation="true" class="delete-item"><input type="hidden"/> <i class="material-icons chat-unread">delete</i> </a></div>'),N=o('<li data-stoppropagation="true" class="search-option-item text-center"><small>Loading...</small></li>'),R=o('<li data-stoppropagation="true" class="search-option-item text-center"><small>No departments found</small></li>'),$=o('<li data-stoppropagation="true" class="search-option-item"><label><input class="me-1" type="radio"/> </label></li>'),C=o('<span role="tabpanel" title="Click to remove" class="badge bg-secondary m-1 action-image"> <span class="material-icons text-warning me-0">delete</span></span>'),I=o('<div class="row"><div class="col-4"><div class="btn-block-department" data-limit="1"><ul class="nav"><li class="dropdown w-100"><button type="button" class="btn btn-light btn-block btn-sm dropdown-toggle btn-department-dropdown" data-bs-toggle="dropdown" aria-expanded="false"> </button> <ul class="dropdown-menu" role="menu"><li class="btn-block-department-filter"><input type="text" class="form-control input-sm"/> <div class="selected-items-filter"></div></li> <li class="dropdown-result"><ul class="list-unstyled dropdown-lhc"><!></ul></li></ul></li></ul></div></div> <div class="col-8"></div></div>');function O(e,o){t(o,!1);let O=a(o,"input_name",12,"department_ids[]"),q=a(o,"input_selector",12,""),L=a(o,"selected_ids",12,"[]"),P=a(o,"ajax_url",12,"chat/searchprovider/deps"),V=a(o,"placeholder",12,"Choose department"),T=a(o,"base_url",12,""),z=a(o,"json_input",12,""),B=n([]),F=n([]),G=n(""),K=n(!1),M=null,U=null,H={};async function Q(e=""){r(K,!0);try{const t=new URL((T()?T():void 0!==window.WWW_DIR_JAVASCRIPT?window.WWW_DIR_JAVASCRIPT:"/")+P(),window.location.origin);e&&t.searchParams.set("q",e);const a=await fetch(t.toString()),s=await a.json();s.items&&(r(B,s.items),i(B).forEach((e=>{H[e.id]=e.name})),H={...H})}catch(e){console.error("Error loading departments",e)}r(K,!1)}function X(e){r(F,i(F).filter((t=>t!==e))),Y()}function Y(){M&&(M.value=JSON.stringify(i(F))),U&&(U.value=JSON.stringify(i(F)))}function Z(e){return H[e]||`Department #${e}`}s((()=>{z()&&(U=document.querySelector('input[name="'+z()+'"], textarea[name="'+z()+'"]'));try{const e="string"==typeof L()?JSON.parse(L()):L();Array.isArray(e)&&r(F,e.map((e=>"object"==typeof e&&void 0!==e.id?(H[e.id]=e.name||`Department #${e.id}`,e.id):e)))}catch(e){console.error("Error parsing selected_ids",e)}if(q()&&(M=document.querySelector(q()),M&&M.value))try{const e=JSON.parse(M.value);Array.isArray(e)&&r(F,e.map((e=>"object"==typeof e&&void 0!==e.id?(H[e.id]=e.name||`Department #${e.id}`,e.id):e)))}catch(e){console.error("Error parsing hidden input value",e)}Q()}));var ee={get input_name(){return O()},set input_name(e){O(e),x()},get input_selector(){return q()},set input_selector(e){q(e),x()},get selected_ids(){return L()},set selected_ids(e){L(e),x()},get ajax_url(){return P()},set ajax_url(e){P(e),x()},get placeholder(){return V()},set placeholder(e){V(e),x()},get base_url(){return T()},set base_url(e){T(e),x()},get json_input(){return z()},set json_input(e){z(e),x()}};l();var te=I(),ae=c(te),se=c(ae),re=c(se),ne=c(re),ie=c(ne),le=c(ie,!0);A(ie);var oe=d(ie,2),de=c(oe),ce=c(de);S(ce);var pe=d(ce,2);p(pe,5,(()=>i(F)),u,((e,t)=>{var a=E(),s=c(a),r=c(s);S(r);var n,l=d(r,3,!0);A(s),A(a),v((e=>{b(s,"data-value",i(t)),h(r,i(t)),b(r,"name",O()),f(l,e)}),[()=>(i(t),g((()=>Z(i(t)))))]),y("click",s,(n=()=>X(i(t)),function(...e){return e[0].preventDefault(),n?.apply(this,e)})),w(e,a)})),A(pe),A(de);var ue=d(de,2),me=c(ue),ve=c(me),ge=e=>{var t=N();w(e,t)},_e=e=>{var t=D(),a=J(t),s=e=>{var t=R();w(e,t)},n=e=>{var t=D(),a=J(t);p(a,1,(()=>i(B)),u,((e,t)=>{var a=$(),s=c(a),n=c(s);S(n);var l=d(n);A(s),A(a),v((e=>{b(n,"title",(i(t),g((()=>i(t).id)))),b(n,"name",`selector-${O()??""}`),W(n,e),h(n,(i(t),g((()=>i(t).id)))),f(l,` ${i(t),g((()=>i(t).name))??""}`)}),[()=>(i(t),g((()=>{return e=i(t).id,i(F).includes(e);var e})))]),y("change",n,(()=>function(e){i(F).includes(e.id)||(H[e.id]=e.name,r(F,[...i(F),e.id]),Y())}(i(t)))),w(e,a)})),w(e,t)};m(a,(e=>{i(B),g((()=>0===i(B).length))?e(s):e(n,!1)}),!0),w(e,t)};m(ve,(e=>{i(K)?e(ge):e(_e,!1)})),A(me),A(ue),A(oe),A(ne),A(re),A(se),A(ae);var fe=d(ae,2);return p(fe,5,(()=>i(F)),u,((e,t)=>{var a=C(),s=c(a);k(),A(a),v((e=>f(s,`${e??""} `)),[()=>(i(t),g((()=>Z(i(t)))))]),y("click",a,(()=>X(i(t)))),w(e,a)})),A(fe),A(te),v((e=>{f(le,V()),b(ce,"data-scope",e),b(ce,"ajax-provider",P()),h(ce,i(G))}),[()=>(_(O()),g((()=>O().replace("[]",""))))]),y("input",ce,(function(e){r(G,e.target.value),Q(i(G))})),w(e,te),j(ee)}customElements.define("lhc-department-picker",e(O,{input_name:{},input_selector:{},selected_ids:{},ajax_url:{},placeholder:{},base_url:{},json_input:{}},[],[],!1));export{O as LHCDepartmentPicker};
//# sourceMappingURL=departments.js.map
