"use strict";(globalThis.webpackChunkLHCReactAPP=globalThis.webpackChunkLHCReactAPP||[]).push([[106],{6106:(t,e,a)=>{a.r(e),a.d(e,{default:()=>_});var i,s=a(4705),n=a(6540),r=a(7218),h=a(8877),o=(a(393),a(9270)),p=a(3115),d=a(911),l=a(1539),c=a(2983),g=a(5967);function f(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function m(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?f(Object(a),!0).forEach((function(e){(0,s.A)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):f(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}class u extends n.PureComponent{render(){const t=(this.props.preChatHtml?this.props.preChatHtml:"")+(this.props.operatorProfile?this.props.operatorProfile:"");return t?n.createElement("div",{className:"py-2 px-3 offline-intro-operator",dangerouslySetInnerHTML:{__html:t}}):null}}let w=(0,r.Ng)((t=>({chatwidget:t.chatwidget})))(i=class extends n.Component{constructor(t){super(t),this.state={},this._lastWidgetHeight=null,this.initOfflineFormCall(),this.handleSubmit=this.handleSubmit.bind(this),this.handleContentChange=this.handleContentChange.bind(this),this.handleContentChangeCustom=this.handleContentChangeCustom.bind(this),this.goToChat=this.goToChat.bind(this)}initOfflineFormCall(t){this.props.dispatch((0,p._y)({department:this.props.chatwidget.get("department"),theme:this.props.chatwidget.get("theme"),mode:this.props.chatwidget.get("mode"),bot_id:this.props.chatwidget.get("bot_id"),trigger_id:this.props.chatwidget.get("trigger_id"),online:0,dep_default:t||this.props.chatwidget.get("departmentDefault")||0,chat_id:this.props.chatwidget.hasIn(["chatData","id"])?this.props.chatwidget.getIn(["chatData","id"]):null,chat_hash:this.props.chatwidget.hasIn(["chatData","hash"])?this.props.chatwidget.getIn(["chatData","hash"]):null}))}handleSubmit(t){var e=this.state,a=!1;const i=new FormData;void 0!==e.File&&(a=!0,i.append("File",e.File,e.File.name)),e.jsvar=this.props.chatwidget.get("jsVars"),e.vars_encrypted=this.props.chatwidget.get("vars_encrypted"),e["captcha_"+this.props.chatwidget.getIn(["captcha","hash"])]=this.props.chatwidget.getIn(["captcha","ts"]),e.tscaptcha=this.props.chatwidget.getIn(["captcha","ts"]),e.user_timezone=d.q.getTimeZone(),e.URLRefer="";try{var s=window.parent.location!==window.parent.parent.location;if(void 0===window.lhcChat||"popup"!=window.lhcChat.mode&&"embed"!=window.lhcChat.mode||null===window.opener&&window.parent.opener,s)e.URLRefer=parent.location.href.substring(parent.location.protocol.length);else{var n=null;n=null!==window.opener?window.opener:window.parent,e.URLRefer=n.location.href.substring(n.location.protocol.length)}}catch(t){try{e.URLRefer=String(window.document.location)}catch(t){}}"blank"==e.URLRefer&&(e.URLRefer=""),e.r=this.props.chatwidget.get("ses_ref"),""!=this.props.chatwidget.get("operator")&&(e.operator=this.props.chatwidget.get("operator")),null!==this.props.chatwidget.get("priority")&&(e.priority=this.props.chatwidget.get("priority"));const r=d.q.getCustomFieldsSubmit(this.props.chatwidget.getIn(["customData","fields"]));null!==r&&(e=m(m({},e),r));let h={department:this.props.chatwidget.get("department"),theme:this.props.chatwidget.get("theme"),mode:this.props.chatwidget.get("mode"),vid:this.props.chatwidget.get("vid"),fields:e};this.props.chatwidget.hasIn(["chatData","id"])&&this.props.chatwidget.hasIn(["chatData","hash"])&&(h.chat_id=this.props.chatwidget.getIn(["chatData","id"]),h.chat_hash=this.props.chatwidget.getIn(["chatData","hash"])),a&&i.append("document",JSON.stringify(h)),this.props.dispatch((0,p.Kb)(a?i:h)),t.preventDefault()}handleContentChange(t){var e=this.state;e[t.id]=t.value,this.setState(e),"DepartamentID"==t.id&&this.props.chatwidget.getIn(["offlineData","department","departments"]).size>0&&this.props.chatwidget.getIn(["offlineData","department","departments"]).map((e=>{e.get("value")==t.value&&(1==e.get("online")&&(this.props.dispatch({type:"dep_default",data:t.value}),this.props.dispatch({type:"onlineStatus",data:!0})),this.props.chatwidget.getIn(["onlineData","dep_forms"])!=t.value&&this.initOfflineFormCall(t.value))}))}componentDidMount(){d.q.prefillFields(this)}handleContentChangeCustom(t){this.props.dispatch({type:"CUSTOM_FIELDS_ITEM",data:{id:t.field.get("index"),value:t.value}})}goToChat(){this.props.dispatch({type:"attr_set",attr:["isOfflineMode"],data:!1})}componentDidUpdate(t,e,a){if(document.getElementById("id-container-fluid")){var i=0;document.getElementById("widget-header-content")&&(i=document.getElementById("widget-header-content").offsetHeight);var s=document.getElementById("id-container-fluid").offsetHeight+i+10;this._lastWidgetHeight!==s&&(this._lastWidgetHeight=s,d.q.sendMessageParent("widgetHeight",[{height:s}]))}}render(){const{t}=this.props;if(!0===this.props.chatwidget.getIn(["offlineData","fetched"])&&!0===this.props.chatwidget.getIn(["offlineData","disabled"]))return n.createElement("div",{className:"alert alert-danger m-2",role:"alert"},t("start_chat.cant_start_a_chat"));if(!1===this.props.chatwidget.getIn(["offlineData","fetched"]))return null;if(this.props.chatwidget.getIn(["chat_ui","disabled"]))return n.createElement(c.A,{closeText:t("button.close"),full_height:!0,close:t=>this.props.dispatch((0,p.fJ)(!0)),as_html:!0,text:this.props.chatwidget.getIn(["chat_ui","disabled"])});if(this.props.chatwidget.getIn(["offlineData","fields"]).size>0)var e=this.props.chatwidget.getIn(["offlineData","fields"]).map((t=>n.createElement(h.A,{chatUI:this.props.chatwidget.get("chat_ui"),validationError:this.props.chatwidget.hasIn(["validationErrors",t.get("identifier")])?this.props.chatwidget.getIn(["validationErrors",t.get("identifier")]):null,isInvalid:this.props.chatwidget.hasIn(["validationErrors",t.get("identifier")]),attrPrefill:{attr_prefill_admin:this.props.chatwidget.get("attr_prefill_admin"),attr_prefill:this.props.chatwidget.get("attr_prefill")},defaultValueField:this.state[t.get("name")]||t.get("value"),onChangeContent:this.handleContentChange,field:t})));else e="";if(this.props.chatwidget.getIn(["customData","fields"]).size>0)var a=this.props.chatwidget.getIn(["customData","fields"]).map((t=>n.createElement(h.A,{chatUI:this.props.chatwidget.get("chat_ui"),key:t.get("identifier"),validationError:this.props.chatwidget.hasIn(["validationErrors",t.get("identifier")])?this.props.chatwidget.getIn(["validationErrors",t.get("identifier")]):null,isInvalid:this.props.chatwidget.hasIn(["validationErrors",t.get("identifier")]),defaultValueField:t.get("value"),onChangeContent:this.handleContentChangeCustom,field:t})));else a="";return 0==this.props.chatwidget.get("processStatusOffline")||1==this.props.chatwidget.get("processStatusOffline")?n.createElement("div",{id:"id-container-fluid"},this.props.chatwidget.get("leave_message")&&n.createElement(u,{preChatHtml:this.props.chatwidget.getIn(["chat_ui","pre_chat_html"]),operatorProfile:this.props.chatwidget.getIn(["chat_ui","operator_profile"])}),this.props.chatwidget.get("leave_message")&&this.props.chatwidget.hasIn(["chat_ui","offline_intro"])&&""!=this.props.chatwidget.getIn(["chat_ui","offline_intro"])&&n.createElement("p",{className:"pb-1 mb-0 pt-2 px-3 fw-bold offline-intro",dangerouslySetInnerHTML:{__html:this.props.chatwidget.getIn(["chat_ui","offline_intro"])}}),!this.props.chatwidget.get("leave_message")&&n.createElement("p",{className:"pb-1 mb-0 pt-2 px-3 fw-bold offline-intro"},this.props.chatwidget.getIn(["chat_ui","chat_unavailable"])),this.props.chatwidget.get("leave_message")&&n.createElement("div",{className:"container-fluid"},n.createElement(g.A,{errors:this.props.chatwidget.get("validationErrors")}),n.createElement("form",{onSubmit:this.handleSubmit,className:"offline-form"},n.createElement("div",{className:"row pt-2"},e,a,this.props.chatwidget.hasIn(["offlineData","department"])&&n.createElement(l.A,{defaultValueField:this.state.DepartamentID,setDefaultValue:this.props.chatwidget.get("departmentDefault"),onChangeContent:this.handleContentChange,isInvalid:this.props.chatwidget.hasIn(["validationErrors","department"]),departments:this.props.chatwidget.getIn(["offlineData","department"])})),(!this.props.chatwidget.hasIn(["chat_ui","hstr_btn"])||""!==a||""!==e)&&n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12 pb-2"},n.createElement("button",{type:"submit",disabled:1==this.props.chatwidget.get("processStatusOffline"),className:"btn btn-secondary btn-sm"},1==this.props.chatwidget.get("processStatusOffline")&&n.createElement("i",{className:"material-icons"},"ï„“"),this.props.chatwidget.getIn(["chat_ui","custom_start_button"])||t("start_chat.leave_a_message")),!0!==this.props.chatwidget.get("isChatting")&&!0===this.props.chatwidget.get("isOnline")&&!0===this.props.chatwidget.get("isOfflineMode")&&n.createElement("button",{type:"button",onClick:this.goToChat,className:"float-end btn btn-sm btn-link text-muted"},this.props.chatwidget.getIn(["chat_ui","back_to_chat"])||t("button.back_to_chat")),!0===this.props.chatwidget.get("isChatting")&&n.createElement("button",{type:"button",onClick:()=>this.props.endChat({show_start:!0}),className:"float-end btn btn-sm btn-link text-muted"},this.props.chatwidget.getIn(["chat_ui","back_to_chat"])||t("button.back_to_chat"))))))):2==this.props.chatwidget.get("processStatusOffline")?n.createElement("div",{id:"id-container-fluid"},n.createElement(u,{operatorProfile:this.props.chatwidget.getIn(["chat_ui","operator_profile"])}),this.props.chatwidget.hasIn(["chat_ui","offline_intro"])&&""!=this.props.chatwidget.getIn(["chat_ui","offline_intro"])&&n.createElement("p",{className:"pb-1 mb-0 pt-2 px-3 fw-bold offline-intro offline-intro-filled",dangerouslySetInnerHTML:{__html:this.props.chatwidget.getIn(["chat_ui","offline_intro"])}}),n.createElement("div",{className:"container-fluid"},n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12"},n.createElement("p",{className:"pt-2",dangerouslySetInnerHTML:{__html:this.props.chatwidget.getIn(["chat_ui","thank_feedback"])||t("start_chat.thank_you_for_feedback")}}))))):void 0}})||i;const _=(0,o.CI)()(w)}}]);
//# sourceMappingURL=106.fa536ebdfa7c39dabb12.js.map