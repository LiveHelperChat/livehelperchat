{"version":3,"file":"168.fc3c39d7802e4164261b.js","mappings":"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","sources":["webpack://LHCReactAPP/./src/extensions/nodejs/nodeJSChat.js"],"sourcesContent":["import { helperFunctions } from \"../../lib/helperFunctions\";\nimport { fetchMessages, checkChatStatus, updateMessage } from \"../../actions/chatActions\"\n\nimport socketCluster from \"socketcluster-client\";\nimport i18n from \"../../i18n\";\n\n\nclass _nodeJSChat {\n    constructor() {\n        this.socket = null;\n\n        // On chat close event close connection\n        helperFunctions.eventEmitter.addListener('endedChat', () => {\n            if (this.socket !== null) {\n                this.socket.disconnect();\n            }\n        });\n    }\n\n    bootstrap(params, dispatch, getState) {\n\n        const state = getState();\n        const chatId = state.chatwidget.getIn(['chatData','id']);\n        const chatHash = state.chatwidget.getIn(['chatData','hash']);\n        const syncDefault = state.chatwidget.getIn(['chat_ui','sync_interval']);\n        var streamFlowStarted = null;\n\n        var socketOptions = {\n            protocolVersion: 1,\n            hostname: params.hostname,\n            path: params.path,\n            disconnectOnUnload: false,\n            autoReconnectOptions: {initialDelay: 5000, randomness: 5000}\n        }\n\n        if (params.port != '') {\n            socketOptions.port = parseInt(params.port);\n        }\n\n        if (params.secure == 1) {\n            socketOptions.secure = true;\n        }\n\n        var chanelName;\n\n        if (params.instance_id > 0) {\n            chanelName = ('chat_'+params.instance_id+'_'+chatId);\n        } else{\n            chanelName = ('chat_'+chatId);\n        }\n\n        var socket = this.socket = socketCluster.create(socketOptions);\n\n        var sampleChannel = null;\n\n        (async () => {\n            try {\n                for await (let status of socket.listener('connect')) {\n                    doActionByConnectionStatus(status);\n                }\n            } catch (e) {\n                let status = await socket.listener('connect').once();\n                doActionByConnectionStatus(status);\n            }\n        })();\n\n        function doActionByConnectionStatus(status) {\n            if (status.isAuthenticated && chatId > 0) {\n                connectVisitor();\n            } else {\n                authentificate();\n            }\n        }\n\n        function authentificate() {\n            const state = getState();\n            let chat_id = state.chatwidget.getIn(['chatData','id']);\n            window.lhcAxios.post(window.lhcChat['base_url'] + \"nodejshelper/tokenvisitor/\"+chat_id+\"/\"+state.chatwidget.getIn(['chatData','hash']), null, {headers : {'Content-Type': 'application/x-www-form-urlencoded'}}).then(async (response) => {\n                await Promise.all([\n                    socket.invoke('login', {hash: response.data, chanelName: (params.instance_id > 0 ? ('chat_'+params.instance_id+'_'+chat_id) : ('chat_'+chat_id)) }),\n                    socket.listener('authenticate').once()\n                ]);\n                connectVisitor();\n            });\n        }\n\n       function visitorTypingListener(data)\n       {\n            if (data.status == true){\n                if (params.instance_id > 0) {\n                    socket.transmitPublish('chat_'+params.instance_id+'_'+chatId,{'op':'vt','msg':data.msg});\n                } else {\n                    socket.transmitPublish('chat_'+chatId,{'op':'vt','msg':data.msg});\n                }\n            } else {\n                if (params.instance_id > 0) {\n                    socket.transmitPublish('chat_'+params.instance_id+'_'+chatId,{'op':'vts'});\n                } else {\n                    socket.transmitPublish('chat_'+chatId,{'op':'vts'});\n                }\n            }\n       }\n\n       function messageSend(data)\n       {\n            const state = getState();\n            \n            let msg = data.msg;\n            \n            if (state.chatwidget.hasIn(['chat_ui','hide_typing']) && state.chatwidget.getIn(['chat_ui','hide_typing']) === true) {\n                msg = i18n.t('chat.msg_was_sent');\n            }\n\n            if (params.instance_id > 0) {\n                socket.transmitPublish('chat_'+params.instance_id+'_'+chatId, {'op':'vt','msg':'âœ‰ï¸ ' + msg});\n            } else {\n                socket.transmitPublish('chat_'+chatId,{'op':'vt', 'msg':'âœ‰ï¸ ' + msg});\n            }\n        }\n\n       function messageSendError(data)\n       {\n            if (params.instance_id > 0) {\n                socket.transmitPublish('chat_'+params.instance_id+'_'+chatId,{'op':'vt','msg':'ðŸ“•ï¸ error happened while sending visitor message, please inform your administrator!'});\n            } else {\n                socket.transmitPublish('chat_'+chatId, {'op':'vt','msg':'ðŸ“•ï¸ error happened while sending visitor message, please inform your administrator!'});\n            }\n        }\n\n        function disconnect() {\n\n            if (sampleChannel !== null) {\n                try {\n                    sampleChannel.unsubscribe();\n                } catch (e) {\n\n                }\n            }\n\n            helperFunctions.eventEmitter.removeListener('visitorTyping', visitorTypingListener);\n            helperFunctions.eventEmitter.removeListener('messageSend', messageSend);\n            helperFunctions.eventEmitter.removeListener('messageSendError', messageSendError);\n\n            dispatch({\n                'type': 'CHAT_UI_UPDATE',\n                'data': {sync_interval: syncDefault}\n            });\n\n            dispatch({\n                'type': 'CHAT_REMOVE_OVERRIDE',\n                'data': \"typing\"\n            });\n        }\n\n        (async () => {\n            try {\n                for await (let event of socket.listener('disconnect')) {\n                    disconnect();\n                }\n            } catch (e) {\n                let status = await socket.listener('disconnect').once();\n                disconnect();\n            }\n        })();\n\n        function connectVisitor() {\n            var firstRun = sampleChannel == null;\n\n            if (params.instance_id > 0) {\n                sampleChannel = socket.subscribe('chat_'+params.instance_id+'_'+chatId);\n            } else {\n                sampleChannel = socket.subscribe('chat_' + chatId);\n            }\n\n            helperFunctions.eventEmitter.addListener('visitorTyping', visitorTypingListener);\n            helperFunctions.eventEmitter.addListener('messageSend', messageSend);\n            helperFunctions.eventEmitter.addListener('messageSendError', messageSendError);\n\n            dispatch({\n                'type': 'CHAT_ADD_OVERRIDE',\n                'data': \"typing\"\n            });\n\n            if (firstRun == true)\n            {\n                (async () => {\n                    try {\n                        for await (let event of sampleChannel.listener('subscribe')) {\n                            socket.transmitPublish((params.instance_id > 0 ? 'chat_' + params.instance_id + '_' + chatId : 'chat_' + chatId), {\n                                'op': 'vi_online',\n                                status: true\n                            });\n                            dispatch({\n                                'type': 'CHAT_UI_UPDATE',\n                                'data': {sync_interval: 10000}\n                            });\n                        }\n                    } catch (e) {\n                        let event = await sampleChannel.listener('subscribe').once();\n                        socket.transmitPublish((params.instance_id > 0 ? 'chat_' + params.instance_id + '_' + chatId : 'chat_' + chatId), {\n                            'op': 'vi_online',\n                            status: true\n                        });\n                    }\n\n                })();\n                (async () => {\n                    try {\n                        for await (let op of sampleChannel) {\n                            if (op.op == 'ot') { // Operator Typing Message\n                                if (op.data.status == true) {\n                                    dispatch({\n                                        'type': 'chat_status_changed',\n                                        'data': {text: op.data.typer ? op.data.typer + \" \" + i18n.t('chat.typing'): op.data.ttx}\n                                    });\n                                } else {\n                                    dispatch({\n                                        'type': 'chat_status_changed',\n                                        'data': {text: ''}\n                                    });\n                                }\n                            } else if (op.op == 'sflow') {\n\n                                // We don't have any\n                                if (streamFlowStarted === null) {\n                                    streamFlowStarted = document.querySelector('#messages-scroll > div.message-row-typing > .msg-body');\n                                    if (streamFlowStarted) {\n                                        streamFlowStarted.innerHTML = \"\";\n                                        streamFlowStarted.parentElement.classList.add('message-row-typing-stream');\n                                    }\n                                }\n\n                                if (streamFlowStarted) {\n                                    if (op.as_html === true){\n                                        streamFlowStarted.innerHTML += op.msg.replaceAll('__SL__',\"/\");\n                                    } else {\n                                        streamFlowStarted.innerText += op.msg.replaceAll('__SL__',\"/\");\n                                    }\n                                    streamFlowStarted.scrollIntoView();\n                                }\n\n                            } else if (op.op == 'cmsg' || op.op == 'schange') {\n                                streamFlowStarted = null;\n                                const state = getState();\n                                if (state.chatwidget.hasIn(['chatData','id'])){\n                                    dispatch(fetchMessages({\n                                        'chat_id': state.chatwidget.getIn(['chatData','id']),\n                                        'hash' : state.chatwidget.getIn(['chatData','hash']),\n                                        'lmgsid' : state.chatwidget.getIn(['chatLiveData','lmsgid']),\n                                        'theme' : state.chatwidget.get('theme'),\n                                        'debug' : state.chatwidget.get('debug'),\n                                        'active_widget':  (((state.chatwidget.get('shown') && state.chatwidget.get('mode') == 'widget') || (state.chatwidget.get('mode') != 'widget' && document.hasFocus())) && window.lhcChat['is_focused'] == true)\n                                    }));\n                                }\n                            } else if (op.op == 'umsg') {\n                                const state = getState();\n                                if (state.chatwidget.hasIn(['chatData','id'])) {\n                                    updateMessage({\n                                        'msg_id' :  op.msid,\n                                        'lmgsid' : state.chatwidget.getIn(['chatLiveData','lmsgid']),\n                                        'mode' : state.chatwidget.get('mode'),\n                                        'theme' : state.chatwidget.get('theme'),\n                                        'id' : state.chatwidget.getIn(['chatData','id']),\n                                        'hash' : state.chatwidget.getIn(['chatData','hash']),\n                                        'no_scroll' : true\n                                    })(dispatch, getState);\n                                }\n                            } else if (op.op == 'schange' || op.op == 'cclose') {\n                                const state = getState();\n                                if (state.chatwidget.hasIn(['chatData','id'])){\n                                    dispatch(checkChatStatus({\n                                        'chat_id': state.chatwidget.getIn(['chatData','id']),\n                                        'hash' : state.chatwidget.getIn(['chatData','hash']),\n                                        'mode' : state.chatwidget.get('mode'),\n                                        'theme' : state.chatwidget.get('theme')\n                                    }));\n                                }\n                            } else if (op.op == 'vo') {\n                                const state = getState();\n                                if (state.chatwidget.hasIn(['chatData','id'])) {\n                                    socket.transmitPublish((params.instance_id > 0 ? 'chat_'+params.instance_id+'_'+state.chatwidget.getIn(['chatData','id']) : 'chat_'+state.chatwidget.getIn(['chatData','id'])) ,{'op':'vi_online', status: true});\n                                }\n                            }\n                        }\n                    } catch (e) {\n                        // Shut up old browsers\n                    }\n                })();\n            }\n       }\n\n       (async () => {\n            try {\n                for await (let event of socket.listener('deauthenticate')) {\n                    authentificate();\n                }\n            } catch (e) {\n                let event = await socket.listener('deauthenticate').once();\n                authentificate();\n            }\n       })();\n    }\n}\n\nconst nodeJSChat = new _nodeJSChat();\nexport { nodeJSChat };"],"names":["nodeJSChat","constructor","this","socket","helperFunctions","eventEmitter","addListener","disconnect","bootstrap","params","dispatch","getState","state","chatId","chatwidget","getIn","syncDefault","streamFlowStarted","socketOptions","protocolVersion","hostname","path","disconnectOnUnload","autoReconnectOptions","initialDelay","randomness","port","parseInt","secure","instance_id","socketCluster","sampleChannel","doActionByConnectionStatus","status","isAuthenticated","connectVisitor","authentificate","chat_id","window","lhcAxios","post","lhcChat","headers","then","async","Promise","all","invoke","hash","response","data","chanelName","listener","once","visitorTypingListener","transmitPublish","msg","messageSend","hasIn","i18n","t","messageSendError","unsubscribe","e","removeListener","sync_interval","firstRun","subscribe","_iteratorError3","_iteratorAbruptCompletion3","_didIteratorError3","_step3","_iterator3","_asyncIterator","next","done","value","err","return","_iteratorError4","_iteratorAbruptCompletion4","_didIteratorError4","_step4","_iterator4","op","text","typer","ttx","document","querySelector","innerHTML","parentElement","classList","add","as_html","replaceAll","innerText","scrollIntoView","fetchMessages","get","hasFocus","updateMessage","msid","checkChatStatus","_iteratorError","_iteratorAbruptCompletion","_didIteratorError","_step","_iterator","_iteratorError2","_iteratorAbruptCompletion2","_didIteratorError2","_step2","_iterator2","_iteratorError5","_iteratorAbruptCompletion5","_didIteratorError5","_step5","_iterator5"],"ignoreList":[],"sourceRoot":""}