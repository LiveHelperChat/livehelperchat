{"version":3,"file":"835.e36e5e64b76287035bfe.js","mappings":"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","sources":["webpack://LHCReactAPP/./src/components/OfflineChat.js"],"sourcesContent":["import React, { Component } from 'react';\nimport { connect } from \"react-redux\";\nimport ChatField from './ChatField';\nimport StartChat from './StartChat';\nimport { withTranslation } from 'react-i18next';\nimport { initOfflineForm, submitOfflineForm, minimizeWidget } from \"../actions/chatActions\"\nimport { helperFunctions } from \"../lib/helperFunctions\";\nimport ChatDepartment from './ChatDepartment';\nimport ChatAbort from './ChatAbort';\nimport ChatErrorList from './ChatErrorList';\n\n@connect((store) => {\n    return {\n        chatwidget: store.chatwidget\n    };\n})\n\nclass OfflineChat extends Component {\n\n    constructor(props) {\n        super(props);\n\n        this.state = {};\n        \n        this.initOfflineFormCall();\n\n        this.handleSubmit = this.handleSubmit.bind(this);\n        this.handleContentChange = this.handleContentChange.bind(this);\n        this.handleContentChangeCustom = this.handleContentChangeCustom.bind(this);\n        this.goToChat = this.goToChat.bind(this);\n    }\n\n    initOfflineFormCall(dep_default){\n        // Init offline form with all attributes\n        this.props.dispatch(initOfflineForm({\n            'department':this.props.chatwidget.get('department'),\n            'theme' : this.props.chatwidget.get('theme'),\n            'mode' : this.props.chatwidget.get('mode'),\n            'bot_id' : this.props.chatwidget.get('bot_id'),\n            'trigger_id' : this.props.chatwidget.get('trigger_id'),\n            'online' : 0,\n            'dep_default' : (dep_default || this.props.chatwidget.get('departmentDefault') || 0),\n            'chat_id' : this.props.chatwidget.hasIn(['chatData','id']) ? this.props.chatwidget.getIn(['chatData','id']) : null,\n            'chat_hash' : this.props.chatwidget.hasIn(['chatData','hash']) ? this.props.chatwidget.getIn(['chatData','hash']) : null\n        }));\n    }\n\n    handleSubmit(event) {\n\n        var fields = this.state;\n        var hasFile = false;\n        const formData = new FormData();\n\n        if (typeof fields['File'] !== 'undefined') {\n            hasFile = true;\n            formData.append(\"File\", fields['File'], fields['File'].name);\n        }\n\n        fields['jsvar'] = this.props.chatwidget.get('jsVars');\n        fields['vars_encrypted'] = this.props.chatwidget.get('vars_encrypted');\n        fields['captcha_' + this.props.chatwidget.getIn(['captcha','hash'])] = this.props.chatwidget.getIn(['captcha','ts']);\n        fields['tscaptcha'] = this.props.chatwidget.getIn(['captcha','ts']);\n        fields['user_timezone'] = helperFunctions.getTimeZone();\n        fields['URLRefer'] = '';\n        try {\n            var iframeMode = window.parent.location !== window.parent.parent.location;\n            var popupMode = typeof window.lhcChat != 'undefined' && (window.lhcChat['mode'] == 'popup' || window.lhcChat['mode'] == 'embed') && (window.opener !== null || window.parent.opener !== null);\n\n            if (iframeMode) {\n                fields['URLRefer'] = parent.location.href.substring(parent.location.protocol.length);\n            } else {\n                var instWindow = null;\n                if (window.opener !== null) {\n                    instWindow = window.opener;\n                } else {\n                    instWindow = window.parent;\n                }\n                fields['URLRefer'] = instWindow.location.href.substring(instWindow.location.protocol.length);\n            }\n\n        } catch (e) {\n            try {\n                fields['URLRefer'] = String(window.document.location);\n            } catch (e) {\n                // Do nothing\n            }\n        }\n\n        if (fields['URLRefer'] == 'blank') {\n            fields['URLRefer'] = ''\n        }\n\n        fields['r'] = this.props.chatwidget.get('ses_ref');\n\n        if (this.props.chatwidget.get('operator') != '') {\n            fields['operator'] = this.props.chatwidget.get('operator');\n        }\n        \n        if (this.props.chatwidget.get('priority') !== null) {\n            fields['priority'] = this.props.chatwidget.get('priority');\n        }\n\n        const customFields = helperFunctions.getCustomFieldsSubmit(this.props.chatwidget.getIn(['customData','fields']));\n        if (customFields !== null) {\n            fields = {...fields, ...customFields};\n        }\n\n        let submitData = {\n            'department': this.props.chatwidget.get('department'),\n            'theme' : this.props.chatwidget.get('theme'),\n            'mode' : this.props.chatwidget.get('mode'),\n            'vid' : this.props.chatwidget.get('vid'),\n            'fields' : fields\n        };\n\n        if (this.props.chatwidget.hasIn(['chatData','id']) && this.props.chatwidget.hasIn(['chatData','hash'])) {\n            submitData['chat_id'] = this.props.chatwidget.getIn(['chatData','id']);\n            submitData['chat_hash'] = this.props.chatwidget.getIn(['chatData','hash']);\n        }\n\n        if (hasFile) {\n            formData.append('document', JSON.stringify(submitData));\n        }\n\n        this.props.dispatch(submitOfflineForm(hasFile ? formData : submitData));\n        event.preventDefault();\n    }\n\n    handleContentChange(obj) {\n        var currentState = this.state;\n        currentState[obj.id] = obj.value;\n        this.setState(currentState);\n\n        if (obj.id == 'DepartamentID') {\n            if (this.props.chatwidget.getIn(['offlineData','department','departments']).size > 0){\n                this.props.chatwidget.getIn(['offlineData','department','departments']).map(dep => {\n                    if (dep.get('value') == obj.value) {\n                        if (dep.get('online') == true) {\n                            this.props.dispatch({'type' : 'dep_default', data : obj.value});\n                            this.props.dispatch({'type' : 'onlineStatus', data : true});\n                        }\n\n                        // Update online fields settings if different department\n                        if (this.props.chatwidget.getIn(['onlineData','dep_forms']) != obj.value) {\n                            this.initOfflineFormCall(obj.value);\n                        }\n\n                    }\n                })\n            }\n        }\n    }\n\n    componentDidMount() {\n        helperFunctions.prefillFields(this);\n    }\n\n    handleContentChangeCustom(obj) {\n        this.props.dispatch({'type' : 'CUSTOM_FIELDS_ITEM', data : {id : obj.field.get('index'), value : obj.value}});\n    }\n\n    goToChat() {\n        this.props.dispatch({type : 'attr_set', attr : ['isOfflineMode'], data: false});\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        if (document.getElementById('id-container-fluid')) {\n\n            var headerContent = 0;\n\n            if (document.getElementById('widget-header-content')){\n                headerContent = document.getElementById('widget-header-content').offsetHeight;\n            }\n\n            helperFunctions.sendMessageParent('widgetHeight', [{\n                'height' : document.getElementById('id-container-fluid').offsetHeight + headerContent + 10\n            }]);\n        }\n    }\n    \n    render() {\n\n        const { t } = this.props;\n\n        if (this.props.chatwidget.getIn(['offlineData','fetched']) === true && this.props.chatwidget.getIn(['offlineData','disabled']) === true) {\n            return (\n                <div className=\"alert alert-danger m-2\" role=\"alert\">\n                    {t('start_chat.cant_start_a_chat')}\n                </div>\n            )\n        }\n\n        if (this.props.chatwidget.getIn(['offlineData','fetched']) === false)\n        {\n            return null;\n        }\n\n        if (this.props.chatwidget.getIn(['chat_ui','disabled'])) {\n            return <ChatAbort closeText={t('button.close')} full_height={true} close={(e) => this.props.dispatch(minimizeWidget(true))} as_html={true} text={this.props.chatwidget.getIn(['chat_ui','disabled'])} />;\n        }\n\n        if (this.props.chatwidget.getIn(['offlineData','fields']).size > 0) {\n            var mappedFields = this.props.chatwidget.getIn(['offlineData','fields']).map(field =><ChatField chatUI={this.props.chatwidget.get('chat_ui')} validationError={this.props.chatwidget.hasIn(['validationErrors',field.get('identifier')]) ? this.props.chatwidget.getIn(['validationErrors',field.get('identifier')]) : null} isInvalid={this.props.chatwidget.hasIn(['validationErrors',field.get('identifier')])} attrPrefill={{'attr_prefill_admin' : this.props.chatwidget.get('attr_prefill_admin'), 'attr_prefill' : this.props.chatwidget.get('attr_prefill')}} defaultValueField={this.state[field.get('name')] || field.get('value')} onChangeContent={this.handleContentChange} field={field} />);\n        } else {\n            var mappedFields = \"\";\n        }\n\n        if (this.props.chatwidget.getIn(['customData','fields']).size > 0) {\n            var mappedFieldsCustom = this.props.chatwidget.getIn(['customData','fields']).map(field =><ChatField chatUI={this.props.chatwidget.get('chat_ui')} key={field.get('identifier')} validationError={this.props.chatwidget.hasIn(['validationErrors',field.get('identifier')]) ? this.props.chatwidget.getIn(['validationErrors',field.get('identifier')]) : null} isInvalid={this.props.chatwidget.hasIn(['validationErrors',field.get('identifier')])} defaultValueField={field.get('value')} onChangeContent={this.handleContentChangeCustom} field={field} />);\n        } else {\n            var mappedFieldsCustom = \"\";\n        }\n\n        if (this.props.chatwidget.get('processStatusOffline') == 0 || this.props.chatwidget.get('processStatusOffline') == 1) {\n            return (\n                  <div id=\"id-container-fluid\">\n                    {this.props.chatwidget.get('leave_message') && (this.props.chatwidget.hasIn(['chat_ui','pre_chat_html']) || (this.props.chatwidget.hasIn(['chat_ui','operator_profile']) && this.props.chatwidget.getIn(['chat_ui','operator_profile']) != '')) && <div className=\"py-2 px-3 offline-intro-operator\" dangerouslySetInnerHTML={{__html:(this.props.chatwidget.hasIn(['chat_ui','pre_chat_html']) ? this.props.chatwidget.getIn(['chat_ui','pre_chat_html']) : '') + (this.props.chatwidget.hasIn(['chat_ui','operator_profile']) ? this.props.chatwidget.getIn(['chat_ui','operator_profile']) : '')}}></div>}\n\n                    {this.props.chatwidget.get('leave_message') && this.props.chatwidget.hasIn(['chat_ui','offline_intro']) && this.props.chatwidget.getIn(['chat_ui','offline_intro']) != '' && <p className=\"pb-1 mb-0 pt-2 px-3 fw-bold offline-intro\" dangerouslySetInnerHTML={{__html:this.props.chatwidget.getIn(['chat_ui','offline_intro'])}}></p>}\n\n                    {!this.props.chatwidget.get('leave_message') && <p className=\"pb-1 mb-0 pt-2 px-3 fw-bold offline-intro\">{this.props.chatwidget.getIn(['chat_ui','chat_unavailable'])}</p>}\n\n                    {this.props.chatwidget.get('leave_message') &&\n                    <div className=\"container-fluid\" >\n\n                        <ChatErrorList errors={this.props.chatwidget.get('validationErrors')} />\n\n                        <form onSubmit={this.handleSubmit} className=\"offline-form\">\n                            <div className=\"row pt-2\">\n                                {mappedFields}\n                                {mappedFieldsCustom}\n                                {this.props.chatwidget.hasIn(['offlineData','department']) && <ChatDepartment defaultValueField={this.state['DepartamentID']} setDefaultValue={this.props.chatwidget.get('departmentDefault')} onChangeContent={this.handleContentChange} isInvalid={this.props.chatwidget.hasIn(['validationErrors','department'])} departments={this.props.chatwidget.getIn(['offlineData','department'])} />}\n                            </div>\n                            {(!this.props.chatwidget.hasIn(['chat_ui','hstr_btn']) || mappedFieldsCustom !== \"\" || mappedFields !== \"\") && <div className=\"row\">\n                                <div className=\"col-12 pb-2\">\n                                    <button type=\"submit\" disabled={this.props.chatwidget.get('processStatusOffline') == 1} className=\"btn btn-secondary btn-sm\">{this.props.chatwidget.get('processStatusOffline') == 1 && <i className=\"material-icons\">&#xf113;</i>}{this.props.chatwidget.getIn(['chat_ui','custom_start_button']) || t('start_chat.leave_a_message')}</button>\n                                    {this.props.chatwidget.get('isChatting') !== true && this.props.chatwidget.get('isOnline') === true && this.props.chatwidget.get('isOfflineMode') === true && <button type=\"button\" onClick={this.goToChat} className=\"float-end btn btn-sm btn-link text-muted\">&laquo; {t('button.back_to_chat')}</button>}\n                                    {this.props.chatwidget.get('isChatting') === true && <button type=\"button\" onClick={() => this.props.endChat({\"show_start\": true})} className=\"float-end btn btn-sm btn-link text-muted\">&laquo; {t('button.back_to_chat')}</button>}\n                                </div>\n                            </div>}\n                        </form>\n                    </div>}\n\n\n                  </div>\n            )\n        } else if (this.props.chatwidget.get('processStatusOffline') == 2) {\n            return (\n                <div id=\"id-container-fluid\">\n\n                {this.props.chatwidget.hasIn(['chat_ui','operator_profile']) && this.props.chatwidget.getIn(['chat_ui','operator_profile']) != '' && <div className=\"py-2 px-3 offline-intro-operator\" dangerouslySetInnerHTML={{__html:this.props.chatwidget.getIn(['chat_ui','operator_profile'])}}></div>}\n\n                {this.props.chatwidget.hasIn(['chat_ui','offline_intro']) && this.props.chatwidget.getIn(['chat_ui','offline_intro']) != '' && <p className=\"pb-1 mb-0 pt-2 px-3 fw-bold offline-intro offline-intro-filled\" dangerouslySetInnerHTML={{__html:this.props.chatwidget.getIn(['chat_ui','offline_intro'])}}></p>}\n\n                    <div className=\"container-fluid\">\n                        <div className=\"row\">\n                            <div className=\"col-12\">\n                                <p className=\"pt-2\" dangerouslySetInnerHTML={{__html:this.props.chatwidget.getIn(['chat_ui','thank_feedback']) || t('start_chat.thank_you_for_feedback')}}></p>\n                            </div>\n                        </div>\n                    </div>\n\n                </div>\n            )\n        }\n    }\n}\n\nexport default withTranslation()(OfflineChat);\n"],"names":["OfflineChat","connect","store","chatwidget","_dec","_class","_Component","props","_this","_classCallCheck","state","initOfflineFormCall","handleSubmit","bind","handleContentChange","handleContentChangeCustom","goToChat","_inherits","_createClass","key","value","dep_default","this","dispatch","initOfflineForm","get","hasIn","getIn","event","fields","hasFile","formData","FormData","append","name","helperFunctions","getTimeZone","iframeMode","window","parent","location","lhcChat","opener","href","substring","protocol","length","instWindow","e","String","document","customFields","getCustomFieldsSubmit","_objectSpread","submitData","JSON","stringify","submitOfflineForm","preventDefault","obj","_this2","currentState","id","setState","size","map","dep","data","prefillFields","field","type","attr","prevProps","prevState","snapshot","getElementById","headerContent","offsetHeight","sendMessageParent","_this3","t","React","className","role","ChatAbort","closeText","full_height","close","minimizeWidget","as_html","text","mappedFields","ChatField","chatUI","validationError","isInvalid","attrPrefill","defaultValueField","onChangeContent","mappedFieldsCustom","dangerouslySetInnerHTML","__html","ChatErrorList","errors","onSubmit","ChatDepartment","setDefaultValue","departments","disabled","onClick","endChat","Component","withTranslation"],"sourceRoot":""}