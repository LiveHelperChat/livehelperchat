{"version":3,"file":"01aceef32eb0234e512e.js","mappings":"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","sources":["webpack://LiveHelperChat/./src/lib/widgets/needhelpWidget.js"],"sourcesContent":["import {settings} from '../settings.js';\nimport {UIConstructorIframe} from '../UIConstructorIframe';\nimport {helperFunctions} from '../helperFunctions';\n\nexport class needhelpWidget{\n    constructor(prefix) {\n\n        this.attributes = {};\n        this.hidden = false;\n        this.widgetOpen = false;\n        this.invitationOpen = false;\n        this.nhOpen = false;\n        this.delayProcessed = false;\n\n        this.cont = new UIConstructorIframe((prefix || 'lhc')+'_needhelp_widget_v2', helperFunctions.getAbstractStyle({\n            zindex: \"2147483639\",\n            width: \"320px\",\n            height: \"135px\",\n            position: \"fixed\",\n            display: \"none\",\n            transition: \"transform\"\n        }),  {\"role\":\"presentation\",\"translate\":\"no\"}, \"iframe\");\n\n        this.loadStatus = {main : false, theme: false, status: false};\n    }\n    \n    checkLoadStatus() {\n        if (this.loadStatus['theme'] == true && this.loadStatus['main'] == true && this.loadStatus['status'] == true) {\n            this.cont.elmDomDoc.body.style.display = \"\";\n        }\n    }\n    \n    init(attributes, settings) {\n\n        this.attributes = attributes;\n\n        var placement = {bottom: (70 + this.attributes.widgetDimesions.value.wbottom) +\"px\", right: (65+this.attributes.widgetDimesions.value.wright) + \"px\"};\n\n        var leftPosition = false;\n\n        if (attributes.position_placement == 'bottom_left' || attributes.position_placement == 'full_height_left') {\n            placement = {bottom: (70 + this.attributes.widgetDimesions.value.wbottom) +\"px\", left: (65+this.attributes.widgetDimesions.value.wright) + \"px\"};\n            leftPosition = true;\n        } else if (attributes.position_placement == 'middle_left') {\n            placement = {bottom: \"calc(50% + 35px)\", left: (65+this.attributes.widgetDimesions.value.wright) + \"px\"};\n            leftPosition = true;\n        } else if (attributes.position_placement == 'middle_right') {\n            placement = {bottom: \"calc(50% + 35px)\", right: (65+this.attributes.widgetDimesions.value.wright) + \"px\"};\n        }\n\n        this.cont.massRestyle(placement);\n\n        this.attributes = attributes;\n\n        this.cont.tmpl = settings['html'].replace('{dev_type}',(this.attributes.isMobile === true ? 'lhc-mobile' : 'lhc-desktop'));\n        this.cont.bodyId = 'need-help';\n        \n        if (this.cont.constructUIIframe('', this.attributes.staticJS['dir']) === null){\n            return null;\n        }\n        \n        // Content invisible untill media loads\n        this.cont.elmDomDoc.body.style.display = \"none\";\n        \n        this.cont.elmDom.className += this.attributes.isMobile === true ? ' notranslate lhc-mobile' : ' notranslate lhc-desktop';\n\n        this.cont.attachUserEventListener(\"click\", function (e) {\n            attributes.eventEmitter.emitEvent('nhClicked', [{'event': e, 'sender' : 'closeButton'}]);\n            attributes.eventEmitter.emitEvent('showWidget', [{'event': e}]);\n        }, \"start-chat-btn\",'nhstrt');\n\n        var _that = this;\n\n        this.cont.attachUserEventListener(\"click\", function (a) {\n            attributes.eventEmitter.emitEvent('nhClosed', [{'sender' : 'closeButton'}]);\n            a.stopPropagation();\n            _that.hide(true);\n        }, \"close-need-help-btn\",'nhcls');\n\n        if (settings.dimensions) {\n            if (leftPosition == true && settings.dimensions['right']) {\n                settings.dimensions['left'] = settings.dimensions['right'];\n                delete settings.dimensions['right'];\n            }\n            this.cont.massRestyle(settings.dimensions);\n        }\n\n        this.cont.insertCssRemoteFile({onload: () => {this.loadStatus['main'] = true; this.checkLoadStatus()},crossOrigin : \"anonymous\",  href : this.attributes.staticJS['widget_css']}, true);\n\n        if (this.attributes.isMobile == true) {\n            this.cont.insertCssRemoteFile({crossOrigin : \"anonymous\",  href : this.attributes.staticJS['widget_mobile_css']});\n        }\n\n        if (this.attributes.theme) {\n            this.cont.insertCssRemoteFile({onload: () => {this.loadStatus['theme'] = true; this.checkLoadStatus()}, id : \"lhc-theme-needhelp\", crossOrigin : \"anonymous\",  href : this.attributes.LHC_API.args.lhc_base_url + '/widgetrestapi/themeneedhelp/' + this.attributes.theme + '?v=' + this.attributes.theme_v}, true);\n        } else {\n            this.loadStatus['theme'] = true;\n            this.checkLoadStatus();\n        }\n\n        // Show need help only if status widget is loaded\n        attributes.sload.subscribe((data) => {if(data){this.loadStatus['status'] = true; this.checkLoadStatus()}});\n\n        if (!settings['ap']) {\n\n            if (attributes.animate_nh) {\n                this.cont.massRestyle({\"transition-duration\" : \"800ms\"});\n            }\n\n            attributes.eventEmitter.addListener('showInvitation', () => {\n                this.invitationOpen = true;\n                this.hide();\n            });\n\n            attributes.eventEmitter.addListener('chatStarted', () => {\n                this.hide(true);\n            });\n\n            attributes.eventEmitter.addListener('hideInvitation', () => {\n                this.invitationOpen = false;\n                this.show();\n            });\n\n            attributes.eventEmitter.addListener('cancelInvitation', () => {\n                this.invitationOpen = false;\n                this.show();\n            });\n\n            attributes.msgsnippet_status.subscribe((data) => {\n                data == true && this.hide(true);\n            });\n\n            attributes.shidden.subscribe((data) => {\n                data ? this.hide(false) : this.show();\n            });\n\n            attributes.status_position.subscribe((data) => {\n\n                if (!data) {\n                    return;\n                }\n\n                let placementRestored = {};\n                placementRestored[\"bottom\"] = data[\"bottom\"];\n                placementRestored[\"top\"] = data[\"top\"];\n                placementRestored[\"left\"] = data[\"left\"];\n                placementRestored[\"right\"] = data[\"right\"];\n                placementRestored[\"transform\"] = \"translate3d(\"+ (data[\"left\"] == \"auto\" ? -55 : 55) +\"px,\" + (data[\"bottom\"] == \"auto\" ? data[\"y\"] + 70 : data[\"y\"] - 60) + \"px, 0px)!important\";\n                this.cont.massRestyle(placementRestored);\n            });\n        }\n\n        setTimeout(() => {\n\n            this.delayProcessed = true;\n\n            attributes.widgetStatus.subscribe((data) => {\n                data == true ? (this.widgetOpen = true,this.hide()) : (this.widgetOpen = false,this.show());\n            });\n\n            attributes.onlineStatus.subscribe((data) => {\n                if (data == false) {\n                    let needHide = this.hidden;\n                    this.hide();\n                    // Show next time only if it was not hidden already\n                    if (needHide === false) {\n                        this.hidden = false;\n                    }\n                } else {\n                    this.show();\n                }\n            });\n\n        }, settings.delay + this.attributes['status_delay']);\n\n        attributes.eventEmitter.addListener('reloadWidget',() => {\n            this.cont.insertCssRemoteFile({onload: () => {this.loadStatus['theme'] = true; this.checkLoadStatus()}, id : \"lhc-theme-needhelp\", crossOrigin : \"anonymous\",  href : this.attributes.LHC_API.args.lhc_base_url + '/widgetrestapi/themeneedhelp/' + this.attributes.theme + '?v=' + Date.now()}, true);\n        });\n\n    }\n\n    hide (persistent) {\n\n        if (typeof persistent !== 'undefined' && persistent === true) {\n            this.attributes.userSession.hnh = Math.round(Date.now() / 1000);\n            this.attributes.storageHandler.storeSessionInformation(this.attributes.userSession.getSessionAttributes());\n            this.hidden = true;\n        }\n\n        this.cont.hide();\n\n        if (this.nhOpen == true) {\n            this.attributes.eventEmitter.emitEvent('nhHide', []);\n        }\n\n        this.nhOpen = false;\n    }\n\n    show () {\n\n        if (this.delayProcessed == false || this.hidden == true || this.widgetOpen == true || this.invitationOpen == true || this.attributes.onlineStatus.value == false) {\n            return;\n        }\n\n        if (this.attributes.hideOffline === false) {\n            this.cont.show();\n            if (this.nhOpen == false) {\n                this.attributes.eventEmitter.emitEvent('nhShow', []);\n            }\n            this.nhOpen = true;\n        } else {\n            this.cont.hide();\n            if (this.nhOpen == true) {\n                this.attributes.eventEmitter.emitEvent('nhHide', []);\n            }\n            this.nhOpen = false;\n        }\n    }\n}"],"names":["needhelpWidget","_createClass","prefix","_classCallCheck","this","attributes","hidden","widgetOpen","invitationOpen","nhOpen","delayProcessed","cont","UIConstructorIframe","helperFunctions","getAbstractStyle","zindex","width","height","position","display","transition","loadStatus","main","theme","status","key","value","elmDomDoc","body","style","settings","_this","placement","bottom","widgetDimesions","wbottom","right","wright","leftPosition","position_placement","left","massRestyle","tmpl","replace","isMobile","bodyId","constructUIIframe","staticJS","elmDom","className","attachUserEventListener","e","eventEmitter","emitEvent","_that","a","stopPropagation","hide","dimensions","insertCssRemoteFile","onload","checkLoadStatus","crossOrigin","href","id","LHC_API","args","lhc_base_url","theme_v","sload","subscribe","data","animate_nh","addListener","show","msgsnippet_status","shidden","status_position","placementRestored","setTimeout","widgetStatus","onlineStatus","needHide","delay","Date","now","persistent","userSession","hnh","Math","round","storageHandler","storeSessionInformation","getSessionAttributes","hideOffline"],"sourceRoot":""}