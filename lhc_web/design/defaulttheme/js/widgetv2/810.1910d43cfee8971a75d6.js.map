{"version":3,"file":"810.1910d43cfee8971a75d6.js","mappings":"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","sources":["webpack://LHCReactAPP/./src/components/InlineIframe.js"],"sourcesContent":["import React, { Component } from 'react';\nimport { connect } from \"react-redux\";\nimport { updateMessageData } from \"../actions/chatActions\";\n\n@connect((store) => {\n    return {\n        chatwidget: store.chatwidget\n    };\n})\n\nclass InlineIframe extends Component {\n\n    constructor(props) {\n        super(props);\n    }\n\n    getDocument(a) {\n        return a.contentWindow ? a.contentWindow.document : a.contentDocument ? a.contentDocument : a.document ? a.document : null\n    }\n\n    insertCssRemoteFile(elmDomDoc, attr) {\n\n        var elm = null;\n\n        if (attr.id && attr.href && (elm = elmDomDoc.getElementById(attr.id)) !== null) {\n            elm.href = attr.href\n            return;\n        }\n\n        var d = elmDomDoc.getElementsByTagName(\"head\")[0],\n            k = elmDomDoc.createDocumentFragment(),\n            e = elmDomDoc.createElement('link');\n\n        e.rel = \"stylesheet\";\n        e.crossOrigin = \"*\";\n\n        for (var b in attr) e[b] = attr[b];\n\n        k.appendChild(e);\n        d.appendChild(k);\n    }\n\n    insertJSFile(elmDomDoc, src, async, attr) {\n        var d = elmDomDoc.getElementsByTagName(\"head\")[0],\n            k = elmDomDoc.createDocumentFragment(),\n            e = elmDomDoc.createElement('script');\n\n        e.type = 'text/javascript';\n        if (typeof async === 'undefined' || async === true) {\n            e.async = true;\n        }\n\n        e.crossOrigin = \"*\";\n        e.src = src;\n\n        if (attr) {\n            delete attr['src'];\n            if (typeof attr['async'] !== 'undefined') {\n                delete attr['async'];\n            }\n            Object.keys(attr).forEach(key => {\n                e.setAttribute(key,attr[key]);\n            })\n        }\n\n        k.appendChild(e);\n        d.appendChild(k);\n    }\n\n    prepareIframe(iframe) {\n        let documentFrame = this.getDocument(iframe);\n\n        documentFrame.getElementsByTagName(\"head\")[0].innerHTML = '<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" /><meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\" />';\n\n        var html = documentFrame.getElementsByTagName(\"html\")[0];\n        html.setAttribute(\"lang\", 'en');\n        html.setAttribute(\"dir\", 'ltr');\n\n        var nodeDoctype = document.implementation.createDocumentType(\n            'html',\n            '',\n            ''\n        );\n\n        if (documentFrame.doctype) {\n            documentFrame.replaceChild(nodeDoctype, documentFrame.doctype);\n        } else {\n            documentFrame.insertBefore(nodeDoctype, documentFrame.childNodes[0]);\n        }\n\n        if (this.props['data-css']) {\n            JSON.parse(this.props['data-css']).forEach((item) => {\n                this.insertCssRemoteFile(documentFrame, item);\n            });\n        }\n\n        if (this.props['data-js']) {\n            JSON.parse(this.props['data-js']).forEach((item) => {\n                this.insertJSFile(documentFrame, item['src'], (item['async'] ? item['async'] : false), item);\n            });\n        }\n\n        documentFrame.body.innerHTML = this.props['data-body'];\n\n        return documentFrame;\n    }\n\n    prependURL() {\n\n        var js_args = [];\n\n        var paramsReturn = '?';\n        var jsVars = this.props.chatwidget.get('jsVars');\n\n        Object.keys(jsVars).forEach(key => {\n            js_args.push('jsvar[' + key + ']=' + encodeURIComponent(jsVars[key]));\n        })\n\n        if (js_args.length > 0) {\n            paramsReturn = paramsReturn + '&' + js_args.join('&');\n        }\n\n        if (this.props.chatwidget.hasIn(['chatData','id'])) {\n            paramsReturn = paramsReturn + '&chat_id=' + this.props.chatwidget.getIn(['chatData','id']) + '&hash=' + this.props.chatwidget.getIn(['chatData','hash']) + '&msg_id=' + this.props['data-id'];\n        }\n\n        return paramsReturn;\n    }\n\n    componentDidMount() {\n        const iframe = document.createElement(\"iframe\");\n\n        if (this.props['data-form']) {\n            iframe.src = this.props['data-form'] + this.prependURL();\n        }\n\n        iframe.onload = () => {\n\n            if (!this.props['data-form']) {\n                let documentFrame = this.prepareIframe(iframe);\n\n                var closeActions = documentFrame.body.getElementsByClassName('lhc-iframe-close');\n\n                for (let i = 0; i < closeActions.length; i++) {\n                    closeActions[i].addEventListener('click',() => {\n                        updateMessageData({\n                            'id' : this.props.chatwidget.getIn(['chatData','id']),\n                            'hash' : this.props.chatwidget.getIn(['chatData','hash']),\n                            'msg_id' : this.props['data-id']\n                        }, {'action' : 'iframe_close'}).then(() => {\n                            this.props.updateMessage(this.props['data-id']);\n                        });\n                    });\n                }\n            }\n\n            let elmScroll = document.getElementById('messages-scroll');\n            if (elmScroll !== null) {\n                elmScroll.scrollTop = elmScroll.scrollHeight + 1000;\n            }\n\n            if (!this.props['data-form'] && this.props['data-js-body']) {\n                let js = documentFrame.createElement(\"script\");\n                js.textContent = this.props['data-js-body'];\n                documentFrame.head.appendChild(js);\n            }\n        };\n\n        iframe.onerror = function() {\n            console.log(\"Something wrong happened\");\n        };\n\n        if (this.props['data-style']) {\n            iframe.style = this.props['data-style'];\n        }\n\n        if (this.props['data-iframe']) {\n            let iframeOptions = JSON.parse(this.props['data-iframe']);\n\n            // Remove any previous instances of same iframe if it's shown again\n            if (iframeOptions['one_per_chat'] && iframeOptions['one_per_chat'] == true && iframeOptions['iframe-identifier']) {\n                let sameIframes = document.getElementsByClassName(iframeOptions['iframe-identifier']);\n                for (let i = 0; i < sameIframes.length; i++) {\n                    if (sameIframes[i].parentNode) {\n                        updateMessageData({\n                            'id' : this.props.chatwidget.getIn(['chatData','id']),\n                            'hash' : this.props.chatwidget.getIn(['chatData','hash']),\n                            'msg_id' : sameIframes[i].getAttribute('data-msg-id')\n                        }, {'action' : 'iframe_close'}).then(() => {\n                            this.props.updateMessage(sameIframes[i].getAttribute('data-msg-id'));\n                            //sameIframes[i].parentNode.removeChild(sameIframes[i]); // Not needed anymore becase default flow handles all taht\n                        });\n                    }\n                }\n            }\n\n            if (iframeOptions['iframe-identifier']) {\n                iframe.className = iframeOptions['iframe-identifier']; // Will be used to allow only one instance to be mounted\n            }\n\n            iframe.setAttribute('data-msg-id',this.props['data-id']);\n        }\n\n        document.getElementById(\"iframe-msg-\"+this.props['data-id']).appendChild(iframe);\n    }\n\n\n    render() {\n\n        const { t } = this.props;\n\n        return (\n            <div id={\"iframe-msg-\"+this.props['data-id']}></div>\n        );\n    }\n}\n\nexport default InlineIframe;"],"names":["connect","store","chatwidget","_dec","_class","Component","constructor","props","super","getDocument","a","contentWindow","document","contentDocument","insertCssRemoteFile","elmDomDoc","attr","elm","id","href","getElementById","d","getElementsByTagName","k","createDocumentFragment","e","createElement","b","rel","crossOrigin","appendChild","insertJSFile","src","async","type","Object","keys","forEach","key","setAttribute","prepareIframe","iframe","documentFrame","this","innerHTML","html","nodeDoctype","implementation","createDocumentType","doctype","replaceChild","insertBefore","childNodes","JSON","parse","item","body","prependURL","js_args","paramsReturn","jsVars","get","push","encodeURIComponent","length","join","hasIn","getIn","componentDidMount","onload","closeActions","getElementsByClassName","i","addEventListener","updateMessageData","then","updateMessage","elmScroll","scrollTop","scrollHeight","js","textContent","head","onerror","console","log","style","iframeOptions","sameIframes","parentNode","getAttribute","className","render","t","React"],"ignoreList":[],"sourceRoot":""}