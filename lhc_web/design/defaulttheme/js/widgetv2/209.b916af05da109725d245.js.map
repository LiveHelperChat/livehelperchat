{"version":3,"file":"209.b916af05da109725d245.js","mappings":"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","sources":["webpack://LHCReactAPP/./src/components/CustomHTML.js"],"sourcesContent":["import React, { Component } from 'react';\nimport { connect } from \"react-redux\";\nimport { helperFunctions } from \"../lib/helperFunctions\";\nimport parse, { domToReact } from 'html-react-parser';\nimport { parseScript } from \"../actions/chatActions\";\n\n@connect((store) => {\n    return {\n        chatwidget: store.chatwidget\n    };\n})\n\nclass CustomHTML extends Component {\n\n    state = {\n        preg_match_rules : []\n    }\n\n\n\n    constructor(props) {\n        super(props);\n        this.listenerAdded = false;\n        this.js_execute = null;\n    }\n\n    handleParentMessage(e, item) {\n        if (Array.isArray(item.target) ? item.target.includes(e?.data?.event) : e?.data?.event === item.target) {\n            if (e['data']['event'] == 'element_click_by_id') {\n                const el = document.getElementById(e?.data?.value);\n                if (el) {\n                    if (typeof el.click === 'function') {\n                        el.click();\n                    } else {\n                        el.dispatchEvent(new MouseEvent('click', { bubbles: true, cancelable: true, view: window }));\n                    }\n                }\n            } else {\n                let value = [];\n                value[e['data']['event']] = e['data']['value'];\n                this.setState(value);\n            }\n        }\n    }\n\n    abstractClick(attrs, e) {\n        JSON.parse(attrs['data-action']).forEach((item) => {\n            if (item.action == 'add_css_class') {\n                let elm = document.querySelector(item.target);\n                elm && elm.classList.add(item.value);\n            } else if (item.action == 'remove_css_class') {\n                let elm = document.querySelector(item.target);\n                elm && elm.classList.remove(item.value);\n            } else if (item.action == 'chat_attr_global') {\n                window.lhcChat[item.target] = item.value;\n            } else if (item.action == 'set_state') {\n                var params = {};\n                params[item.target] = item.value;\n                this.props.setStateParent(params);\n            } else if (item.action == 'post_message') {\n                document.getElementById(item.target).contentWindow.postMessage(item.value,'*');\n            } else if (item.action == 'listen_post_message') {\n                if (window.addEventListener) {\n                    // FF\n                    window.addEventListener(\"message\", (evt) => {this.handleParentMessage(evt,item)}, false);\n                } else if ( window.attachEvent ) {\n                    // IE\n                    window.attachEvent(\"onmessage\", (evt) => {this.handleParentMessage(evt,item)});\n                } else if ( document.attachEvent ) {\n                    // IE\n                    document.attachEvent(\"onmessage\", (evt) => {this.handleParentMessage(evt,item)});\n                };\n            }\n        });\n    }\n\n    componentDidMount() {\n        if (this.js_execute !== null) {\n            parseScript(this.js_execute, this);\n        }\n    }\n\n    render() {\n        let html = this.props.chatwidget.getIn(['chat_ui',this.props.attr]);\n\n        if (!this.props.has_new) {\n            html = html.replace( /<newmessages>(.*)<\\/newmessages>/gi, \"\");\n        }\n        \n        this.state.preg_match_rules.forEach(rule => {\n            html = html.replace(rule.search, rule.replace, \"\");\n        });\n\n        return (\n            <React.Fragment>\n                {parse(html, {\n                    replace: domNode => {\n                        var cloneAttr = Object.assign({}, domNode.attribs);\n                        if (domNode.attribs) {\n                            if (domNode.name && domNode.name === 'button') {\n                                return <button type=\"button\" {...domNode.attribs} onClick={(e) => this.abstractClick(cloneAttr, e)}>{domToReact(domNode.children)}</button>\n                            } else if (domNode.name && domNode.name === 'lhcaction') {\n                                if (this.listenerAdded == false) {\n                                    this.abstractClick(cloneAttr, null);\n                                    this.listenerAdded = true;\n                                }\n                                return \"\";\n                            } else if (domNode.name && domNode.name === 'script' && domNode.attribs['data-bot-action']) {\n                                this.js_execute = domNode;\n                                // Return empty element\n                                return <React.Fragment></React.Fragment>;\n                            }\n                        }\n                    }})}\n            </React.Fragment>\n        );\n    }\n}\n\nexport default CustomHTML;"],"names":["connect","store","chatwidget","_dec","_class","Component","constructor","props","super","_defineProperty","preg_match_rules","this","listenerAdded","js_execute","handleParentMessage","e","item","_e$data","_e$data2","Array","isArray","target","includes","data","event","_e$data3","el","document","getElementById","value","click","dispatchEvent","MouseEvent","bubbles","cancelable","view","window","setState","abstractClick","attrs","JSON","parse","forEach","action","elm","querySelector","classList","add","remove","lhcChat","params","setStateParent","contentWindow","postMessage","addEventListener","evt","attachEvent","componentDidMount","parseScript","render","html","getIn","attr","has_new","replace","state","rule","search","React","domNode","cloneAttr","Object","assign","attribs","name","_extends","type","onClick","domToReact","children"],"ignoreList":[],"sourceRoot":""}